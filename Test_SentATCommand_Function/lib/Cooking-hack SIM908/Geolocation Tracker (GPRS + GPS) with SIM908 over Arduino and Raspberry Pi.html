<!DOCTYPE html>
<!-- saved from url=(0122)https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi -->
<html xml:lang="en" lang="en" class=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/7966.js.tải xuống" async="" type="text/javascript"></script><script type="text/javascript" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/300lo.json"></script><script type="text/javascript" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/_ate.track.config_resp"></script>
<meta name="format-detection" content="telephone=no">
    
    <title>Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi</title>
    <meta name="description" content="This tutorial allows Arduino and Raspberry Pi users to read GPS coordinates (longitude and latitude) and send them by using a HTTP request to a web server ">
    <meta name="robots" content="INDEX,FOLLOW">
    <link rel="icon" href="https://www.cooking-hacks.com/skin/frontend/cooking/default/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="https://www.cooking-hacks.com/skin/frontend/cooking/default/favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link rel="stylesheet" type="text/css" href="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/3a2b0d0178e39ef36b4429b0e957de01.1471337574.css" media="all">
    <link rel="stylesheet" href="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/custom.1479717029.css" type="text/css">
    <!--[if lt IE 7]>
    <script type="text/javascript">
        //<![CDATA[
    var BLANK_URL = 'https://www.cooking-hacks.com/js/blank.html';
    var BLANK_IMG = 'https://www.cooking-hacks.com/js/spacer.1441868813.gif';
//]]>
</script>
<![endif]-->
    <script async="" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/fbevents.js.tải xuống"></script><script async="" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/analytics.js.tải xuống"></script><script type="text/javascript">
        //<![CDATA[
        var SKIN_URL = 'https://www.cooking-hacks.com/skin/frontend/default/sm_lovefashion';
        var TMPL_NAME = 'sm_lovefashion';
        var TMPL_COOKIE = ["direction","fontsize","font_name","sitestyle","layoutstyle","bgcolor","body-bgimage","linkcolor","textcolor","header-bgimage","header-bgcolor","footer-bgcolor","footer-bgimage","menustyle","shownotice","googleWebFont"];
        //]]>
    </script>

                


<script type="text/javascript" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/19357e84bd1f9c27a306d7d6c3d77293.1471848138.js.tải xuống"></script>
    <script type="text/javascript" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/custom.1487174267.js.tải xuống"></script>


<script type="text/javascript">
//<![CDATA[
Mage.Cookies.path     = '/';
Mage.Cookies.domain   = '.www.cooking-hacks.com';
//]]>
</script>
        <!-- Google Analytics -->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-47032146-2','auto');
        
                        ga('send', 'pageview', '/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi');
        
    </script>
        <!-- End Google Analytics -->
<script type="text/javascript">
//<![CDATA[
		var isCart=0;
	var _skipProductlink ='';
	var enable_ajax_cart = 1;
	var enable_ajax_compare = 1;
	var enable_ajax_wishlist = 1;
	var enable_ajax_update = 1;
	var confirm_display = 1;
	var confirm_countdown_number = 2;
	var confirm_item_display = 1;
	
	var isWishlist=0;
	var isCompare=0;
	var setfocus=1;
	var isIE6= new RegExp("MSIE 6").test(navigator.userAgent);
	var isIE7= new RegExp("MSIE 7").test(navigator.userAgent);
	var iffix="";
	if(isIE6) {iffix="<iframe id='iffix'></iframe>";}
	var iprocess='<div id="loadmask"><p class="loader"><img alt="Loading..." src="https://www.cooking-hacks.com/skin/frontend/cooking/default/sm/cartpro/images/ajax-loader-tr.1438164066.gif"><br>Please wait...</p></div>'+iffix;
	var iconfirm="";
	var islogin="0";
	var bundle;
	var optionsPrice;
	var calendar;
	var productAddToCartForm;
	var dConfig;
	var classBtnAddtocart = '.btn-cart';
	function ajaxUpdate(args,type)
	{
		if(type=="url"){
			//var param=""+args;
			//url="https://www.cooking-hacks.com/cartpro/index/add/";
			url=args;
			new Ajax.Request(url, {encoding:'UTF-8',method: 'post',
				 parameters:{
					isCart:isCart,	//check current page is product page, or My cart page, and check this request is ajax or not
					isWishlist:isWishlist	
				}, 
				// req.setRequestHeader("Content-type", "text/x-json");

				onSuccess : function(resp)
				{
					var respjson=resp.responseText.evalJSON();
					updateCart(respjson);
				},
				onLoading : function(resp)
				{	$("fancybox-wrap-clone").setStyle({display:"none"});
					$("process").innerHTML=iprocess;
					$("process").setStyle({display:"block"});
					$("options").setStyle({display:"block"});
					$("blurmask").setStyle({display:"block"});
					fixcenter();
				},
				onFailure : function(resp)
				{
					Element.setInnerHTML( display, resp.responseText);
				},
				onComplete: function()
				{
					$("process").setStyle({display:"none"});
					$("blurmask").setStyle({display:"none"});
				}
			}); 
		}
		else{
			$('product_addtocart_form').request({			//form-example  id form
				encoding:'UTF-8',
				method:'post',
				//setRequestHeader: {Accept: 'text/html'},
				parameters:{isCart:isCart},		
				onLoading : function(resp)
				{
					$("process").innerHTML=iprocess;
					$("process").setStyle({display:"block"})
					$("fancybox-wrap-clone").setStyle({display:"none"});
					$("options").setStyle({display:"block"});
					$("blurmask").setStyle({display:"block"});
					fixcenter();
				},				
				onComplete: function(resp){
					$("process").setStyle({display:"none"});
					$("blurmask").setStyle({display:"none"});
					var respjson=resp.responseText.evalJSON();
					updateCart(respjson);
				}
			});		
		}
	}
	function updatePCart(resp){
		if(resp.r=='0'){ //add to cart
			if(!resp.options){
				if(opener.isCart=='1'){
					opener.updateBigcart(resp);
					$("options").setStyle({display:"none"});
				}
				else{
					opener.updateCartSidebar(resp);
					if(hideConfirm!=1)
					showPConfirm(resp);
					
					hideConfirm=0;
				}
			}
			else{
				showOptions(resp);
				showPConfirm(resp);
			}
		}
		else if(resp.r=='1'){		//apply add wishlist
			if(isWishlist=='1'){
				opener.updateWishlistRemove(resp);
			}
			else{
				opener.updateMiniWish(resp);
				if(hideConfirm!=1)
				showPConfirm(resp);
				hideConfirm=0;
			}			
		}		
	}
	function updateCart(resp){
		if(resp.r=='0'){ //  apply action add to cart
			if(!resp.options){
				if(isCart=='1'){	// in my cart page
					updateBigcart(resp);
					$("options").setStyle({display:"none"});
					if(hideConfirm!=1)
						showConfirm(resp);
					hideConfirm=0;
				}
				else{
					
					if(resp.wishlist){
						updateWishlist(resp); //update mini wish ,or big wishlist when click addtocart
					}
					updateCartSidebar(resp);
					
					if(hideConfirm!=1)
						showConfirm(resp);
					hideConfirm=0;
				}
				updateMiniCartPro(resp);
				updateDeleteLinks();	//for btn delete in table item added tocart
				updateLinks(resp);
				if(islogin=="1"){
					updateWishlistLinks();
				}
				updateProductCompareLinks();						
			}
			else{
				if(resp.wishlist){
						updateWishlist(resp);
				}		
				showOptions(resp);
				//showConfirm(resp);	//fixed for mage 324
			}
		}
		else if(resp.r=='1'){		//apply action add wishlist 
			if(isWishlist=='1'){
				updateWishlistRemove(resp);  //in wishlist page have only case remove item in big wishlist, => only update bigwishlist
				if(hideConfirm!=1)
				showConfirm(resp);
				hideConfirm=0;
			}
			else{
				updateMiniWish(resp);  //not in wishlist page have 2case : add item, and remove item in miniwish => only update miniwish
				if(hideConfirm!=1)
				showConfirm(resp);
				hideConfirm=0;
			}			
		}
		else if(resp.r=='2'){		//apply action add product compare
			updateProductCompare(resp);
			if(isCompare && deletePCompare){
				//deletePCompare=0;
				win.location.reload();
			}
			if(hideConfirm!=1)
			showConfirm(resp);
			deletePCompare=0;
			hideConfirm=0;
		}
	}
	function updateBigcart(resp){
		var bcart=$$("#yt_content .cart");
		if(typeof(bcart)!='undefined'){
			bcart.each(function(el){ el.innerHTML = resp.cart; });
		}
	}
	function updateCartSidebar(resp){
		//for(var x in elem){console.log(x);}
		//Effect add to cart
		// if(elem!=undefined){
			// var clone = elem.cloneNode(true);
			
			// elem.up().insert(clone);
			// clone.setStyle({position:"absolute"});elem.setStyle({position:"absolute"});
			// //console.log(clone);
			// //console.log($$(minicart)[0].offsetLeft,$$(minicart)[0].offsetTop);

			// ProdX=elem.up(2).offsetLeft+elem.offsetLeft;
			// ProdY=elem.up(2).offsetTop+elem.offsetTop;

			// //console.log(elem.up(2).tagName);
			// if(isIE6 ||isIE7){
			// CartX=$$(minicart)[0].offsetLeft+$$(minicart)[0].up().offsetLeft+$$(minicart)[0].up(1).offsetLeft;
			// CartY=$$(minicart)[0].offsetTop+$$(minicart)[0].up().offsetTop+$$(minicart)[0].up(1).offsetTop;
			// }
			// else{
			// CartX=$$(minicart)[0].offsetLeft;
			// CartY=$$(minicart)[0].offsetTop;
			// }
			// //pCartX=$$(minicart)[0].offsetParent.offsetLeft ;
			// //pCartY=$$(minicart)[0].offsetParent.offsetTop ;
			// //prod=elem.realOffset();
			// var gotoX           = CartX - ProdX;
			// var gotoY           = CartY - ProdY;
			// //alert(gotoX+":"+gotoY+":"+ProdY+":"+ProdX+":"+CartX+":"+CartY+":"+pCartX+":"+pCartY+":"+CartX2+":"+CartY2);
			// var pos=fixcenter();
			// //console.log(CartX);console.log(CartY );console.log(pos[0]);console.log(pos[1]);console.log(ProdX);console.log(ProdY);//console.log(prod[0]);console.log(prod[1]);
			// new Effect.Parallel(
			 // [
			 // new Effect.MoveBy(clone,gotoY, gotoX , { sync: true }),
			 // new Effect.Scale(clone, 75, { sync: true }),
			 // new Effect.Opacity(clone,{sync: true,from:1,to:0})
			 // ],
			 // {duration: 3}
			 // );		
			// //clone.remove();
		// }
		//var bcart=$$(".block-cart");
		//minicart=($$('.mini-cart')!='')?$$('.mini-cart')[0]:$$('.block-cart')[0];
		//var bcart=$$(sidebarcart);
		if(typeof($$(sidebarcart))!='undefined'){
			$$(sidebarcart).each(function(blockitem){ blockitem.replace(resp.cart); } );
			truncateOptions();		
		}
	}
	function updateMiniCartPro(resp){
		//var bcart=$$(minicartpro)[0];
		if(typeof($$(minicartpro))!='undefined'){
			$$(minicartpro).each(function(blockitem){ 
				if(resp.cartpro!=""){
					blockitem.replace(resp.cartpro);
				}
			});
			truncateOptions();	
		}
	}	
	function updateMiniWish(resp){
		//var bminiwish=$$(".block-wishlist");
		var bminiwish=$$(miniwish);
		//var bcart=$$(".block-cart");
		var bcart=$$(minicart);
		if(typeof(bminiwish)!='undefined'){ 
			bminiwish.each(function(el){ el.replace(resp.cart); })
		}else if(typeof(bcart)!='undefined'){
			bcart.each(function(el){ el.insert({after:resp.cart}); });
		}
		updateWishlistAddCartLinks();
		updateRemoveWishLinks();		
		updateWishlinks(resp);
	}
	function updateLinks(resp){
		//var links=$$(".top-link-cart");
		//links[0].innerHTML=resp.links;
		var links=$$(toplinkcart);
		links.each(function(el){ el.innerHTML=resp.links; });
	}
	function updateWishlistRemove(resp){	//update wishlist when remove item
		updateWishlist(resp);
	}
	function updateWishlist(resp){			//update wish list when add item to wishlist
		var strwish="";
		if(resp.wishlist){
			strwish=resp.wishlist;
		}else{
			strwish=resp.cart;		
		}
		if(isWishlist=='0'){
			//var bminiwish=$$(".block-wishlist");
			var bminiwish=$$(miniwish);
			//var bcart=$$(".block-cart");
			var bcart=$$(minicart);
			if(typeof(bminiwish)!='undefined'){
				bminiwish.each(function(el){ el.replace(strwish); });
			}
			else if(typeof(bcart)!='undefined'){
				bcart.each(function(el){ el.insert({after:strwish}); });
			}
			updateWishlistAddCartLinks();
		}else{
			//var bwish=$$(".my-account");
			var bwish=$$(".col-main .my-account");
			bwish.each(function(el){ 
				el.innerHTML="";
				el.innerHTML=strwish;
			});
		}
		//bwish[0].replace(resp.wishlist);
		updateRemoveWishLinks();
		updateWishlinksCart(resp);
		
	}
	function updateWishlinksCart(resp){		//update wishlink when add to cart item from wishlist
		updateWishlinks(resp);
	}
	function updateWishlinks(resp){		//update wishlink when add product, remove product vao wishlist
		//var links=$$(".top-link-wishlist");
		//links[0].innerHTML=resp.links;	
		var strwishlink="";
		if(resp.wishlinks){
			strwishlink=resp.wishlinks;
		}else{
			strwishlink=resp.links;		
		}	
		//var links=$$(".top-link-wishlist");
		//links[0].innerHTML=strwishlink;			
		
		if(toplinkwish!=''){
			$$(toplinkwish).each(function(el){ el.innerHTML=strwishlink; });
		}
		else{
			var links = getToplinkwish();
			if(links.length){
				links.each(function(el){ el.innerHTML=strwishlink; });
			}
		}
	}
	function updateProductCompare(resp){
		//var bproductcompare=$$('.block-compare');
		var bproductcompare=$$(compare)[0];
		//bproductcompare[0].replace(resp.cart);
		if(typeof(bproductcompare)!='undefined'){
			bproductcompare.replace(resp.cart);
			updateRemovePCompareLinks();
			updateClearPCompareLinks();
		}
		
	}

	function showConfirm(resp){
		if(!confirm_display){ return false; }
		timedown = confirm_countdown_number;
		var cnext="";
		var addto="";
		var cshop="";
		var txtaddedto=(hideConfirm==1 || deletePCompare==1)?"item deleted from ":" added to ";
		
		if(isCompare){
			cshop='<li><button id="btcshop" title="Continue Compare" class="button" onclick="$(\'confirmbox\').innerHTML=\'\';$(\'fancybox-wrap-clone\').setStyle({display:\'none\'});$(\'options\').setStyle({display:\'none\'});isCompare=0;win.focus();"><span id="setcdown">'+ timedown +' s</span> </button></li>';		
		}
		else{
			cshop='<li><button id="btcshop" title="Continue Shopping" class="button" onclick="$(\'confirmbox\').innerHTML=\'\';$(\'fancybox-wrap-clone\').setStyle({display:\'none\'});$(\'options\').setStyle({display:\'none\'});"><span id="setcdown">'+ timedown +' s</span> </button></li>';
		}
		if(resp.r=='0'){
				var tnext=(isCart==1)?"Proceed to Checkout":"View cart & checkout";
				var linknext=(isCart==1)?"https://www.cooking-hacks.com/checkout/onepage/":"https://www.cooking-hacks.com/checkout/cart/";
				cnext='<li><a id="btccart" title="Checkout"  onclick="$(\'confirmbox\').innerHTML=\'\';$(\'fancybox-wrap-clone\').setStyle({display:\'none\'});$(\'options\').setStyle({display:\'none\'});window.location=\''+linknext+'\';"  href="'+linknext+'">	<span>'+tnext+'</span></a></li>';
				addto="your shopping cart.";
		}
		else if(resp.r=='1'){
				cnext='<li><a id="btccart" title="View Wishlist" class="button" onclick="$(\'confirmbox\').innerHTML=\'\';$(\'fancybox-wrap-clone\').setStyle({display:\'none\'});$(\'options\').setStyle({display:\'none\'});window.location=\'https://www.cooking-hacks.com/wishlist/index/\';"  href="https://www.cooking-hacks.com/wishlist/index/">	<span>View Wishlist</span></a></li>';
				addto="your wishlist.";
		}
		else if(resp.r=='2'){
				var str=resp.cart;
				var strclick=str.substring(str.indexOf("popWin('"),str.indexOf(")",str.indexOf("popWin('"))+1);
				cnext='<li><a id="btccart" title="View Comparison" href="javascript:void(\'0\')" onclick="$(\'confirmbox\').innerHTML=\'\';$(\'fancybox-wrap-clone\').setStyle({display:\'none\'});$(\'options\').setStyle({display:\'none\'});'+strclick+'">	<span>View Comparison</span></a></li>';
				addto="comparison list.";
		}
		var info= (typeof resp.infoitem !="undefined")?resp.infoitem:"";
        var sometext = '<div class="moretext"></div>';
        var headinfo = '<p class="head-iteminfo '+((resp.r=='1' || resp.r=='2')?'show':'')+'"><span id="item-name">"'+resp.nameitem+'"</span>'+txtaddedto+addto+'</p>';
        /* cooking: close popup window
            $(\'confirmbox\').innerHTML=\'\';$(\'fancybox-wrap-clone\').setStyle({display:\'none\'});$(\'options\').setStyle({display:\'none\'});
         */
        headinfo = '<div class="popup_close"><a class="popup_close_button" onclick="$(\'confirmbox\').innerHTML=\'\';$(\'fancybox-wrap-clone\').setStyle({display:\'none\'});$(\'options\').setStyle({display:\'none\'});" href="javascript:void(0);"><span class="glyphicon glyphicon-remove-circle"></span></a><br>' + headinfo;
		var blockconfirm=	headinfo
							+ ((typeof info.item !="undefined" && info.item!="" && confirm_item_display)?(info.item + sometext):"") + ((typeof info.other !="undefined" && info.other!="")?info.other:"") 
							
							+'<div id="btnavi"><ul>'+cshop+cnext+'</ul></div>'+iffix;
		$("confirmbox").innerHTML=blockconfirm;
		setTimeout("cdown(timedown)",1000);
		$("fancybox-wrap-clone").setStyle({display:"block"});
		$("options").setStyle({display:"block"});
		fixcenter();
		
		if(timedown==0)
			isCompare=0;
	}
	function showPConfirm(resp){
		timedown = confirm_countdown_number;
		var cnext="";
		var addto="";
		var cshop='<li><a id="btcshop"  onclick="$(\'confirmbox\').remove();$(\'options\').setStyle({display:\'none\'});" href="javascript:void(0);"><span id="setcdown">Continue Shopping<span id="cdown">('+timedown+')</span></span> </a></li>';
		var cclose='<li><a id="btcclose"  onclick="window.close();" href="javascript:void(0);"><span>Close Compare</span> </a></li>';
		if(resp.r=='0'){
				var cnext='<li><a id="btccart"  onclick="opener.window.location.href=\'https://www.cooking-hacks.com/checkout/cart/\';window.close();"  href="javascript:void(0)">	<span>View cart & checkout</span></a></li>';
				addto="your shopping cart.";
		}
		else if(resp.r=='1'){
				var cnext='<li><a id="btccart"  onclick="opener.location.href=\'https://www.cooking-hacks.com/checkout/cart/\';window.close();"  href="javascript:void(0)">	<span>View Wishlist</span></a></li>';
				addto="your wishlist.";
		}
		var blockconfirm='<div id="confirmbox" ><p><span id="product_name">'+resp.nameitem+'</span> added to '+addto+'</p><br><div id="btnavi"><ul>'+cshop+cnext+cclose+'</ul></div></div>'+iffix;
		
		$("confirmbox").innerHTML=blockconfirm;setTimeout("cdown(timedown)",1000);		
		$("fancybox-wrap-clone").setStyle({display:"block"});
		$("process").setStyle({display:"none"});	
		$("options").setStyle({display:"block"});		
	}
	function cdown(timedown){
		var cto="";
		//cto=(isCompare)?"Continue Compare":"Continue Shopping";

		if(timedown!=1){  //show box and count down timer when timeout will close box
			try{
					time=timedown-1;
					$("setcdown").innerHTML= time+"  s";setTimeout("cdown(time)",1000);
				}
			catch(e){}
		}
		else{
			$("options").setStyle({display:"none"});
			$('fancybox-wrap-clone').setStyle({display:'none'});
			if(isCompare) {isCompare=0;win.focus();}
			
			return;
		}
	}
	function showOptions(resp){
		            //tmpDiv = win.document.createElement('div');
					var i;

                    var scripts = resp.cart.extractScripts();
			
					//$("zoptions").innerHTML=resp.cart.stripScripts()+iffix;//iframe hack IE6 , make for div have zindex great than z-index select form
									
                    for (i=0; i<scripts.length; i++)
                    {
                        if (typeof(scripts[i]) != 'undefined' && i<2){
                            try{
								eval(scripts[i]);
							}
							catch(e){
								console.debug(e);
							}
                        }
						else{
							break;
						}
                    }
						
					$("confirmbox").innerHTML=resp.cart.stripScripts()+iffix;	
				   //tmpDiv.innerHTML = resp.cart.stripScripts();
                   // win.document.body.appendChild(tmpDiv);
					$("process").setStyle({display:"none"});

					$("fancybox-wrap-clone").setStyle({display:"block"});
                    $("options").setStyle({display:"block"});
					try{
						fixcenter();
						}
					catch(e){
						console.debug(e);
					}					
                   // showOptionsDialog();
                   // hideProgressAnimation();
                    for (i; i<scripts.length; i++)
                    {
                        if (typeof(scripts[i]) != 'undefined')
                        {	
                            try{
								eval(scripts[i]);
							}
							catch(e){
								console.debug(e);
							}
                        }
                    }
                    productAddToCartForm = new VarienForm('product_addtocart_form');
                    decorateGeneric($$('#product-options-wrapper dl'), ['last']);
                    addSubmitEvent();
                    //if (typeof($$('#acp_configurable_block .focus')[0]) != 'undefined') $$('#acp_configurable_block .focus')[0].focus();
                  //  bundle.reloadPrice();
	}
	function truncateOptions() { //box show description options of product configurable when hover "details" in sidebar or minicartpro
		 $$('.truncated').each(function(element){
			 Event.observe(element, 'mouseover', function(){
					 if (element.down('div.truncated_full_value')) {
						element.down('div.truncated_full_value').addClassName('show')
					 }
				 });
			 Event.observe(element, 'mouseout', function(){
				 if (element.down('div.truncated_full_value')) {
					element.down('div.truncated_full_value').removeClassName('show')
				 }
			});
		 });
	} 
	function addSubmitEvent()
    {
        if (enable_ajax_cart && (typeof productAddToCartForm != 'undefined' ))
        {
            productAddToCartForm.submit = function(url){
                if(this.validator && this.validator.validate()){
                    url=$('product_addtocart_form').action;    //url cua form trong category view
                    //check qty of product
                    /* if( document.getElementById("qty") ){
                        qty_stock     = document.getElementById("qty_stock").value;
                        min_qty_stock = document.getElementById("min_qty_stock").value;
                        max_qty_stock = document.getElementById("max_qty_stock").value;
                        qty           = document.getElementById("qty").value;                    
                        max_qty       = eval(qty-qty_stock);
                        max_default   = eval(qty-max_qty_stock);
                        min_qty       = eval(min_qty_stock-qty);                                        
                        if( min_qty > 0 ){
                            alert("The minimum quantity allowed for purchase is "+min_qty_stock);
                            return false;
                        }
                        if( max_qty > 0 && qty_stock > 0 ){                        
                            alert("The maximum quantity allowed for purchase is "+qty_stock);
                            return false;
                        }
                        if( max_default > 0 ){
                            alert("The maximum quantity allowed for purchase is "+max_qty_stock);
                            return false;
                        }
                    } */
                    //end check qty of product
                    ajaxUpdate(url,'form');
                }
                return false;
            }
        }
    }

	//this code below allow product type download is valid when addtocart
	Product.Downloadable = Class.create();
	Product.Downloadable.prototype = {
		config : {},
		initialize : function(config){
			this.config = config;
			this.reloadPrice();
		},
		reloadPrice : function(){
			var price = 0;
			config = this.config;
			$$('.product-downloadable-link').each(function(elm){
				if (config[elm.value] && elm.checked) {
					price += parseFloat(config[elm.value]);
				}
			});
			try {
				var _displayZeroPrice = optionsPrice.displayZeroPrice;
				optionsPrice.displayZeroPrice = false;
				optionsPrice.changePrice('downloadable', price);
				optionsPrice.reload();
				optionsPrice.displayZeroPrice = _displayZeroPrice;
			} catch (e) {

			}
		}
	};

	function validateDownloadableCallback(elmId, result) {
		var container = $('downloadable-links-list');
		if (result == 'failed') {
			container.removeClassName('validation-passed');
			container.addClassName('validation-failed');
		} else {
			container.removeClassName('validation-failed');
			container.addClassName('validation-passed');
		}
	} 
    Product.Options = Class.create();
    Product.Options.prototype = {
        initialize : function(config){
            this.config = config;
            this.reloadPrice();
        },
        reloadPrice : function(){
            price = new Number();
            config = this.config;
            skipIds = [];
            $$('.product-custom-option').each(function(element){
                var optionId = 0;
                element.name.sub(/[0-9]+/, function(match){
                    optionId = match[0];
                });
                if (this.config[optionId]) {
                    if (element.type == 'checkbox' || element.type == 'radio') {
                        if (element.checked) {
                            if (config[optionId][element.getValue()]) {
                                price += parseFloat(config[optionId][element.getValue()]);
                            }
                        }
                    } else if(element.hasClassName('datetime-picker') && !skipIds.include(optionId)) {
                        dateSelected = true;
                        $$('.product-custom-option[id^="options_' + optionId + '"]').each(function(dt){
                            if (dt.getValue() == '') {
                                dateSelected = false;
                            }
                        });
                        if (dateSelected) {
                            price += parseFloat(this.config[optionId]);
                            skipIds[optionId] = optionId;
                        }
                    } else if(element.type == 'select-one' || element.type == 'select-multiple') {
                        if (element.options) {
                            $A(element.options).each(function(selectOption){
                                if (selectOption.selected) {
                                    if (this.config[optionId][selectOption.value]) {
                                        price += parseFloat(this.config[optionId][selectOption.value]);
                                    }
                                }
                            });
                        }
                    } else {
                        if (element.getValue().strip() != '') {
                            price += parseFloat(this.config[optionId]);
                        }
                    }
                }
            });
            try {
                optionsPrice.changePrice('options', price);
                optionsPrice.reload();
            } catch (e) {

            }
        }
    }
    function validateOptionsCallback(elmId, result){
        var container = $(elmId).up('ul.options-list');
        if (result == 'failed') {
            container.removeClassName('validation-passed');
            container.addClassName('validation-failed');
        } else {
            container.removeClassName('validation-failed');
            container.addClassName('validation-passed');
        }
    }



    var CartForm = Class.create();
        CartForm.prototype = { 
        		initialize: function(form, addressUrl, saveUrl){
						this.form = form;
						if ($(this.form)) {
						     $(this.form).observe('submit', function(event){this.save();Event.stop(event);}.bind(this)); //prevent event submit form
						}
						this.addressUrl = addressUrl;
						this.saveUrl = saveUrl;
						this.onSave = this.reloadCart.bindAsEventListener(this);
						this.onComplete = this.hideLoading.bindAsEventListener(this);
						this.onFailure = this.ajaxFailure.bindAsEventListener(this);
						this.onLoading = this.showLoading.bindAsEventListener(this);
						this.onChanged = false;
        			 }, 
        		save: function(){
	        			
		        		var validator = new Validation(this.form);
						if (validator.validate()) {
	        				 if(enable_ajax_update){	   
		        				 var request = new Ajax.Request(
			        				 this.saveUrl,
			        				 {
				        				 method: 'post',
				        				 onComplete: this.onComplete,
				        				 onSuccess: this.onSave,
				        				 //onFailure: this.onFailure,
				        				 onLoading: this.onLoading,
				        				 parameters: Form.serialize(this.form)+'&isCart='+isCart,
			        				 }
		        				 );
	        				 }else{
								//return VarienForm.prototype.submit.bind(new VarienForm(this.form.id))();
									$(this.form).submit();
	        				 }	 
	        			}
        			},
  
				reloadCart: function(resp){
						var respjson=resp.responseText.evalJSON();
						hideConfirm = 1;
						updateCart(respjson);
					},
				ajaxFailure: function(){

				},
				showLoading: function(){
					$("fancybox-wrap-clone").setStyle({display:"none"});
					$("process").innerHTML=iprocess;
					$("process").setStyle({display:"block"});
					
					$("options").setStyle({display:"block"});
					$("blurmask").setStyle({display:"block"});
					fixcenter();				
				},
				hideLoading: function(){
					$("process").setStyle({display:"none"});
					$("blurmask").setStyle({display:"none"});
				}					        			        			 	
        };
        
//]]>    
</script>

<script type="text/javascript">//<![CDATA[
        var Translator = new Translate({"Please enter your VAT-ID including the ISO-3166 two letter country code.":"Please enter your VAT-ID including the <a href='http:\/\/ec.europa.eu\/taxation_customs\/vies\/faq.html#item_11' target='_blank'>ISO-3166 two letter country code.<\/a>"});
        //]]></script><!-- Start Visual Website Optimizer Asynchronous Code -->
<script type="text/javascript">
var _vwo_code=(function(){
var account_id=68490,
settings_tolerance=2000,
library_tolerance=2500,
use_existing_jquery=false,
// DO NOT EDIT BELOW THIS LINE
f=false,d=document;return{use_existing_jquery:function(){return use_existing_jquery;},library_tolerance:function(){return library_tolerance;},finish:function(){if(!f){f=true;var a=d.getElementById('_vis_opt_path_hides');if(a)a.parentNode.removeChild(a);}},finished:function(){return f;},load:function(a){var b=d.createElement('script');b.src=a;b.type='text/javascript';b.innerText;b.onerror=function(){_vwo_code.finish();};d.getElementsByTagName('head')[0].appendChild(b);},init:function(){settings_timer=setTimeout('_vwo_code.finish()',settings_tolerance);this.load('//dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&r='+Math.random());var a=d.createElement('style'),b='body{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}',h=d.getElementsByTagName('head')[0];a.setAttribute('id','_vis_opt_path_hides');a.setAttribute('type','text/css');if(a.styleSheet)a.styleSheet.cssText=b;else a.appendChild(d.createTextNode(b));h.appendChild(a);return settings_timer;}};}());_vwo_settings_timer=_vwo_code.init();
</script><script src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/j.php" type="text/javascript"></script>
<!-- End Visual Website Optimizer Asynchronous Code --> 


<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','//connect.facebook.net/en_US/fbevents.js');

fbq('init', '589980821155771');
fbq('track', "PageView");</script>
<noscript>&lt;img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=589980821155771&amp;ev=PageView&amp;noscript=1"
/&gt;</noscript>
<!-- End Facebook Pixel Code -->
<style type="text/css">.at-icon{fill:#fff;border:0}.at-icon-wrapper{display:inline-block;overflow:hidden}a .at-icon-wrapper{cursor:pointer}.at-rounded,.at-rounded-element .at-icon-wrapper{border-radius:12%}.at-circular,.at-circular-element .at-icon-wrapper{border-radius:50%}.addthis_32x32_style .at-icon{width:2pc;height:2pc}.addthis_24x24_style .at-icon{width:24px;height:24px}.addthis_20x20_style .at-icon{width:20px;height:20px}.addthis_16x16_style .at-icon{width:1pc;height:1pc}#at16lb{display:none;position:absolute;top:0;left:0;width:100%;height:100%;z-index:1001;background-color:#000;opacity:.001}#at_complete,#at_error,#at_share,#at_success{position:static!important}.at15dn{display:none}#at15s,#at16p,#at16p form input,#at16p label,#at16p textarea,#at_share .at_item{font-family:arial,helvetica,tahoma,verdana,sans-serif!important;font-size:9pt!important;outline-style:none;outline-width:0;line-height:1em}* html #at15s.mmborder{position:absolute!important}#at15s.mmborder{position:fixed!important;width:250px!important}#at15s{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABtJREFUeNpiZGBgaGAgAjAxEAlGFVJHIUCAAQDcngCUgqGMqwAAAABJRU5ErkJggg==);float:none;line-height:1em;margin:0;overflow:visible;padding:5px;text-align:left;position:absolute}#at15s a,#at15s span{outline:0;direction:ltr;text-transform:none}#at15s .at-label{margin-left:5px}#at15s .at-icon-wrapper{width:1pc;height:1pc;vertical-align:middle}#at15s .at-icon{width:1pc;height:1pc}.at4-icon{display:inline-block;background-repeat:no-repeat;background-position:top left;margin:0;overflow:hidden;cursor:pointer}.addthis_16x16_style .at4-icon,.addthis_default_style .at4-icon,.at4-icon,.at-16x16{width:1pc;height:1pc;line-height:1pc;background-size:1pc!important}.addthis_32x32_style .at4-icon,.at-32x32{width:2pc;height:2pc;line-height:2pc;background-size:2pc!important}.addthis_24x24_style .at4-icon,.at-24x24{width:24px;height:24px;line-height:24px;background-size:24px!important}.addthis_20x20_style .at4-icon,.at-20x20{width:20px;height:20px;line-height:20px;background-size:20px!important}.at4-icon.circular,.circular .at4-icon,.circular.aticon{border-radius:50%}.at4-icon.rounded,.rounded .at4-icon{border-radius:4px}.at4-icon-left{float:left}#at15s .at4-icon{text-indent:20px;padding:0;overflow:visible;white-space:nowrap;background-size:1pc;width:1pc;height:1pc;background-position:top left;display:inline-block;line-height:1pc}.addthis_vertical_style .at4-icon,.at4-follow-container .at4-icon{margin-right:5px}html>body #at15s{width:250px!important}#at15s.atm{background:none!important;padding:0!important;width:10pc!important}#at15s_inner{background:#fff;border:1px solid #fff;margin:0}#at15s_head{position:relative;background:#f2f2f2;padding:4px;cursor:default;border-bottom:1px solid #e5e5e5}.at15s_head_success{background:#cafd99!important;border-bottom:1px solid #a9d582!important}.at15s_head_success a,.at15s_head_success span{color:#000!important;text-decoration:none}#at15s_brand,#at15sptx,#at16_brand{position:absolute}#at15s_brand{top:4px;right:4px}.at15s_brandx{right:20px!important}a#at15sptx{top:4px;right:4px;text-decoration:none;color:#4c4c4c;font-weight:700}#at15sptx:hover{text-decoration:underline}#at16_brand{top:5px;right:30px;cursor:default}#at_hover{padding:4px}#at_hover .at_item,#at_share .at_item{background:#fff!important;float:left!important;color:#4c4c4c!important}#at_share .at_item .at-icon-wrapper{margin-right:5px}#at_hover .at_bold{font-weight:700;color:#000!important}#at_hover .at_item{width:7pc!important;padding:2px 3px!important;margin:1px;text-decoration:none!important}#at_hover .at_item.athov,#at_hover .at_item:focus,#at_hover .at_item:hover{margin:0!important}#at_hover .at_item.athov,#at_hover .at_item:focus,#at_hover .at_item:hover,#at_share .at_item.athov,#at_share .at_item:hover{background:#f2f2f2!important;border:1px solid #e5e5e5;color:#000!important;text-decoration:none}.ipad #at_hover .at_item:focus{background:#fff!important;border:1px solid #fff}.at15t{display:block!important;height:1pc!important;line-height:1pc!important;padding-left:20px!important;background-position:0 0;text-align:left}.addthis_button,.at15t{cursor:pointer}.addthis_toolbox a.at300b,.addthis_toolbox a.at300m{width:auto}.addthis_toolbox a{margin-bottom:5px;line-height:initial}.addthis_toolbox.addthis_vertical_style{width:200px}.addthis_button_facebook_like .fb_iframe_widget{line-height:100%}.addthis_button_facebook_like iframe.fb_iframe_widget_lift{max-width:none}.addthis_toolbox a.addthis_button_counter,.addthis_toolbox a.addthis_button_facebook_like,.addthis_toolbox a.addthis_button_facebook_send,.addthis_toolbox a.addthis_button_facebook_share,.addthis_toolbox a.addthis_button_foursquare,.addthis_toolbox a.addthis_button_google_plusone,.addthis_toolbox a.addthis_button_linkedin_counter,.addthis_toolbox a.addthis_button_pinterest_pinit,.addthis_toolbox a.addthis_button_stumbleupon_badge,.addthis_toolbox a.addthis_button_tweet{display:inline-block}.at-share-tbx-element .google_plusone_iframe_widget>span>div{vertical-align:top!important}.addthis_toolbox span.addthis_follow_label{display:none}.addthis_toolbox.addthis_vertical_style span.addthis_follow_label{display:block;white-space:nowrap}.addthis_toolbox.addthis_vertical_style a{display:block}.addthis_toolbox.addthis_vertical_style.addthis_32x32_style a{line-height:2pc;height:2pc}.addthis_toolbox.addthis_vertical_style .at300bs{margin-right:4px;float:left}.addthis_toolbox.addthis_20x20_style span{line-height:20px}.addthis_toolbox.addthis_32x32_style span{line-height:2pc}.addthis_toolbox.addthis_pill_combo_style .addthis_button_compact .at15t_compact,.addthis_toolbox.addthis_pill_combo_style a{float:left}.addthis_toolbox.addthis_pill_combo_style a.addthis_button_tweet{margin-top:-2px}.addthis_toolbox.addthis_pill_combo_style .addthis_button_compact .at15t_compact{margin-right:4px}.addthis_default_style .addthis_separator{margin:0 5px;display:inline}div.atclear{clear:both}.addthis_default_style .addthis_separator,.addthis_default_style .at4-icon,.addthis_default_style .at300b,.addthis_default_style .at300bo,.addthis_default_style .at300bs,.addthis_default_style .at300m{float:left}.at300b img,.at300bo img{border:0}a.at300b .at4-icon,a.at300m .at4-icon{display:block}.addthis_default_style .at300b,.addthis_default_style .at300bo,.addthis_default_style .at300m{padding:0 2px}.at300b,.at300bo,.at300bs,.at300m{cursor:pointer}.addthis_button_facebook_like.at300b:hover,.addthis_button_facebook_like.at300bs:hover,.addthis_button_facebook_send.at300b:hover,.addthis_button_facebook_send.at300bs:hover{opacity:1}.addthis_20x20_style .at15t,.addthis_20x20_style .at300bs{overflow:hidden;display:block;height:20px!important;width:20px!important;line-height:20px!important}.addthis_32x32_style .at15t,.addthis_32x32_style .at300bs{overflow:hidden;display:block;height:2pc!important;width:2pc!important;line-height:2pc!important}.at300bs{overflow:hidden;display:block;background-position:0 0;height:1pc;width:1pc;line-height:1pc!important}.addthis_default_style .at15t_compact,.addthis_default_style .at15t_expanded{margin-right:4px}#at_share .at_item{width:123px!important;padding:4px;margin-right:2px;border:1px solid #fff}#at16p{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABtJREFUeNpiZGBgaGAgAjAxEAlGFVJHIUCAAQDcngCUgqGMqwAAAABJRU5ErkJggg==);z-index:10000001;position:absolute;top:50%;left:50%;width:300px;padding:10px;margin:0 auto;margin-top:-185px;margin-left:-155px;font-family:arial,helvetica,tahoma,verdana,sans-serif;font-size:9pt;color:#5e5e5e}#at_share{margin:0;padding:0}#at16pt{position:relative;background:#f2f2f2;height:13px;padding:5px 10px}#at16pt a,#at16pt h4{font-weight:700}#at16pt h4{display:inline;margin:0;padding:0;font-size:9pt;color:#4c4c4c;cursor:default}#at16pt a{position:absolute;top:5px;right:10px;color:#4c4c4c;text-decoration:none;padding:2px}#at15sptx:focus,#at16pt a:focus{outline:thin dotted}#at15s #at16pf a{top:1px}#_atssh{width:1px!important;height:1px!important;border:0!important}.atm{width:10pc!important;padding:0;margin:0;line-height:9pt;letter-spacing:normal;font-family:arial,helvetica,tahoma,verdana,sans-serif;font-size:9pt;color:#444;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABtJREFUeNpiZGBgaGAgAjAxEAlGFVJHIUCAAQDcngCUgqGMqwAAAABJRU5ErkJggg==);padding:4px}.atm-f{text-align:right;border-top:1px solid #ddd;padding:5px 8px}.atm-i{background:#fff;border:1px solid #d5d6d6;padding:0;margin:0;box-shadow:1px 1px 5px rgba(0,0,0,.15)}.atm-s{margin:0!important;padding:0!important}.atm-s a:focus{border:transparent;outline:0;-webkit-transition:none;transition:none}#at_hover.atm-s a,.atm-s a{display:block;text-decoration:none;padding:4px 10px;color:#235dab!important;font-weight:400;font-style:normal;-webkit-transition:none;transition:none}#at_hover.atm-s .at_bold{color:#235dab!important}#at_hover.atm-s a:hover,.atm-s a:hover{background:#2095f0;text-decoration:none;color:#fff!important}#at_hover.atm-s .at_bold{font-weight:700}#at_hover.atm-s a:hover .at_bold{color:#fff!important}.atm-s a .at-label{vertical-align:middle;margin-left:5px;direction:ltr}.at_PinItButton{display:block;width:40px;height:20px;padding:0;margin:0;background-image:url(//s7.addthis.com/static/t00/pinit00.png);background-repeat:no-repeat}.at_PinItButton:hover{background-position:0 -20px}.addthis_toolbox .addthis_button_pinterest_pinit{position:relative}.at-share-tbx-element .fb_iframe_widget span{vertical-align:baseline!important}#at16pf{height:auto;text-align:right;padding:4px 8px}.at-privacy-info{position:absolute;left:7px;bottom:7px;cursor:pointer;text-decoration:none;font-family:helvetica,arial,sans-serif;font-size:10px;line-height:9pt;letter-spacing:.2px;color:#666}.at-privacy-info:hover{color:#000}.body .wsb-social-share .wsb-social-share-button-vert{padding-top:0;padding-bottom:0}.body .wsb-social-share.addthis_counter_style .addthis_button_tweet.wsb-social-share-button{padding-top:44px}.body .wsb-social-share.addthis_counter_style .addthis_button_google_plusone.wsb-social-share-button{padding-top:4px}@media print{#at4-follow,#at4-share,#at4-thankyou,#at4-whatsnext,#at4m-mobile,#at15s,.at4,.at4-recommended{display:none!important}}@media screen and (max-width:400px){.at4win{width:100%}}@media screen and (max-height:700px) and (max-width:400px){.at4-thankyou-inner .at4-recommended-container{height:122px;overflow:hidden}.at4-thankyou-inner .at4-recommended .at4-recommended-item:first-child{border-bottom:1px solid #c5c5c5}}</style><style type="text/css">.at-branding-logo{font-family:helvetica,arial,sans-serif;text-decoration:none;font-size:10px;display:inline-block;margin:2px 0;letter-spacing:.2px}.at-branding-logo .at-branding-icon{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D+PAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRF////+GlNUkcc1QAAAB1JREFUeNpiYIQDBjQmAwMmkwEM0JnY1WIxFyDAABGeAFEudiZsAAAAAElFTkSuQmCC")}.at-branding-logo .at-branding-icon,.at-branding-logo .at-privacy-icon{display:inline-block;height:10px;width:10px;margin-left:4px;margin-right:3px;margin-bottom:-1px;background-repeat:no-repeat}.at-branding-logo .at-privacy-icon{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAKCAMAAABR24SMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABhQTFRF8fr9ot/xXcfn2/P5AKva////////AKTWodjhjAAAAAd0Uk5T////////ABpLA0YAAAA6SURBVHjaJMzBDQAwCAJAQaj7b9xifV0kUKJ9ciWxlzWEWI5gMF65KUTv0VKkjVeTerqE/x7+9BVgAEXbAWI8QDcfAAAAAElFTkSuQmCC")}.at-branding-logo span{text-decoration:none}.at-branding-logo .at-branding-addthis,.at-branding-logo .at-branding-powered-by{color:#666}.at-branding-logo .at-branding-addthis:hover{color:#333}.at-cv-with-image .at-branding-addthis,.at-cv-with-image .at-branding-addthis:hover{color:#fff}a.at-branding-logo:visited{color:initial}.at-branding-info{display:inline-block;padding:0 5px;color:#666;border:1px solid #666;border-radius:50%;font-size:10px;line-height:9pt;opacity:.7;transition:all .3s ease;text-decoration:none}.at-branding-info span{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.at-branding-info:before{content:'i';font-family:Times New Roman}.at-branding-info:hover{color:#0780df;border-color:#0780df}</style><style type="text/css">.fancybox-margin{margin-right:16px;}</style><script type="text/javascript" charset="utf-8" async="" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/161.af59ea8cc379e52f2f66.js.tải xuống"></script><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif);cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif)}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif)}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}</style></head>
<body id="bd" class="sm_lovefashion    cms-page-view cms-documentation-tutorials-geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi tab-notice-actived">		<div id="options">		<div id="options-tab" style="top:0px;">			<!--block content-->			<div id="zoptions">					<div id="process" style="display:block;"></div>												<div id="fancybox-wrap-clone" style="display:none;"><div id="fancybox-outer"><div id="fancy-bg-n" class="fancy-bg"></div><div id="fancy-bg-ne" class="fancy-bg"></div><div id="fancy-bg-e" class="fancy-bg"></div><div id="fancy-bg-se" class="fancy-bg"></div><div id="fancy-bg-s" class="fancy-bg"></div><div id="fancy-bg-sw" class="fancy-bg"></div><div id="fancy-bg-w" class="fancy-bg"></div><div id="fancy-bg-nw" class="fancy-bg"></div><div id="confirmbox"></div>					<a id="fancybox-close" style="display: inline;" onclick="$(&#39;confirmbox&#39;).innerHTML=&#39;&#39;;$(&#39;fancybox-wrap-clone&#39;).setStyle({display:&#39;none&#39;});$(&#39;options&#39;).setStyle({display:&#39;none&#39;});"></a></div></div>			</div>		</div>		</div><div id="blurmask"></div>
        <div id="yt_wrapper" class="col-2-left">
    
        <!-- BEGIN: Header -->
		<div id="yt_header" class="yt-header wrap">
		     <div class="header-style-default">
    <div class="header-top">
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-sm-3 top-curlang">
                    <p class="welcome-msg"></p><p class="welcome-msg evolved_class"> </p> <p></p>
                    <div class="cur-lang-block">
                        <div class="credit_card_top_left"></div>
                                                                    </div>
                </div>
                <div class="col-md-6 col-sm-9 toplinks-header">
                    <ul class="links-account">
                        <li class="account-link">
                            <a href="https://www.cooking-hacks.com/customer/account/" title="My Account">My Account</a>
                            <ul class="dropdown-link">
                                <li><a href="https://www.cooking-hacks.com/customer/account/" title="Account Info">Account Info</a></li>
                                <li><a href="https://www.cooking-hacks.com/customer/account/create/" title="Join">Join Free</a></li>
                                <li><a href="https://www.cooking-hacks.com/customer/account/login/" title="Sign In">Sign In</a></li>
                            </ul>
                        </li>

                        <li class="register-link-help">
                            <a href="https://www.cooking-hacks.com/customer-service/" title="Customer Service">Customer Service</a>
                            <ul class="dropdown-link">
                                <li><a title="Payment" href="https://www.cooking-hacks.com/customer-service#payment">Payment</a></li>
                                <li><a title="Shipping Policy" href="https://www.cooking-hacks.com/customer-service#shipping_policy">Shipping Policy</a></li>
                                <li><a title="Free Shipping" href="https://www.cooking-hacks.com/customer-service#free_shipping">Free Shipping</a></li>
                                <li><a title="Warranty" href="https://www.cooking-hacks.com/customer-service#warranty">Warranty</a></li>
                            </ul>
                        </li>



                    </ul>
                    <ul class="links">
                        <li class="top_contact">
                            <a href="https://www.cooking-hacks.com/about-us/" title="About Us">About Us</a>
                        </li>

                        <li class="top_contact">
                            <a href="https://www.cooking-hacks.com/contact/" title="Contact">Contact</a>
                        </li>

                        <li class="top_contact">
                            <a href="https://www.cooking-hacks.com/checkout/" title="Checkout">Checkout</a>
                        </li>
                    </ul>
                                    </div>
            </div>
        </div>
    </div>
    <div class="wrap-header-top">
        <div class="yt-header-top">
            <div class="container">
                <div class="row">
                    <div class="logo-wrapper col-md-5 header_logo">
                        <h1>
                            <strong>
                                                                <a title="Cooking Hacks by Libelium" href="https://www.cooking-hacks.com/">
                                    <img alt="Cooking Hacks by Libelium" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/logo.1438164067.png">
                                </a>
                            </strong>
                        </h1>
                    </div>
                    <div class="right-content-header col-md-7">
                        <div class="row">
                            <div class="col-md-4 header_cart">
                                
<div class="block mini-cartpro sm-cartpro evolved_class evolved_holding">
		<div class="block-title">
					<div href="javascript:void(0)" class="btn-toggle show-cart-button">
				<div class="btn-cart-hd3">
					Cart is empty				</div>
				<div class="cart-icon">
					<span class="amount-i">0</span>
				</div>
				
				<div class="detail-minicart">
					<h2 class="title-cart">My Cart</h2>
					<div class="bottom-cart">
						<span class="txt-item">item(s)</span>
						
						 -  <span class="price">€0.00</span>					</div>
				</div>
			</div>
			
			</div>
	</div>



                            </div>
                            <div class="col-md-8 header_search">
                                <script type="text/javascript" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/jquery-noconflict.1438164066.js.tải xuống"></script>	<div id="sm_serachbox_pro10394994891487856668" class="sm-serachbox-pro">
			
		<div class="sm-searbox-content">
			<form id="search_mini_form" action="https://www.cooking-hacks.com/catalogsearch/result/" method="get">
				<div class="form-search">
										<div class="cat-wrapper">
						<div class="selector" id="uniform-cat" style="width: 108.4px;"><span style="width: 108.4px; user-select: none;">All Categories</span><select id="cat" name="cat" class="jqtransformdone">
							<option value="">All Categories</option>

															<option value="2">Default Category</option>
															<option value="3">- - Shop</option>
															<option value="4">- - - - Arduino</option>
															<option value="24">- - - - - - Starter Kits</option>
															<option value="25">- - - - - - Wireless</option>
															<option value="27">- - - - - - Shields</option>
															<option value="8">- - - - Sensors</option>
															<option value="32">- - - - - - Motion</option>
															<option value="33">- - - - - - Gas</option>
															<option value="35">- - - - - - Proximity</option>
															<option value="36">- - - - - - Temp. &amp; Humi.</option>
															<option value="37">- - - - - - - - Humidity</option>
															<option value="38">- - - - - - Light</option>
															<option value="40">- - - - - - Flow</option>
															<option value="41">- - - - - - Sound</option>
															<option value="119">- - - - - - e-Health</option>
															<option value="133">- - - - - - Agriculture</option>
															<option value="134">- - - - - - Water Quality</option>
															<option value="210">- - - - - - GPS</option>
															<option value="235">- - - - - - e-Health old</option>
															<option value="49">- - - - Wireless</option>
															<option value="50">- - - - - - Bluetooth</option>
															<option value="51">- - - - - - RFID / NFC</option>
															<option value="52">- - - - - - 802.15.4 / ZigBee</option>
															<option value="53">- - - - - - GPRS / 3G / 4G</option>
															<option value="54">- - - - - - GPS</option>
															<option value="55">- - - - - - Antennas</option>
															<option value="88">- - - - - - RF</option>
															<option value="98">- - - - - - WiFi</option>
															<option value="161">- - - - - - LoRa</option>
															<option value="223">- - - - - - Sigfox</option>
															<option value="224">- - - - - - LoRaWAN</option>
															<option value="236">- - - - - - Sigfox / LoRaWAN</option>
															<option value="105">- - - - Sales</option>
															<option value="106">- - - - New Products</option>
															<option value="107">- - - - Hot Products</option>
															<option value="113">- - - - On Demand</option>
															<option value="114">- - - - Waspmote</option>
															<option value="127">- - - - - - Kits</option>
															<option value="128">- - - - - - Core Boards</option>
															<option value="129">- - - - - - Sensor Boards</option>
															<option value="130">- - - - - - Sensors</option>
															<option value="136">- - - - - - - - Waspmote Gas Sensors</option>
															<option value="137">- - - - - - - - Waspmote Events Sensors</option>
															<option value="138">- - - - - - - - Waspmote Smart Water Sensors</option>
															<option value="139">- - - - - - - - Waspmote Smart Cities Sensors</option>
															<option value="140">- - - - - - - - Waspmote Agriculture Sensors</option>
															<option value="141">- - - - - - - - Waspmote Agriculture PRO Sensors</option>
															<option value="142">- - - - - - - - Waspmote Smart Metering Sensors</option>
															<option value="143">- - - - - - - - Waspmote Smart Metering PRO Sensors</option>
															<option value="148">- - - - - - - - Waspmote Industrial Protocols Sensors</option>
															<option value="131">- - - - - - Wireless</option>
															<option value="160">- - - - - - - - Extreme Range LoRa 868 / 915MHz SX1272 - Module for Waspmote</option>
															<option value="132">- - - - - - Accessories</option>
															<option value="165">- - - - - - Meshlium</option>
															<option value="166">- - - - - - Plug &amp; Sense!</option>
															<option value="115">- - - - Raspberry Pi</option>
															<option value="116">- - - - - - Starter Kits</option>
															<option value="117">- - - - - - Shields</option>
															<option value="205">- - - - - - Wireless</option>
															<option value="121">- - - - 3D Printer</option>
															<option value="172">- - - - Our Kits</option>
															<option value="173">- - - - - - Kits by Platform</option>
															<option value="179">- - - - - - - - Raspberry Pi Kits</option>
															<option value="180">- - - - - - - - Intel Galileo Kits</option>
															<option value="181">- - - - - - - - Waspmote Kits</option>
															<option value="182">- - - - - - - - Arduino Kits</option>
															<option value="175">- - - - - - Kits by User Level</option>
															<option value="176">- - - - - - - - Kits for Experts</option>
															<option value="177">- - - - - - - - Intermediate Kits</option>
															<option value="178">- - - - - - - - Kits for Beginners</option>
															<option value="183">- - - - - - Kits by Categories</option>
															<option value="191">- - - - - - - - Skills</option>
															<option value="185">- - - - - - - - - - Wireless </option>
															<option value="186">- - - - - - - - - - Programming </option>
															<option value="187">- - - - - - - - - - Robotics </option>
															<option value="188">- - - - - - - - - - Sensors </option>
															<option value="189">- - - - - - - - - - Actuators </option>
															<option value="190">- - - - - - - - - - Soldering </option>
															<option value="192">- - - - - - - - Applications</option>
															<option value="193">- - - - - - - - - - Home Automation </option>
															<option value="194">- - - - - - - - - - Industrial Control </option>
															<option value="195">- - - - - - - - - - Agriculture &amp; Garden</option>
															<option value="196">- - - - - - - - - - Aquaponics</option>
															<option value="197">- - - - - - - - - - Nuclear Radiation</option>
															<option value="198">- - - - - - - - - - Geolocation Tracking</option>
															<option value="199">- - - - - - - - - - Internet of Things</option>
															<option value="200">- - - - - - - - - - Long Range Networks</option>
															<option value="213">- - - - - - - - - - e-Health</option>
															<option value="228">- - - - - - IoT Starter Kits</option>
															<option value="201">- - - - Intel Galileo</option>
															<option value="202">- - - - - - Starter Kits</option>
															<option value="203">- - - - - - Shields</option>
															<option value="204">- - - - - - Wireless</option>
															<option value="206">- - - - Home</option>
															<option value="207">- - - - - - Arduino Featured Products</option>
															<option value="208">- - - - - - Waspmote Featured Products</option>
															<option value="211">- - - - - - Raspberry Pi Featured Products</option>
															<option value="212">- - - - - - Intel Galileo Featured Products</option>
															<option value="214">- - - - - - Featured Starter Kits</option>
															<option value="209">- - - - Misc</option>
															<option value="215">- - - - Actuators</option>
															<option value="217">- - - - Specials</option>
															<option value="219">- - - - - - Summer Wireless Week</option>
															<option value="220">- - - - - - Waspmote Mote Runner</option>
															<option value="221">- - - - - - Open Garden Kits</option>
															<option value="222">- - - - - - Halloween</option>
															<option value="225">- - - - - - Black Friday 2015</option>
															<option value="226">- - - - - - Christmas 2015</option>
															<option value="227">- - - - - - Father's Day</option>
															<option value="229">- - - - - - International IoT Day</option>
															<option value="230">- - - - - - Spring 2016</option>
															<option value="234">- - - - - - Back to school</option>
															<option value="241">- - - - - - MySignals Kits</option>
															<option value="242">- - - - - - Winter Sales Hot Products</option>
															<option value="231">- - - - Education kits</option>
														
							
						</select></div>
					</div>
					<div class="input-search"> 
						<input size="30" id="search" type="text" name="q" class="input-text" onfocus="if(this.value==&#39;Enter your keyword...&#39;) this.value=&#39;&#39;;" onblur="if(this.value==&#39;&#39;) this.value=&#39;Enter your keyword...&#39;;" value="Enter your keyword..." autocomplete="off">
					</div>
                    <input type="hidden" name="order" value="pr">
                    <input type="hidden" name="dir" value="desc">
                    <input type="hidden" name="limit" value="64">

					<button type="submit" title="Search" class="button form-button"><span><span>Search</span></span></button>
					<div id="search_autocomplete" class="search-autocomplete" style="display: none;"></div>
                                        <script type="text/javascript">
                        //<![CDATA[
                        var searchForm = new Varien.searchForm('search_mini_form', 'search', 'Search entire store here...');
                        searchForm.initAutocomplete('https://www.cooking-hacks.com/catalogsearch/ajax/suggest/', 'search_autocomplete');
                        //]]>
                    </script>
				</div>
			</form>
		</div>
							</div>

<script type="text/javascript">
	jQuery(document).ready(function($){
		$('.sm-searchbox-more').click(function(){
			$('a.sm-searchbox-more').attr('data_count') == 10; 
			var sb_ajaxurl = $('a.sm-searchbox-more').attr('data_sb_ajaxurl');
			var firt_load = 5;
			var count = $('a.sm-searchbox-more').attr('data_count'); 
			count = parseInt(count);
			if( firt_load >= count ){
				count = count + parseInt(firt_load);
			}
			$.ajax({
				type: 'POST',
				url: sb_ajaxurl,
				data:{
					is_ajax: 1,
					count_term: count
				},
				success: function(data){
					$('.sm-serachbox-pro').html(data.htm);				
					$('a.sm-searchbox-more').attr({
					'data_count': count + parseInt(firt_load)
					}); 					
				}, 
				dataType:'json'
			});
		});
	});
</script>
                            </div>
                        </div>

                        <!-- Original
					<div class="search-minicart">
												<div class="wishlist-compare">
																				</div>
											</div>
					-->

                    </div>
                </div>
            </div>
        </div>


        <div style="clear:both;"></div>
    </div>


    <div class="yt-header-under">
        <div class="container">
            <div class="row yt-header-under-wrap">
                <div class="col-md-12">
                    <div class="yt-main-menu">
                        <div class="yt-menu">
                            		<script type="text/javascript" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/jquery.noconflict.1441867825.js.tải xuống"></script><script type="text/javascript" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/sm-megamenu.1438164066.js.tải xuống"></script>	<script type="text/javascript">
		// <![CDATA[ 
	$jsmart.fn.getOffsetRight=function(){	//this is object that need get offset right	
		offset_right = $jsmart(this).offset().left + $jsmart(this).outerWidth();	
		return offset_right;
	}
	$jsmart.fn.getOffsetLeft=function(){	//this is object that need get offset right	
		offset_right = $jsmart(this).offset().left;	
		return offset_right;
	}	
	$jsmart.fn.setOffsetElement = function(){	
	//this is div child of LI.sm_megamenu_lv1 object that need "set offset left for div has align:left" and "set offset right for div has align:right"
			
			offset_right_class_sm_megamenu_menu =  $jsmart('#sm_megamenu_menu58aee41cc91bd').getOffsetRight();
			offset_left_class_sm_megamenu_menu = $jsmart('#sm_megamenu_menu58aee41cc91bd').getOffsetLeft();	
			
			if(!$jsmart(this).hasClass('sm_megamenu_align_right')){
				px_exceed_right_side_menu = $jsmart(this).offsetParent().offset().left+ $jsmart(this).outerWidth() - offset_right_class_sm_megamenu_menu;
				if(px_exceed_right_side_menu>0){
					$jsmart(this).css({'left':-px_exceed_right_side_menu});
				}
				else{
					//$jsmart(this).css({'left':'0'});
				}
			}
			else { 
				px_exceed_left_side_menu = $jsmart(this).offsetParent().getOffsetRight() - $jsmart(this).outerWidth() - offset_left_class_sm_megamenu_menu ;
				if(px_exceed_left_side_menu>0){				
					$jsmart(this).css({'left':'auto', 'right':'0px'});
				}
				else{
					$jsmart(this).css({'left':'auto', 'right':px_exceed_left_side_menu});
				}						
			}	
	}
	
					$jsmart(function() {	//init
				effect_duration = 1;
				if( effect_duration <= 0 ){
					effect_duration = 800;
				}
				$jsmart('#sm_megamenu_menu58aee41cc91bd li.sm_megamenu_lv1').children('div').each(function(i,e){
					$jsmart(e).setOffsetElement();		
				});	
				if( $jsmart('#sm_megamenu_menu58aee41cc91bd li.sm_megamenu_lv1').parent().hasClass('sm-megamenu-hover') ){
					$jsmart('#sm_megamenu_menu58aee41cc91bd li.sm_megamenu_lv1').children('div').css({'display': 'block'});
				    var menu_width = $jsmart('.sm_megamenu_wrapper_horizontal_menu').width();
					$jsmart('.sm_megamenu_wrapper_horizontal_menu .sm_megamenu_menu > li > div').each(function(){
						$this = $jsmart(this);   
						var lv2w = $this.width();
						var lv2ps = $this.position();
						var lv2psl = $this.position().left;
						var sw = lv2w + lv2psl;
						if( sw >= menu_width ){
							$this.css({'right': '0'});
						}   
					});
					$jsmart('#sm_megamenu_menu58aee41cc91bd li.sm_megamenu_lv1').children('div').css({'display': 'none'});
				}
				$jsmart('#sm_megamenu_menu58aee41cc91bd li.sm_megamenu_lv1').hover(function(e){	
					$jsmart(this).children('div').stop(true,true).delay(200).slideDown(effect_duration);	
				},function(e){	
					$jsmart(this).children('div').stop(true,true).delay(0).slideUp(effect_duration);	
				});
			});
			
			
		// ]]> 
	</script>
	

<!--<link media="all" href="--><!--" type="text/css" rel="stylesheet">-->


		
	<div class="sm_megamenu_wrapper_horizontal_menu sambar" id="sm_megamenu_menu58aee41cc91bd" data-sam="20943857661487856668">
		<div class="sambar-inner">
			<a class="btn-sambar" data-sapi="collapse" href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#sm_megamenu_menu58aee41cc91bd">
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</a>	
			<ul class=" sm_megamenu_menu sm_megamenu_menu_black" data-jsapi="on">
									<li class="css-1column-parent  other-toggle          sm_megamenu_lv1 sm_megamenu_drop parent">
												<a class="sm_megamenu_head sm_megamenu_drop " href="https://www.cooking-hacks.com/index.php/tutorial/tutorial/index" id="sm_megamenu_21">
																										<span class="sm_megamenu_icon sm_megamenu_nodesc">		
																												<span class="sm_megamenu_title">Tutorials</span>
																	
														
													</span>
																																						</a>
																																					<div class="sm_megamenu_dropdown_1column ">	
													<div class="sm_megamenu_col_1 sm_megamenu_firstcolumn  sm_megamenu_id21   css-1column"><div class="sm_megamenu_col_6 sm_megamenu_firstcolumn  sm_megamenu_id26   link-1column"><div class="sm_megamenu_head_item ">	<div class="sm_megamenu_title"><a class="sm_megamenu_nodrop " href="https://www.cooking-hacks.com/tutorial/tutorial/index/board/arduino"><span class="sm_megamenu_title_lv2">Arduino Tutorials</span></a></div></div></div><div class="sm_megamenu_col_6 sm_megamenu_firstcolumn  sm_megamenu_id27   link-1column"><div class="sm_megamenu_head_item ">	<div class="sm_megamenu_title"><a class="sm_megamenu_nodrop " href="https://www.cooking-hacks.com/tutorial/tutorial/index/board/raspberry"><span class="sm_megamenu_title_lv2">Raspberry Tutorials</span></a></div></div></div><div class="sm_megamenu_col_6 sm_megamenu_firstcolumn  sm_megamenu_id28   link-1column"><div class="sm_megamenu_head_item ">	<div class="sm_megamenu_title"><a class="sm_megamenu_nodrop " href="https://www.cooking-hacks.com/tutorial/tutorial/index/board/intel-galileo"><span class="sm_megamenu_title_lv2">Intel Galileo Tutorials</span></a></div></div></div><div class="sm_megamenu_col_6 sm_megamenu_firstcolumn  sm_megamenu_id77   link-1column"><div class="sm_megamenu_head_item ">	<div class="sm_megamenu_title"><a class="sm_megamenu_nodrop " href="https://www.cooking-hacks.com/tutorial/tutorial/index/board/waspmote"><span class="sm_megamenu_title_lv2">Waspmote Tutorials</span></a></div></div></div></div>												</div>
												</li>
									<li class="css-1column-parent  other-toggle   
						sm_megamenu_lv1 sm_megamenu_nodrop   ">
												<a class="sm_megamenu_head sm_megamenu_nodrop " href="https://www.cooking-hacks.com/forum" id="sm_megamenu_4">
																										<span class="sm_megamenu_icon sm_megamenu_nodesc">		
																												<span class="sm_megamenu_title">Forum</span>
																	
														
													</span>
																																						</a>
																																	</li><li class="css-1column-parent  other-toggle   
						sm_megamenu_lv1 sm_megamenu_nodrop   ">
												<a class="sm_megamenu_head sm_megamenu_nodrop " href="https://www.cooking-hacks.com/distributors" id="sm_megamenu_24">
																										<span class="sm_megamenu_icon sm_megamenu_nodesc">		
																												<span class="sm_megamenu_title">Distributors</span>
																	
														
													</span>
																																						</a>
																																	</li><li class="css-1column-parent  other-toggle   
						sm_megamenu_lv1 sm_megamenu_nodrop   ">
												<a class="sm_megamenu_head sm_megamenu_nodrop " href="https://www.cooking-hacks.com/blog/" id="sm_megamenu_25">
																										<span class="sm_megamenu_icon sm_megamenu_nodesc">		
																												<span class="sm_megamenu_title">Blog</span>
																	
														
													</span>
																																						</a>
																														</li></ul>
		</div>
	</div>
	<!--End Module-->

<script>
	jQuery(document).ready(function($){
		/* $('.bedroom-item-head').parent().addClass('re-width bedroom-style');
		$('.living-rom-item').parent().addClass('re-width living-style'); */
	});
</script>
<script type="text/javascript">
// <![CDATA[ 
$jsmart(document).ready(function(){
	var menu_width = $jsmart('.sm_megamenu_wrapper_horizontal_menu').width();
	$jsmart('.sm_megamenu_wrapper_horizontal_menu .sm_megamenu_menu > li > div').each(function(){
		$this = $jsmart(this);   
		var lv2w = $this.width();
		var lv2ps = $this.position();
		var lv2psl = $this.position().left;
		var sw = lv2w + lv2psl;
		if( sw > menu_width ){
			$this.css({'right': '0'});
		}   
	});
});
// ]]> 
</script>
                                                        <div class="quick-info evolved_class evolved_holding">

            <div class="inner">
            <span class="item1">
                <a title="Register" href="https://www.cooking-hacks.com/customer/account/create/">
                    Join Free                </a>
            </span>
            <span class="item2">
                <span>Sign in</span>
                <div class="login-quick">
                                        <div class="block block-login-top">
                        <form action="https://www.cooking-hacks.com/customer/account/loginPost/" method="post">
                            <input type="hidden" name="form_key" value="N8gQXSVdsNxt9T5E">
                            <div class="wrap-top">
                                <div class="wrap wrap-user">
                                    <input class="inp-user" type="text" name="login[username]" id="mini-login" value="User name" onfocus="if(this.value != &#39;&#39;) {this.value = &#39;&#39;;}" onblur="if (this.value == &#39;&#39;) {this.value = &#39;User name&#39;;}">
                                </div>
                                <div class="clr"></div>
                                <div class="wrap wrap-pass">
                                    <input class="inp-pass" type="password" name="login[password]" id="mini-password" value="........." onfocus="if(this.value != &#39;&#39;) {this.value = &#39;&#39;;}" onblur="if (this.value == &#39;&#39;) {this.value = &#39;.........&#39;;}">
                                </div>
                                <div class="actions">
                                    <div class="chk-remember"><input id="chk_remember" type="checkbox" name="rememberme" value="remember"> <label>Remember me ?</label> </div>
                                    <button class="button" title="Search" type="submit"><span><span>Login</span></span></button>
                                </div>
                            </div>
                            <div class="more-actions">
                                <a href="https://www.cooking-hacks.com/customer/account/forgotpassword/" class="link_fyp">Forgot Your Password</a>
                                <a href="https://www.cooking-hacks.com/customer/account/create/" title="Create an Account" class="button-reg">Register</a>
                            </div>
                        </form>
                    </div>

                </div>
            </span>
        </div><!---->

    
</div>

                        </div>
                    </div>

                    <div id="yt-responsivemenu" class="yt-responsivemenu">
                        <div class="mobile-menu-wrapper">
                                <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"></button>
    <div id="yt_resmenu_collapse" style="height: 0;" class="nav-collapse collapse">
	    <ul class="nav-menu clearfix">
	    <li class="nav-home active">
	        <a class="nav-home active" href="https://www.cooking-hacks.com/" title="Home"><span>Home</span></a>
	    </li>
	    	        <li class="level0 nav-1 parent" onmouseover="toggleMenu(this,1)" onmouseout="toggleMenu(this,0)">
<a href="https://www.cooking-hacks.com/shop">
<span>Shop</span>
</a>
<ul class="level0">
<li class="level1 nav-1-1 first parent" onmouseover="toggleMenu(this,1)" onmouseout="toggleMenu(this,0)">
<a href="https://www.cooking-hacks.com/shop/arduino">
<span>Arduino</span>
</a>
<ul class="level1">
<li class="level2 nav-1-1-1 first">
<a href="https://www.cooking-hacks.com/shop/arduino/starter-kits">
<span>Starter Kits</span>
</a>
</li><li class="level2 nav-1-1-2">
<a href="https://www.cooking-hacks.com/shop/arduino/shields">
<span>Shields</span>
</a>
</li><li class="level2 nav-1-1-3 last">
<a href="https://www.cooking-hacks.com/shop/arduino/wireless">
<span>Wireless</span>
</a>
</li>
</ul>
</li><li class="level1 nav-1-2 parent" onmouseover="toggleMenu(this,1)" onmouseout="toggleMenu(this,0)">
<a href="https://www.cooking-hacks.com/shop/raspberry-pi">
<span>Raspberry Pi</span>
</a>
<ul class="level1">
<li class="level2 nav-1-2-4 first">
<a href="https://www.cooking-hacks.com/shop/raspberry-pi/starter-kit">
<span>Starter Kits</span>
</a>
</li><li class="level2 nav-1-2-5">
<a href="https://www.cooking-hacks.com/shop/raspberry-pi/shields">
<span>Shields</span>
</a>
</li><li class="level2 nav-1-2-6 last">
<a href="https://www.cooking-hacks.com/shop/raspberry-pi/wireless">
<span>Wireless</span>
</a>
</li>
</ul>
</li><li class="level1 nav-1-3 parent" onmouseover="toggleMenu(this,1)" onmouseout="toggleMenu(this,0)">
<a href="https://www.cooking-hacks.com/shop/waspmote">
<span>Waspmote</span>
</a>
<ul class="level1">
<li class="level2 nav-1-3-7 first">
<a href="https://www.cooking-hacks.com/shop/waspmote/kits">
<span>Kits</span>
</a>
</li><li class="level2 nav-1-3-8">
<a href="https://www.cooking-hacks.com/shop/waspmote/core-boards">
<span>Core Boards</span>
</a>
</li><li class="level2 nav-1-3-9">
<a href="https://www.cooking-hacks.com/shop/waspmote/sensor-boards">
<span>Sensor Boards</span>
</a>
</li><li class="level2 nav-1-3-10">
<a href="https://www.cooking-hacks.com/shop/waspmote/sensors">
<span>Sensors</span>
</a>
</li><li class="level2 nav-1-3-11">
<a href="https://www.cooking-hacks.com/shop/waspmote/wireless">
<span>Wireless</span>
</a>
</li><li class="level2 nav-1-3-12 last">
<a href="https://www.cooking-hacks.com/shop/waspmote/accessories">
<span>Accessories</span>
</a>
</li>
</ul>
</li><li class="level1 nav-1-4 parent" onmouseover="toggleMenu(this,1)" onmouseout="toggleMenu(this,0)">
<a href="https://www.cooking-hacks.com/shop/intel-galileo">
<span>Intel Galileo</span>
</a>
<ul class="level1">
<li class="level2 nav-1-4-13 first">
<a href="https://www.cooking-hacks.com/shop/intel-galileo/starter-kits">
<span>Starter Kits</span>
</a>
</li><li class="level2 nav-1-4-14">
<a href="https://www.cooking-hacks.com/shop/intel-galileo/shields">
<span>Shields</span>
</a>
</li><li class="level2 nav-1-4-15 last">
<a href="https://www.cooking-hacks.com/shop/intel-galileo/wireless">
<span>Wireless</span>
</a>
</li>
</ul>
</li><li class="level1 nav-1-5 parent" onmouseover="toggleMenu(this,1)" onmouseout="toggleMenu(this,0)">
<a href="https://www.cooking-hacks.com/shop/wireless">
<span>Wireless</span>
</a>
<ul class="level1">
<li class="level2 nav-1-5-16 first">
<a href="https://www.cooking-hacks.com/shop/wireless/antennas">
<span>Antennas</span>
</a>
</li><li class="level2 nav-1-5-17">
<a href="https://www.cooking-hacks.com/shop/wireless/802-15-4-zigbee">
<span>802.15.4 / ZigBee</span>
</a>
</li><li class="level2 nav-1-5-18">
<a href="https://www.cooking-hacks.com/shop/wireless/gprs-3g-4g">
<span>GPRS / 3G / 4G</span>
</a>
</li><li class="level2 nav-1-5-19">
<a href="https://www.cooking-hacks.com/shop/wireless/extreme-range-lora">
<span>LoRa</span>
</a>
</li><li class="level2 nav-1-5-20">
<a href="https://www.cooking-hacks.com/shop/wireless/lorawan">
<span>LoRaWAN</span>
</a>
</li><li class="level2 nav-1-5-21">
<a href="https://www.cooking-hacks.com/shop/wireless/sigfox">
<span>Sigfox</span>
</a>
</li><li class="level2 nav-1-5-22">
<a href="https://www.cooking-hacks.com/shop/wireless/wifi">
<span>WiFi</span>
</a>
</li><li class="level2 nav-1-5-23">
<a href="https://www.cooking-hacks.com/shop/wireless/bluetooth">
<span>Bluetooth</span>
</a>
</li><li class="level2 nav-1-5-24">
<a href="https://www.cooking-hacks.com/shop/wireless/rfid-nfc">
<span>RFID / NFC</span>
</a>
</li><li class="level2 nav-1-5-25">
<a href="https://www.cooking-hacks.com/shop/wireless/gps">
<span>GPS</span>
</a>
</li><li class="level2 nav-1-5-26 last">
<a href="https://www.cooking-hacks.com/shop/wireless/rf">
<span>RF</span>
</a>
</li>
</ul>
</li><li class="level1 nav-1-6 parent" onmouseover="toggleMenu(this,1)" onmouseout="toggleMenu(this,0)">
<a href="https://www.cooking-hacks.com/shop/sensors">
<span>Sensors</span>
</a>
<ul class="level1">
<li class="level2 nav-1-6-27 first">
<a href="https://www.cooking-hacks.com/shop/sensors/e-health">
<span>e-Health</span>
</a>
</li><li class="level2 nav-1-6-28">
<a href="https://www.cooking-hacks.com/shop/sensors/agriculture">
<span>Agriculture</span>
</a>
</li><li class="level2 nav-1-6-29">
<a href="https://www.cooking-hacks.com/shop/sensors/temperature">
<span>Temp. &amp; Humi.</span>
</a>
</li><li class="level2 nav-1-6-30">
<a href="https://www.cooking-hacks.com/shop/sensors/water-quality">
<span>Water Quality</span>
</a>
</li><li class="level2 nav-1-6-31">
<a href="https://www.cooking-hacks.com/shop/sensors/motion">
<span>Motion</span>
</a>
</li><li class="level2 nav-1-6-32">
<a href="https://www.cooking-hacks.com/shop/sensors/gas">
<span>Gas</span>
</a>
</li><li class="level2 nav-1-6-33">
<a href="https://www.cooking-hacks.com/shop/sensors/proximity">
<span>Proximity</span>
</a>
</li><li class="level2 nav-1-6-34">
<a href="https://www.cooking-hacks.com/shop/sensors/flow">
<span>Flow</span>
</a>
</li><li class="level2 nav-1-6-35">
<a href="https://www.cooking-hacks.com/shop/sensors/light">
<span>Light</span>
</a>
</li><li class="level2 nav-1-6-36">
<a href="https://www.cooking-hacks.com/shop/sensors/sound">
<span>Sound</span>
</a>
</li><li class="level2 nav-1-6-37 last">
<a href="https://www.cooking-hacks.com/shop/sensors/gps">
<span>GPS</span>
</a>
</li>
</ul>
</li><li class="level1 nav-1-7">
<a href="https://www.cooking-hacks.com/shop/actuators">
<span>Actuators</span>
</a>
</li><li class="level1 nav-1-8">
<a href="https://www.cooking-hacks.com/shop/misc">
<span>Misc</span>
</a>
</li><li class="level1 nav-1-9 last">
<a href="https://www.cooking-hacks.com/shop/3d-printer">
<span>3D Printer</span>
</a>
</li>
</ul>
</li>	    	    </ul>
	    <script type="text/javascript">
		$jsmart(document).ready(function($){
            $('#yt_resmenu_collapse .nav-menu > li.parent').each(function(){
                $(this).find('> ul').wrap('<div class="res-wrapnav">');
                $(this).append('<span class="menuress-toggle"></span>');
            });
			
			$( ".mobile-menu-wrapper .btn" ).click(function() {
				$(this).toggleClass('active_btn');
			});
        });
        $jsmart(window).load(function(){
            $jsmart('#yt_resmenu_collapse .parent .menuress-toggle').css('height', $jsmart('#yt_resmenu_collapse .parent > a').outerHeight());

            $jsmart('#yt_resmenu_collapse .parent > .res-wrapnav').each(function(){
                if($jsmart(this).parent().hasClass('open')){
                    $jsmart(this).css('height', $jsmart(this).children('ul').height());
                }
            });
            $jsmart('#yt_resmenu_collapse .parent .menuress-toggle').click(function(){
                if($jsmart(this).parent().hasClass('open')){
                    $jsmart(this).parent().removeClass('open');
                    $jsmart(this).parent().children('.res-wrapnav').css('height', '0px');
                }else{
                    $jsmart(this).parent().addClass('open');
                    $jsmart(this).parent().children('.res-wrapnav').css('height', $jsmart(this).parent().children('.res-wrapnav').children('ul').height());
                }
            });
        });
		</script>
	</div>
                        </div>
                        <div class="block-mobile search-mobile">
                            <div class="w-mobile">
                                <a href="javascript:void(0);" class="btn-mobile-h search-button-mobile"></a>
                            </div>
                            <script>
                                jQuery(document).ready(function($){
                                    $( ".search-button-mobile" ).click(function() {
                                        $('.sm-serachbox-pro').slideToggle(200);
                                        //$(this).toggleClass('active_btn_mobile');
                                    });
                                });
                            </script>
                        </div>
                        <div class="block-mobile account-links-mobile">
                            <div class="w-mobile">
                                <a href="javascript:void(0);" class="btn-mobile-h link-mobile-icon"></a>
                                <div class="show-content-mobile link-mobile-wrapper">
                                                                        <ul class="links-mobile">
                                        <li>
                                                                                            <a class="" href="https://www.cooking-hacks.com/customer/account/login" title="Login">Login</a>
                                            
                                                                                    </li>
                                        <li>
                                                                                            <a class="register-link-header" href="https://www.cooking-hacks.com/customer/account/create/" title="Register">Register</a>
                                                                                    </li>
                                        <li><a class="checkout-link-header" href="https://www.cooking-hacks.com/checkout/onepage/" title="Checkout">Checkout</a></li>
                                    </ul>
                                                                    </div>
                            </div>
                        </div>
                        <script>
                            jQuery(document).ready(function($){
                                $( ".btn-mobile-h" ).click(function() {
                                    $(this).next('.show-content-mobile').slideToggle(200);
                                    $(this).toggleClass('active_btn_mobile');
                                });
                            });
                        </script>
                    </div>

                </div>

            </div>
        </div>
    </div>

        </div>
<script>
	jQuery(document).ready(function($){
		$( ".wishlist-compare .links li a" ).attr( "title", "My Wishlist" );
	});
</script>




		</div>
		<!-- END: Header -->
		
		<!-- BEGIN: content -->
        <div id="yt_content" class="yt-content wrap col2-left-layout">

        	<div class="yt-breadcrumbs">
    <div class="container">
        <div class="row">
			<div class="col-md-12 breadcrumbs">
				<ul>
						<li class="text-br">You are here: </li>
											<li class="home">
													<a href="https://www.cooking-hacks.com/" title="Go to Home Page">Home</a>
												</li>
											<li class="cms_page">
													<strong>Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi</strong>
												</li>
									</ul>
			</div>
		</div>
	</div>
</div>
        	
            <div class="yt-content-inner wrapper-inner">
								
				<div class="container">
					<div class="row">
						
						<div id="yt_left" class="col-lg-3 col-md-3 col-sm-4 col-xs-12">
							<div class="yt-left-wrap">
																		<script type="text/javascript" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/jquery.noconflict.1441867825.js.tải xuống"></script><script type="text/javascript" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/sm-megamenu.1438164066.js.tải xuống"></script>	<script type="text/javascript">
						$jsmart(function() {
				effect_duration = 1;
				if(effect_duration <= 0){
					effect_duration = 800;
				}		
				if( $jsmart('#sm_megamenu_menu58aee41cce00e li.sm_megamenu_lv1').parent().hasClass('sm-megamenu-hover') ){				
					$jsmart('#sm_megamenu_menu58aee41cce00e li.sm_megamenu_lv1').hover(
						function(e) {
							wd = $jsmart(window).width();
							if( wd > 800){
								w = getWbc($jsmart(this).children('div'));
							}else{
								w = getWbctb($jsmart(this).children('div'));
							}
							if(w){
								$jsmart(this).children('div').css({opacity:'1',width:'0px'});
								$jsmart(this).children('div').stop(true,true).animate({
									width: w, 
									opacity:'1'
								}, effect_duration );
							}
						},
						function(e) {
							$jsmart(this).children('div').stop(true,true).animate({
								width: '0px',
								opacity:'0'
							}, 300);
						});
					}
			});	

			function getWbc(e){	//get width by class class_width, return number px
				json_class_width = {
						'sm_megamenu_dropdown_1column': '125',
						'sm_megamenu_dropdown_2columns': '250',
						'sm_megamenu_dropdown_3columns': '375',
						'sm_megamenu_dropdown_4columns': '500',
						'sm_megamenu_dropdown_5columns': '625',
						'sm_megamenu_dropdown_6columns': '750',
						'sm_megamenu_dropdown_fullwidth': '750'
					};
				for(var key in json_class_width){
					if ( json_class_width.hasOwnProperty ( key ) ){
						// alert( key �=>� json_class_width [ key ] );
						if(e.hasClass(key)){
							return json_class_width[ key ];
						}
					}
				}
				return false;	
			}
			function getWbctb(e){	//get width by class class_width, return number px
				json_class_width = {
						'sm_megamenu_dropdown_1column': '125',
						'sm_megamenu_dropdown_2columns': '250',
						'sm_megamenu_dropdown_3columns': '375',
						'sm_megamenu_dropdown_4columns': '500',
						'sm_megamenu_dropdown_5columns': '510',
						'sm_megamenu_dropdown_6columns': '510',
						'sm_megamenu_dropdown_fullwidth': '510'
					};
				for(var key in json_class_width){
					if ( json_class_width.hasOwnProperty ( key ) ){
						// alert( key �=>� json_class_width [ key ] );
						if(e.hasClass(key)){
							return json_class_width[ key ];
						}
					}
				}
				return false;	
			}
			
				
		// ]]> 
	</script>
	

<!--<link media="all" href="--><!--" type="text/css" rel="stylesheet">-->

		
	<div class="sm_megamenu_wrapper_vertical_menu sambar" id="sm_megamenu_menu58aee41cce00e" data-sam="19337115221487856668">
		<div class="sambar-inner">
			<a class="btn-sambar" data-sapi="collapse" href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#sm_megamenu_menu58aee41cce00e">
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</a>	
			<ul class=" sm_megamenu_menu sm_megamenu_menu_black" data-jsapi="on">
									<li class="icon_appears-parent  other-toggle          sm_megamenu_lv1 sm_megamenu_drop parent">
												<a class="sm_megamenu_head sm_megamenu_drop " href="https://www.cooking-hacks.com/shop/kits/kits-by-platform" id="sm_megamenu_50">
																										<span style="background: url(&#39;https://www.cooking-hacks.com/media/wysiwyg/icon_platform.1441867661.png&#39;) no-repeat scroll 0% 50% transparent;" class="sm_megamenu_icon sm_megamenu_nodesc">		
																												<span class="sm_megamenu_title">Kits by Platforms</span>
																	
														
													</span>
																																							<span class="icon-item-menu"><img src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/icon_platform.1441867661.png"></span>
																									</a>
																																					<div class="sm-megamenu-child sm_megamenu_dropdown_4columns ">	
													<div class="sm_megamenu_col_4 sm_megamenu_firstcolumn  sm_megamenu_id50   icon_appears"><div class="sm_megamenu_col_3  sm_megamenu_id52   "><div class="sm_megamenu_head_item ">	</div><div class="sm_megamenu_content"><ul class="list-cat">
<li class="title_cat_megamenu"><a href="https://www.cooking-hacks.com/shop/kits/kits-by-platform/arduino-kits/" title="Arduino Kits">Arduino</a></li>
<li><a href="https://www.cooking-hacks.com/starter-kit/" title="Starter Kit">Starter Kit</a></li>
<li><a href="https://www.cooking-hacks.com/mysignals-hw-ehealth-medical-biometric-arduino-complete-kit/" title="MySignals HW Complete Kit">MySignals HW Complete Kit</a></li>
<li><a href="https://www.cooking-hacks.com/robot-kit/" title="Robot Kit">Robot Kit</a></li>
<li><a href="https://www.cooking-hacks.com/learning-kit/" title="Learning Kit">Learning Kit</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-platform/arduino-kits/" title="See all Arduino Kits">See all</a></li>
<li>&nbsp; </li>
</ul></div></div><div class="sm_megamenu_col_2 sm_megamenu_firstcolumn  sm_megamenu_id53   "><div class="sm_megamenu_head_item ">	</div><div class="sm_megamenu_content"><ul class="list-cat">
<li class="title_cat_megamenu"><a href="https://www.cooking-hacks.com/shop/kits/kits-by-platform/raspberry-pi-kits/" title="Raspberry Pi Kits">Raspberry</a></li>
<li><a href="https://www.cooking-hacks.com/a-v-kit-for-raspberry-pi/" title="A/V Kit for Raspberry Pi ">A/V Kit for Raspberry Pi </a></li>
<li><a href="https://www.cooking-hacks.com/wifi-connectivity-kit/" title="WiFi Connectivity Kit ">WiFi Connectivity Kit </a></li>
<li><a href="https://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-mobile-tracking-kit" title="4G + GPS Mobile Tracking Kit">4G + GPS Mobile Tracking Kit</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-platform/raspberry-pi-kits/" title="See all Raspberry Pi Kits">See all</a></li>
</ul></div></div><div class="sm_megamenu_col_3 sm_megamenu_firstcolumn  sm_megamenu_id69   category-clea-left"><div class="sm_megamenu_head_item ">	</div><div class="sm_megamenu_content"><ul class="list-cat">
<li class="title_cat_megamenu"><a href="https://www.cooking-hacks.com/shop/sensors/e-health" title="MySignals Kits">MySignals</a></li>
<li><a href="https://www.cooking-hacks.com/mysignals-sw-ehealth-medical-biometric-complete-kit/" title="MySignals SW Complete Kit ">MySignals SW Complete Kit </a></li>
<li><a href="https://www.cooking-hacks.com/mysignals-sw-ehealth-medical-biometric-complete-kit-ble/" title="MySignals SW BLE Complete Kit ">MySignals SW BLE Complete Kit</a></li>
<li><a href="https://www.cooking-hacks.com/mysignals-hw-ehealth-medical-biometric-arduino-complete-kit-ble/" title="MySignals HW BLE Complete Kit ">MySignals HW BLE Complete Kit </a></li>
<li><a href="https://www.cooking-hacks.com/shop/sensors/e-health/" title="See all MySignals Kits">See all</a></li>
<li>&nbsp; </li>
</ul></div></div><div class="sm_megamenu_col_2 sm_megamenu_firstcolumn  sm_megamenu_id70   "><div class="sm_megamenu_head_item ">	</div><div class="sm_megamenu_content"><ul class="list-cat">
<li class="title_cat_megamenu"><a href="https://www.cooking-hacks.com/shop/kits/kits-by-platform/waspmote-kits/" title="Waspmote Kits">Waspmote</a></li>
<li><a href="https://www.cooking-hacks.com/waspmote-starter-kit" title="Waspmote Starter Kit ">Waspmote Starter Kit</a></li>
<li><a href="https://www.cooking-hacks.com/waspmote-evaluator-kit" title="Waspmote Starter Kit ">Waspmote Evaluator Kit</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/iot-starter-kits" title="Iot Waspmote Starter Kits">Waspmote Iot Kits </a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-platform/waspmote-kits/" title="See all Waspmote Kits ">See all</a></li>
</ul></div></div></div>												</div>
												</li>
									<li class="icon_appears-parent  other-toggle          sm_megamenu_lv1 sm_megamenu_drop parent">
												<a class="sm_megamenu_head sm_megamenu_drop " href="https://www.cooking-hacks.com/shop/kits/kits-by-user-level" id="sm_megamenu_38">
																										<span style="background: url(&#39;https://www.cooking-hacks.com/media/wysiwyg/icon_user_level.1441867661.png&#39;) no-repeat scroll 0% 50% transparent;" class="sm_megamenu_icon sm_megamenu_nodesc">		
																												<span class="sm_megamenu_title">Kits by User Level</span>
																	
														
													</span>
																																							<span class="icon-item-menu"><img src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/icon_user_level.1441867661.png"></span>
																									</a>
																																					<div class="sm-megamenu-child sm_megamenu_dropdown_6columns ">	
													<div class="sm_megamenu_col_6 sm_megamenu_firstcolumn  sm_megamenu_id38   icon_appears"><div class="sm_megamenu_col_2  sm_megamenu_id39   "><div class="sm_megamenu_head_item ">	</div><div class="sm_megamenu_content"><ul class="list-cat">
<li class="title_cat_megamenu"><a href="https://www.cooking-hacks.com/shop/kits/kits-by-user-level/kits-for-beginners/" title="Beginner">Beginner</a></li>
<li><a href="https://www.cooking-hacks.com/starter-kit/" title="Starter Kit">Starter Kit</a></li>
<li><a href="https://www.cooking-hacks.com/radiation-geiger-kit" title=" Radiation Geiger Kit">Radiation Geiger Kit</a></li>
<li><a href="https://www.cooking-hacks.com/802-15-4-connectivity-kit" title="802.15.4 Connectivity Kit">802.15.4 Connectivity Kit</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-user-level/kits-for-beginners/" title="See all Beginner Kits">See all</a></li>
</ul></div></div><div class="sm_megamenu_col_2  sm_megamenu_id62   "><div class="sm_megamenu_head_item ">	</div><div class="sm_megamenu_content"><ul class="list-cat">
<li class="title_cat_megamenu"><a href="https://www.cooking-hacks.com/shop/kits/kits-by-user-level/intermediate-kits/" title="Intermediate">Intermediate</a></li>
<li><a href="https://www.cooking-hacks.com/waspmote-starter-kit" title="Waspmote Starter Kit ">Waspmote Starter Kit </a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/iot-starter-kits" title="Iot Waspmote Starter Kits">Waspmote Iot Kits</a></li>
<li><a href="https://www.cooking-hacks.com/open-garden-hydroponics" title="Open Garden Hydroponics ">Open Garden Hydroponics</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-user-level/intermediate-kits/" title="See all Intermediate Kits">See all</a></li>
</ul></div></div><div class="sm_megamenu_col_2  sm_megamenu_id63   "><div class="sm_megamenu_head_item ">	</div><div class="sm_megamenu_content"><ul class="list-cat">
<li class="title_cat_megamenu"><a href="https://www.cooking-hacks.com/shop/kits/kits-by-user-level/kits-for-experts/" title="Expert">Expert</a></li>
<li><a href="https://www.cooking-hacks.com/robot-kit" title="Robot Kit">Robot Kit</a></li>
<li><a href="https://www.cooking-hacks.com/wifi-connectivity-kit" title="WiFi Connectivity Kit">WiFi Connectivity Kit</a></li>
<li><a href="https://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-mobile-tracking-kit" title="4G + GPS Mobile Tracking Kit">4G + GPS Mobile Tracking Kit</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-user-level/kits-for-experts/" title="See all Expert Kits">See all</a></li>
<li>&nbsp; </li>
</ul></div></div></div>												</div>
												</li>
									<li class="icon_appears-parent  other-toggle          sm_megamenu_lv1 sm_megamenu_drop parent">
												<a class="sm_megamenu_head sm_megamenu_drop " href="https://www.cooking-hacks.com/shop/kits/kits-by-categories" id="sm_megamenu_44">
																										<span style="background: url(&#39;https://www.cooking-hacks.com/media/wysiwyg/icon_categories.1441867661.png&#39;) no-repeat scroll 0% 50% transparent;" class="sm_megamenu_icon sm_megamenu_nodesc">		
																												<span class="sm_megamenu_title">Kits by Categories</span>
																	
														
													</span>
																																							<span class="icon-item-menu"><img src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/icon_categories.1441867661.png"></span>
																									</a>
																																					<div class="sm-megamenu-child sm_megamenu_dropdown_4columns ">	
													<div class="sm_megamenu_col_4 sm_megamenu_firstcolumn  sm_megamenu_id44   icon_appears"><div class="sm_megamenu_col_3  sm_megamenu_id45   "><div class="sm_megamenu_head_item ">	</div><div class="sm_megamenu_content"><ul class="list-cat">
<li class="title_cat_megamenu"><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/skills/" title="Tutorials by Skills">Skills</a></li>
<li><a href="https://www.cooking-hacks.com/shop/education-kits" title="Education kits">Education kits</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/skills/wireless/" title="Wireless Tutorials">Wireless</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/skills/programming/" title="Programming Tutorials">Programming</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/skills/robotics/" title="Robotics Tutorials">Robotics</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/skills/sensors/" title="Sensors Tutorials">Sensors</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/skills/actuators/" title="Actuators Tutorials">Actuators</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/skills/soldering/" title="Soldering Tutorials">Soldering</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/skills/" title="See all Kits by Skills">See all</a></li>
</ul></div></div><div class="sm_megamenu_col_2 sm_megamenu_firstcolumn  sm_megamenu_id72   "><div class="sm_megamenu_head_item ">	</div><div class="sm_megamenu_content"><ul class="list-cat">
<li class="title_cat_megamenu"><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/applications/" title="Tutorials by Applications">Applications</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/applications/e-health/" title="e-Health Tutorials">e-Health</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/applications/internet-of-things/" title="Internet of Things Tutorials">Internet of Things</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/applications/home-automation/" title="Home Automation Tutorials">Home Automation</a></li>
<!--<li><a href="/shop/kits/kits-by-categories/applications/industrial-control/" title="Industrial Control Tutorials">Industrial Control</a></li>-->
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/applications/agriculture-garden/" title="Agriculture &amp; Garden Tutorials">Agriculture &amp; Garden</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/applications/aquaponics/" title="Aquaponics Tutorials">Aquaponics</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/applications/nuclear-radiation/" title="Nuclear Radiation Tutorials">Nuclear Radiation</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/applications/geolocation-tracking/" title="Geolocation Tracking Tutorials">Geolocation Tracking</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/applications/long-range-networks/" title="Long Range Networks Tutorials">Long Range Networks</a></li>
<li><a href="https://www.cooking-hacks.com/shop/kits/kits-by-categories/applications/" title="See all Kits by Applications">See all</a></li>
<li>&nbsp; </li>
</ul></div></div></div>												</div>
												</li>
						</ul>
		</div>
	</div>
	<!--End Module-->

<script>
	jQuery(document).ready(function($){
		/* $('.bedroom-item-head').parent().addClass('re-width bedroom-style');
		$('.living-rom-item').parent().addClass('re-width living-style'); */
	});
</script>
<script type="text/javascript">
// <![CDATA[ 
$jsmart(document).ready(function(){
	var menu_width = $jsmart('.sm_megamenu_wrapper_horizontal_menu').width();
	$jsmart('.sm_megamenu_wrapper_horizontal_menu .sm_megamenu_menu > li > div').each(function(){
		$this = $jsmart(this);   
		var lv2w = $this.width();
		var lv2ps = $this.position();
		var lv2psl = $this.position().left;
		var sw = lv2w + lv2psl;
		if( sw > menu_width ){
			$this.css({'right': '0'});
		}   
	});
});
// ]]> 
</script><script type="text/javascript">
	$jsmart(document).ready(function($) {
		$('#yt_sidenav li.level0 > a').addClass ('subhead');
		$('#yt_sidenav li.level0 > a').after ('<a href="#" title="" class="toggle">&nbsp;</a>');	//header 
		
		////////////////////
		//$('#yt_sidenav li ul li').has('ul').append( '<span class="more-item-nav">open</span>' );

			var speed=200;
			$('#yt_sidenav li ul li').has('ul').append( '<span class="touch-item">open</span>' );
			
			$('.touch-item').click(function(){
				$(this).prev().slideToggle(speed);
				$(this).toggleClass('change');
				$(this).prev().prev().toggleClass('parentNote');
			});
		// second simple accordion with special markup
		/*$jsmart('#yt_sidenav').accordion({
			active: '.active',
			header: '.toggle',		// same header above
			navigation: true,
			event: 'click',
			fillSpace: false,
			autoheight: false,
			alwaysOpen: false, 
			animated: 'easeslide',
			collapsible: false
		});	*/

		//check if headerId is set, if so activate that id
		if ($jsmart("#yt_sidenav .level2 .current").parents('.parent').length) {
			var header_element = $jsmart("#yt_sidenav .level2 .current").parents('.parent').children('a.toggle');
			$jsmart('#yt_sidenav').accordion('activate', header_element);
		}			

	
	});
</script>
<div class="block block-right-nav block-yt-layered-nav">
  <div class="block-layered-nav-inner">
    <div class="block-title">
		<strong>
			<span>Categories</span>
		</strong>
    </div>
    <div class="block-content clearfix">
        <ul id="yt_sidenav" class="dropdow-nav">
                    <li class="level0 nav-2 parent odd" onmouseover="toggleMenu(this,1)" onmouseout="toggleMenu(this,0)">
<a href="https://www.cooking-hacks.com/shop">
<span>Shop</span>
</a>
<ul class="level0">
<li class="level1 nav-2-1 first parent even" onmouseover="toggleMenu(this,1)" onmouseout="toggleMenu(this,0)">
<a href="https://www.cooking-hacks.com/shop/arduino">
<span>Arduino</span>
</a>
<ul class="level1">
<li class="level2 nav-2-1-1 first odd">
<a href="https://www.cooking-hacks.com/shop/arduino/starter-kits">
<span>Starter Kits</span>
</a>
</li><li class="level2 nav-2-1-2 even">
<a href="https://www.cooking-hacks.com/shop/arduino/shields">
<span>Shields</span>
</a>
</li><li class="level2 nav-2-1-3 last odd">
<a href="https://www.cooking-hacks.com/shop/arduino/wireless">
<span>Wireless</span>
</a>
</li>
</ul>
</li><li class="level1 nav-2-2 parent even" onmouseover="toggleMenu(this,1)" onmouseout="toggleMenu(this,0)">
<a href="https://www.cooking-hacks.com/shop/raspberry-pi">
<span>Raspberry Pi</span>
</a>
<ul class="level1">
<li class="level2 nav-2-2-4 first odd">
<a href="https://www.cooking-hacks.com/shop/raspberry-pi/starter-kit">
<span>Starter Kits</span>
</a>
</li><li class="level2 nav-2-2-5 even">
<a href="https://www.cooking-hacks.com/shop/raspberry-pi/shields">
<span>Shields</span>
</a>
</li><li class="level2 nav-2-2-6 last odd">
<a href="https://www.cooking-hacks.com/shop/raspberry-pi/wireless">
<span>Wireless</span>
</a>
</li>
</ul>
</li><li class="level1 nav-2-3 parent even" onmouseover="toggleMenu(this,1)" onmouseout="toggleMenu(this,0)">
<a href="https://www.cooking-hacks.com/shop/waspmote">
<span>Waspmote</span>
</a>
<ul class="level1">
<li class="level2 nav-2-3-7 first odd">
<a href="https://www.cooking-hacks.com/shop/waspmote/kits">
<span>Kits</span>
</a>
</li><li class="level2 nav-2-3-8 even">
<a href="https://www.cooking-hacks.com/shop/waspmote/core-boards">
<span>Core Boards</span>
</a>
</li><li class="level2 nav-2-3-9 odd">
<a href="https://www.cooking-hacks.com/shop/waspmote/sensor-boards">
<span>Sensor Boards</span>
</a>
</li><li class="level2 nav-2-3-10 even">
<a href="https://www.cooking-hacks.com/shop/waspmote/sensors">
<span>Sensors</span>
</a>
</li><li class="level2 nav-2-3-11 odd">
<a href="https://www.cooking-hacks.com/shop/waspmote/wireless">
<span>Wireless</span>
</a>
</li><li class="level2 nav-2-3-12 last even">
<a href="https://www.cooking-hacks.com/shop/waspmote/accessories">
<span>Accessories</span>
</a>
</li>
</ul>
</li><li class="level1 nav-2-4 parent odd" onmouseover="toggleMenu(this,1)" onmouseout="toggleMenu(this,0)">
<a href="https://www.cooking-hacks.com/shop/intel-galileo">
<span>Intel Galileo</span>
</a>
<ul class="level1">
<li class="level2 nav-2-4-13 first even">
<a href="https://www.cooking-hacks.com/shop/intel-galileo/starter-kits">
<span>Starter Kits</span>
</a>
</li><li class="level2 nav-2-4-14 odd">
<a href="https://www.cooking-hacks.com/shop/intel-galileo/shields">
<span>Shields</span>
</a>
</li><li class="level2 nav-2-4-15 last even">
<a href="https://www.cooking-hacks.com/shop/intel-galileo/wireless">
<span>Wireless</span>
</a>
</li>
</ul>
</li><li class="level1 nav-2-5 parent odd" onmouseover="toggleMenu(this,1)" onmouseout="toggleMenu(this,0)">
<a href="https://www.cooking-hacks.com/shop/wireless">
<span>Wireless</span>
</a>
<ul class="level1">
<li class="level2 nav-2-5-16 first even">
<a href="https://www.cooking-hacks.com/shop/wireless/antennas">
<span>Antennas</span>
</a>
</li><li class="level2 nav-2-5-17 odd">
<a href="https://www.cooking-hacks.com/shop/wireless/802-15-4-zigbee">
<span>802.15.4 / ZigBee</span>
</a>
</li><li class="level2 nav-2-5-18 even">
<a href="https://www.cooking-hacks.com/shop/wireless/gprs-3g-4g">
<span>GPRS / 3G / 4G</span>
</a>
</li><li class="level2 nav-2-5-19 odd">
<a href="https://www.cooking-hacks.com/shop/wireless/extreme-range-lora">
<span>LoRa</span>
</a>
</li><li class="level2 nav-2-5-20 even">
<a href="https://www.cooking-hacks.com/shop/wireless/lorawan">
<span>LoRaWAN</span>
</a>
</li><li class="level2 nav-2-5-21 odd">
<a href="https://www.cooking-hacks.com/shop/wireless/sigfox">
<span>Sigfox</span>
</a>
</li><li class="level2 nav-2-5-22 even">
<a href="https://www.cooking-hacks.com/shop/wireless/wifi">
<span>WiFi</span>
</a>
</li><li class="level2 nav-2-5-23 odd">
<a href="https://www.cooking-hacks.com/shop/wireless/bluetooth">
<span>Bluetooth</span>
</a>
</li><li class="level2 nav-2-5-24 even">
<a href="https://www.cooking-hacks.com/shop/wireless/rfid-nfc">
<span>RFID / NFC</span>
</a>
</li><li class="level2 nav-2-5-25 odd">
<a href="https://www.cooking-hacks.com/shop/wireless/gps">
<span>GPS</span>
</a>
</li><li class="level2 nav-2-5-26 last even">
<a href="https://www.cooking-hacks.com/shop/wireless/rf">
<span>RF</span>
</a>
</li>
</ul>
</li><li class="level1 nav-2-6 parent odd" onmouseover="toggleMenu(this,1)" onmouseout="toggleMenu(this,0)">
<a href="https://www.cooking-hacks.com/shop/sensors">
<span>Sensors</span>
</a>
<ul class="level1">
<li class="level2 nav-2-6-27 first even">
<a href="https://www.cooking-hacks.com/shop/sensors/e-health">
<span>e-Health</span>
</a>
</li><li class="level2 nav-2-6-28 odd">
<a href="https://www.cooking-hacks.com/shop/sensors/agriculture">
<span>Agriculture</span>
</a>
</li><li class="level2 nav-2-6-29 even">
<a href="https://www.cooking-hacks.com/shop/sensors/temperature">
<span>Temp. &amp; Humi.</span>
</a>
</li><li class="level2 nav-2-6-30 odd">
<a href="https://www.cooking-hacks.com/shop/sensors/water-quality">
<span>Water Quality</span>
</a>
</li><li class="level2 nav-2-6-31 even">
<a href="https://www.cooking-hacks.com/shop/sensors/motion">
<span>Motion</span>
</a>
</li><li class="level2 nav-2-6-32 odd">
<a href="https://www.cooking-hacks.com/shop/sensors/gas">
<span>Gas</span>
</a>
</li><li class="level2 nav-2-6-33 even">
<a href="https://www.cooking-hacks.com/shop/sensors/proximity">
<span>Proximity</span>
</a>
</li><li class="level2 nav-2-6-34 odd">
<a href="https://www.cooking-hacks.com/shop/sensors/flow">
<span>Flow</span>
</a>
</li><li class="level2 nav-2-6-35 even">
<a href="https://www.cooking-hacks.com/shop/sensors/light">
<span>Light</span>
</a>
</li><li class="level2 nav-2-6-36 odd">
<a href="https://www.cooking-hacks.com/shop/sensors/sound">
<span>Sound</span>
</a>
</li><li class="level2 nav-2-6-37 last even">
<a href="https://www.cooking-hacks.com/shop/sensors/gps">
<span>GPS</span>
</a>
</li>
</ul>
</li><li class="level1 nav-2-7 odd">
<a href="https://www.cooking-hacks.com/shop/actuators">
<span>Actuators</span>
</a>
</li><li class="level1 nav-2-8 even">
<a href="https://www.cooking-hacks.com/shop/misc">
<span>Misc</span>
</a>
</li><li class="level1 nav-2-9 last odd">
<a href="https://www.cooking-hacks.com/shop/3d-printer">
<span>3D Printer</span>
</a>
</li>
</ul>
</li>                </ul>
        <script type="text/javascript">
       	 	decorateList('yt_sidenav')
		</script>
    </div>
      </div>
</div>
		<script type="text/javascript" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/jquery.noconflict.1441867825.js.tải xuống"></script><script type="text/javascript" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/sm-megamenu.1438164066.js.tải xuống"></script>	<script type="text/javascript">
						$jsmart(function() {
				effect_duration = 1;
				if(effect_duration <= 0){
					effect_duration = 800;
				}		
				if( $jsmart('#sm_megamenu_menu58aee41cdfe93 li.sm_megamenu_lv1').parent().hasClass('sm-megamenu-hover') ){				
					$jsmart('#sm_megamenu_menu58aee41cdfe93 li.sm_megamenu_lv1').hover(
						function(e) {
							wd = $jsmart(window).width();
							if( wd > 800){
								w = getWbc($jsmart(this).children('div'));
							}else{
								w = getWbctb($jsmart(this).children('div'));
							}
							if(w){
								$jsmart(this).children('div').css({opacity:'1',width:'0px'});
								$jsmart(this).children('div').stop(true,true).animate({
									width: w, 
									opacity:'1'
								}, effect_duration );
							}
						},
						function(e) {
							$jsmart(this).children('div').stop(true,true).animate({
								width: '0px',
								opacity:'0'
							}, 300);
						});
					}
			});	

			function getWbc(e){	//get width by class class_width, return number px
				json_class_width = {
						'sm_megamenu_dropdown_1column': '125',
						'sm_megamenu_dropdown_2columns': '250',
						'sm_megamenu_dropdown_3columns': '375',
						'sm_megamenu_dropdown_4columns': '500',
						'sm_megamenu_dropdown_5columns': '625',
						'sm_megamenu_dropdown_6columns': '750',
						'sm_megamenu_dropdown_fullwidth': '750'
					};
				for(var key in json_class_width){
					if ( json_class_width.hasOwnProperty ( key ) ){
						// alert( key �=>� json_class_width [ key ] );
						if(e.hasClass(key)){
							return json_class_width[ key ];
						}
					}
				}
				return false;	
			}
			function getWbctb(e){	//get width by class class_width, return number px
				json_class_width = {
						'sm_megamenu_dropdown_1column': '125',
						'sm_megamenu_dropdown_2columns': '250',
						'sm_megamenu_dropdown_3columns': '375',
						'sm_megamenu_dropdown_4columns': '500',
						'sm_megamenu_dropdown_5columns': '510',
						'sm_megamenu_dropdown_6columns': '510',
						'sm_megamenu_dropdown_fullwidth': '510'
					};
				for(var key in json_class_width){
					if ( json_class_width.hasOwnProperty ( key ) ){
						// alert( key �=>� json_class_width [ key ] );
						if(e.hasClass(key)){
							return json_class_width[ key ];
						}
					}
				}
				return false;	
			}
			
				
		// ]]> 
	</script>
	

<!--<link media="all" href="--><!--" type="text/css" rel="stylesheet">-->

		
	<div class="sm_megamenu_wrapper_vertical_menu sambar" id="sm_megamenu_menu58aee41cdfe93" data-sam="19990264211487856668">
		<div class="sambar-inner">
			<a class="btn-sambar" data-sapi="collapse" href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#sm_megamenu_menu58aee41cdfe93">
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</a>	
			<ul class=" sm_megamenu_menu sm_megamenu_menu_black" data-jsapi="on">
									<li class="other-toggle          sm_megamenu_lv1 sm_megamenu_drop parent">
												<a class="sm_megamenu_head sm_megamenu_drop " href="https://www.cooking-hacks.com/shop/new-products" id="sm_megamenu_66">
																										<span style="background: url(&#39;https://www.cooking-hacks.com/media/wysiwyg/icon_new_products.1438164076.png&#39;) no-repeat scroll 0% 50% transparent;" class="sm_megamenu_icon sm_megamenu_nodesc">		
																												<span class="sm_megamenu_title">New Products</span>
																	
														
													</span>
																																							<span class="icon-item-menu"><img src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/icon_new_products.1438164076.png"></span>
																									</a>
																																	</li><li class="other-toggle          sm_megamenu_lv1 sm_megamenu_drop parent">
												<a class="sm_megamenu_head sm_megamenu_drop " href="https://www.cooking-hacks.com/shop/sales" id="sm_megamenu_67">
																										<span style="background: url(&#39;https://www.cooking-hacks.com/media/wysiwyg/icon_sales_products.1438164076.png&#39;) no-repeat scroll 0% 50% transparent;" class="sm_megamenu_icon sm_megamenu_nodesc">		
																												<span class="sm_megamenu_title">Sales</span>
																	
														
													</span>
																																							<span class="icon-item-menu"><img src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/icon_sales_products.1438164076.png"></span>
																									</a>
																																	</li><li class="other-toggle          sm_megamenu_lv1 sm_megamenu_drop parent">
												<a class="sm_megamenu_head sm_megamenu_drop " href="https://www.cooking-hacks.com/shop/top-sellers" id="sm_megamenu_65">
																										<span style="background: url(&#39;https://www.cooking-hacks.com/media/wysiwyg/icon_hot_products.1438164076.png&#39;) no-repeat scroll 0% 50% transparent;" class="sm_megamenu_icon sm_megamenu_nodesc">		
																												<span class="sm_megamenu_title">Hot Products</span>
																	
														
													</span>
																																							<span class="icon-item-menu"><img src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/icon_hot_products.1438164076.png"></span>
																									</a>
																														</li></ul>
		</div>
	</div>
	<!--End Module-->

<script>
	jQuery(document).ready(function($){
		/* $('.bedroom-item-head').parent().addClass('re-width bedroom-style');
		$('.living-rom-item').parent().addClass('re-width living-style'); */
	});
</script>
<script type="text/javascript">
// <![CDATA[ 
$jsmart(document).ready(function(){
	var menu_width = $jsmart('.sm_megamenu_wrapper_horizontal_menu').width();
	$jsmart('.sm_megamenu_wrapper_horizontal_menu .sm_megamenu_menu > li > div').each(function(){
		$this = $jsmart(this);   
		var lv2w = $this.width();
		var lv2ps = $this.position();
		var lv2psl = $this.position().left;
		var sw = lv2w + lv2psl;
		if( sw > menu_width ){
			$this.css({'right': '0'});
		}   
	});
});
// ]]> 
</script><div id="column_left_related" class="evolved_class">
<p style="margin-bottom: 15px;">
	<a onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;BannerWeekSigfox&#39;, &#39;ClickBanner&#39;, &#39;Waspmote Smart Parking&#39;]);" href="https://www.cooking-hacks.com/shop/wireless/sigfox">
               <img src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/banner_week_sigfox.jpg" alt="SIGFOX modules for Arduino, Raspberry Pi and Waspmote with one year of free certification">
	</a>
</p>
</div>

							</div>
						</div>
						
						<div id="yt_main" class="yt-main-right yt-main col-main col-lg-9 col-md-9 col-sm-8 col-xs-12">
							<div class="yt_main_inner">
								    <noscript class="evolved_class">
        &amp;lt;div class="global-site-notice noscript"&amp;gt;
            &amp;lt;div class="notice-inner"&amp;gt;
                &amp;lt;p&amp;gt;
                    &amp;lt;strong&amp;gt;JavaScript seems to be disabled in your browser.&amp;lt;/strong&amp;gt;&amp;lt;br /&amp;gt;
                    You must have JavaScript enabled in your browser to utilize the functionality of this website.                &amp;lt;/p&amp;gt;
            &amp;lt;/div&amp;gt;
        &amp;lt;/div&amp;gt;
    </noscript>
																 
								
																
								    <script type="text/javascript">
    //<![CDATA[
        var thisevolvedupdate = new evolvedupdate();
                    thisevolvedupdate.blocks = {};                            thisevolvedupdate.blocks["0"] = "mini-cartpro";                            thisevolvedupdate.blocks["1"] = "global_messages";                            thisevolvedupdate.blocks["2"] = "quick-info";                            thisevolvedupdate.blocks["3"] = "catalog.product.relatedwidget";                            thisevolvedupdate.blocks["4"] = "welcome";                            thisevolvedupdate.blocks["5"] = "column_left_related";                            thisevolvedupdate.blocks["6"] = "header_messages";                            thisevolvedupdate.blocks["7"] = "global_notices";                            
        thisevolvedupdate.fadespeed = 0.4;        thisevolvedupdate.slidespeed = 0;        thisevolvedupdate.price = false;        thisevolvedupdate.creview = false;        thisevolvedupdate.cart = false;        thisevolvedupdate.preview = false;        thisevolvedupdate.tier = false;        thisevolvedupdate.welcome = false;        thisevolvedupdate.isreview = false;        thisevolvedupdate.useajax = true;    //]]>
    </script>
    <div class="page-title">
        <h1>Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi</h1>
    </div>
<div class="std"><!--

  Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi
  
  Last update: 16/06/15 Jorge Casanova

-->

        <!-- ############## INICIO DE TUTORIAL ############## -->
<div class="cms_page">
<div class="section_title">
	
<div class="difficulty_level hard">
   <span class="difficulty_text">Difficulty Level: Expert - </span><span class="difficulty_icon"></span>
</div>
	<div class="row">
		<div class="col-xs-12 col-md-6 vcenter">
		<script type="text/javascript">
var addthis_config = {
     pubid: "ra-550b04b6022f544d",
     "data_track_addressbar":false
}

var addthis_share = {
     url_transforms : {
          shorten: {
               twitter: 'bitly'
          }
     }, 
     shorteners : {
          bitly : {} 
     }
}
</script>

<div class="addthis_toolbox addthis_default_style addthis_default_style">
<a class="addthis_button_facebook_like at300b" fb:like:layout="button_count"><div class="fb-like fb_iframe_widget" data-layout="button_count" data-show_faces="false" data-share="true" data-action="like" data-width="90" data-height="25" data-font="arial" data-href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi" data-send="false" style="height: 25px;" fb-xfbml-state="rendered" fb-iframe-plugin-query="action=like&amp;app_id=172525162793917&amp;container_width=125&amp;font=arial&amp;height=25&amp;href=https%3A%2F%2Fwww.cooking-hacks.com%2Fdocumentation%2Ftutorials%2Fgeolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;send=false&amp;share=true&amp;show_faces=false&amp;width=90"><span style="vertical-align: bottom; width: 125px; height: 20px;"><iframe name="fdcf95433834f4" width="90px" height="25px" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" title="fb:like Facebook Social Plugin" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/like.html" style="border: none; visibility: visible; width: 125px; height: 20px;" class=""></iframe></span></div></a>
<a class="addthis_button_tweet at300b"><div class="tweet_iframe_widget" style="width: 62px; height: 25px;"><span><iframe title="AddThis | Twitter" frameborder="0" role="presentation" scrolling="no" allowtransparency="true" scrollbars="no" style="width:62px; height:25px;" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/tweet.html"></iframe></span></div></a>
<a class="addthis_button_twitter addthis_button_preferred_1 at300b" title="Twitter" href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#"><span class="at-icon-wrapper" style="background-color: rgb(29, 161, 242); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" title="Twitter" alt="Twitter" class="at-icon at-icon-twitter" style="width: 16px; height: 16px;"><g><path d="M27.996 10.116c-.81.36-1.68.602-2.592.71a4.526 4.526 0 0 0 1.984-2.496 9.037 9.037 0 0 1-2.866 1.095 4.513 4.513 0 0 0-7.69 4.116 12.81 12.81 0 0 1-9.3-4.715 4.49 4.49 0 0 0-.612 2.27 4.51 4.51 0 0 0 2.008 3.755 4.495 4.495 0 0 1-2.044-.564v.057a4.515 4.515 0 0 0 3.62 4.425 4.52 4.52 0 0 1-2.04.077 4.517 4.517 0 0 0 4.217 3.134 9.055 9.055 0 0 1-5.604 1.93A9.18 9.18 0 0 1 6 23.85a12.773 12.773 0 0 0 6.918 2.027c8.3 0 12.84-6.876 12.84-12.84 0-.195-.005-.39-.014-.583a9.172 9.172 0 0 0 2.252-2.336" fill-rule="evenodd"></path></g></svg></span></a>
<a class="addthis_button_facebook addthis_button_preferred_2 at300b" title="Facebook" href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#"><span class="at-icon-wrapper" style="background-color: rgb(59, 89, 152); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" title="Facebook" alt="Facebook" class="at-icon at-icon-facebook" style="width: 16px; height: 16px;"><g><path d="M22 5.16c-.406-.054-1.806-.16-3.43-.16-3.4 0-5.733 1.825-5.733 5.17v2.882H9v3.913h3.837V27h4.604V16.965h3.823l.587-3.913h-4.41v-2.5c0-1.123.347-1.903 2.198-1.903H22V5.16z" fill-rule="evenodd"></path></g></svg></span></a>
<a class="addthis_button_youtube addthis_button_preferred_3 at300b" target="_blank" title="YouTube" href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#"><span class="at-icon-wrapper" style="background-color: rgb(205, 32, 31); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" title="YouTube" alt="YouTube" class="at-icon at-icon-youtube" style="width: 16px; height: 16px;"><g><path d="M13.73 18.974V12.57l5.945 3.212-5.944 3.192zm12.18-9.778c-.837-.908-1.775-.912-2.205-.965C20.625 8 16.007 8 16.007 8c-.01 0-4.628 0-7.708.23-.43.054-1.368.058-2.205.966-.66.692-.875 2.263-.875 2.263S5 13.303 5 15.15v1.728c0 1.845.22 3.69.22 3.69s.215 1.57.875 2.262c.837.908 1.936.88 2.426.975 1.76.175 7.482.23 7.482.15 0 .08 4.624.072 7.703-.16.43-.052 1.368-.057 2.205-.965.66-.69.875-2.262.875-2.262s.22-1.845.22-3.69v-1.73c0-1.844-.22-3.69-.22-3.69s-.215-1.57-.875-2.262z" fill-rule="evenodd"></path></g></svg></span></a>
<a class="addthis_button_print addthis_button_preferred_4 at300b" title="Print" href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#"><span class="at-icon-wrapper" style="background-color: rgb(115, 138, 141); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" title="Print" alt="Print" class="at-icon at-icon-print" style="width: 16px; height: 16px;"><g><path d="M24.67 10.62h-2.86V7.49H10.82v3.12H7.95c-.5 0-.9.4-.9.9v7.66h3.77v1.31L15 24.66h6.81v-5.44h3.77v-7.7c-.01-.5-.41-.9-.91-.9zM11.88 8.56h8.86v2.06h-8.86V8.56zm10.98 9.18h-1.05v-2.1h-1.06v7.96H16.4c-1.58 0-.82-3.74-.82-3.74s-3.65.89-3.69-.78v-3.43h-1.06v2.06H9.77v-3.58h13.09v3.61zm.75-4.91c-.4 0-.72-.32-.72-.72s.32-.72.72-.72c.4 0 .72.32.72.72s-.32.72-.72.72zm-4.12 2.96h-6.1v1.06h6.1v-1.06zm-6.11 3.15h6.1v-1.06h-6.1v1.06z"></path></g></svg></span></a>
<a class="addthis_button_compact at300m" href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#"><span class="at-icon-wrapper" style="background-color: rgb(255, 101, 80); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" title="More" alt="More" class="at-icon at-icon-addthis" style="width: 16px; height: 16px;"><g><path d="M18 14V8h-4v6H8v4h6v6h4v-6h6v-4h-6z" fill-rule="evenodd"></path></g></svg></span></a>
<div class="atclear"></div></div>

<script type="text/javascript" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/addthis_widget.js.tải xuống"></script>
		</div>
		<div class="col-xs-12 col-md-6 vcenter">
			<a href="http://www.cooking-hacks.com/gprs-gps-quadband-module-for-arduino-sim908" class="btn btn-danger pull-right">Buy now <span class="glyphicon glyphicon-shopping-cart"></span></a>
		</div>				
	</div> 
	<br><br>
    <p class="text-justify">The new shield designed for Arduino and Raspberry Pi integrates the SIM908 module which counts with both <strong>GPRS</strong> and <strong>GPS</strong> technologies what allows to easily perform <strong>realtime tracking</strong> applications. The idea is simple: read the GPS coordinates (longitude and latitude) and send them by using a <strong>HTTP request</strong> to a web server. Then use a browser to load the PHP webpage which uses <strong>Googlemaps</strong> to show the location in realtime.</p>
	<p class="text-justify">All the code including the PHP scripts and the Arduino program can be downloaded and it has been released with an open source license.</p>
	<p class="text-justify">Enjoy!</p>
	
	<div class="row">
                <div class="col-xs-12 col-md-6">
					<a id="img_0" href="https://www.cooking-hacks.com/media/cooking/images/documentation/tutorial-sim-908/geolocaton_shield_908_map1_big.png" class="lb_photo " rel="set_1" title=""><img class="img-responsive lb margin_bottom" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/geolocaton_shield_908_map1_small.png"></a>
                </div>
                
                <div class="col-xs-12 col-md-6">
					<a id="img_1" href="https://www.cooking-hacks.com/media/cooking/images/documentation/tutorial-sim-908/geolocaton_shield_908_map2_big.png" class="lb_photo " rel="set_1" title=""><img class="img-responsive lb" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/geolocaton_shield_908_map2_small.png"></a>
				</div>
		</div>	
	
</div>

<!-- ############## TUTORIAL INDEX ############## -->
<div class="section_title">
	<h2 class="nogotoindex"><a name="index"></a>Tutorial Index</h2>
	<ul>
        <li>
            <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#ingredients">Ingredients</a>
        </li>
        <li>
            <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#shield">Step 1: The shield (hardware)</a>
        </li>
        <li>
            <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#raspberrypi">Step 1b - Using the GPRS+GPS module with Raspberry Pi</a>
        </li>
        <li>
            <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#atcommands">Step 2: Using GPRS+GPS module with AT commands</a>
        </li>
        <li>
            <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#powering">Step 3: Powering the board</a>
        </li>
        <li>
            <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#calls">Step 4: Using the shield in standalone mode - Calls</a>
        </li>
        <li>
            <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#sms">Step 5: Using the shield in standalone mode - Sending and receiving SMS</a>
        </li>
        <li>
            <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#ftp">Step 6: Using the shield in standalone mode - FTP</a>
        </li>
        <li>
            <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#tcp-udp">Step 7: Using the shield in standalone mode - TCP and UDP</a>
        </li>
        <li>
            <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#http">Step 8: Using the shield in standalone mode - HTTP</a>
        </li>
        <li>
            <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#gps">Step 9: Using the shield in standalone mode - GPS</a>
        </li>
        <li>
            <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#realtime-geolocation-tracking">
                Realtime geolocation tracking
            </a>
        </li>
        <li>
            <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#celular">
                Choosing the right cellular module for Arduino and Raspberry Pi: 4G / 3G / GPRS / GSM
            </a>
        </li>
        <li><a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#compatibility">Device Compatibility</a></li>
        <li>
            <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#documentation">Documentation</a>
        </li>
        <li>
            <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#get-the-shields">Get the Shields</a>
        </li>
    </ul>
</div>

<!-- ############## INGREDIENTS ############## -->
<div class="section_title">
	<h2><a name="ingredients" class="ancla"></a>Ingredients <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#index" class="pull-right goto">Go to index <span class="glyphicon glyphicon-arrow-up"></span></a></h2>
	<div class="row">
		<div class="col-xs-12 col-md-7 vcenter">
			<ul>
                <li>1 x <a href="http://www.cooking-hacks.com/index.php/arduino-uno.html">Arduino</a> or 1 x <a href="http://www.cooking-hacks.com/index.php/shop/raspberry-pi/starter-kit-for-raspberry-pi-raspberry-pi.html">Starter Kit for Raspberry Pi + Raspberry Pi</a></li>
                <li>1 x <a href="http://www.cooking-hacks.com/index.php/gprs-gps-quadband-module-for-arduino-sim908.html">GPRS+GPS Quadband Module for Arduino (SIM908)</a></li>
                <li>1 x <a href="http://www.cooking-hacks.com/shop/accessories/antennas/internal-4g-3g-gprs-gsm-antenna">GPRS antenna</a></li>
                <li>1 x <a href="http://www.cooking-hacks.com/index.php/internal-gps-antenna.html">GPS antenna</a></li>
                <li>1 x SIM card</li>
                <li>1 x PC</li>
            </ul>
            <p class="text-justify"><strong>Preparation Time:</strong> 60 minutes</p>
        </div>
        <div class="col-xs-12 col-md-5 vcenter">
            <img class="img-responsive center-block" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/shield_arduino_gateway_intro.png">
        </div>
	</div>
	<div class="alert alert-warning">
		<p class="text-justify"><strong><u>NOTE: </u></strong>If you are looking for a complete solution to use <a href="http://www.cooking-hacks.com/index.php/3g-gprs-shield-for-arduino-3g-gps.html" class="alert-link" target="_blank">3G, GPRS and A-GPS, you can use our 3G/GPRS shield for Arduino (3G + GPRS)</a> or our <a href="http://www.cooking-hacks.com/index.php/3g-gprs-shield-for-arduino-3g-gps-audio-video-kit.html" class="alert-link" target="_blank">Kit with Audio/Video</a>  </p>
	</div>	
	<div class="alert alert-warning">
		<p class="text-justify"><strong><u>NOTE: </u></strong>The codes of the tutorial have developed to work on Arduino IDE v1.0.1</p>
	</div>		
</div>


<!-- ############## Step 1: The shield (hardware) ############## -->
<div class="section_title">
	<h2><a name="shield" class="ancla"></a>Step 1: The shield (hardware) <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#index" class="pull-right goto">Go to index <span class="glyphicon glyphicon-arrow-up"></span></a></h2>
	<p class="text-justify">The board (shield) we are going to use in this tutorial is the <a href="http://www.cooking-hacks.com/gprs-gps-quadband-module-for-arduino-sim908" class="alert-link" target="_blank">GPRS+GPS Quadband Module for Arduino (SIM908)</a> from Cooking hacks.</p>
	<p class="text-justify">The GPRS+GPS shield is fully compatible with old Arduino USB versions, Duemilanove and Mega.</p>
	<div class="alert alert-danger">
		<u><strong>NOTE:</strong></u> The Arduino/Raspberry Pi jumper <strong>MUST</strong> be in Arduino position. The Raspberry Pi position should be used only if the shield is connected to a Raspberry Pi. 
A wrong position of this jumper can damage the GPRS+GPS shield.
    </div>	
    <h3>GPRS+GPS shield diagram (top):</h3>
    <a id="img_2" href="https://www.cooking-hacks.com/media/cooking/images/documentation/tutorial-sim-908/top_diagram_big.png" class="lb_photo " rel="set_1" title=""><img class="img-responsive center-block lb" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/top_diagram_small.png"></a>
    <h3>GPRS+GPS shield diagram (bottom):</h3>
	<a id="img_3" href="https://www.cooking-hacks.com/media/cooking/images/documentation/tutorial-sim-908/bottom_diagram_big.png" class="lb_photo " rel="set_1" title=""><img class="img-responsive center-block lb" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/bottom_diagram_small.png"></a>
	<p class="text-justify">The LED of the shield shows the status of the GPRS+GPS module. The table below shows the meaning of the blink of the LED.</p>
	<div class="row">
		<div class="col-xs-12 col-md-2">
			</div>
		<div class="col-xs-12 col-md-8">	
	<table class="table table-bordered table-hover table-bordered">
		<tbody><tr>
            <th>Status</th>
            <th>SIM908 behavior</th>
        </tr>
        <tr>
            <td>Off</td>
            <td>SIM908 is not running</td>
        </tr>
        <tr>
            <td>64ms On/ 800ms Off</td>
            <td>SIM908 not registered the network</td>
        </tr>
        <tr>
            <td>64ms On/ 3000ms Off</td>
            <td>SIM908 registered to the network</td>
        </tr>
        <tr>
            <td>SIM908 registered to the network</td>
            <td>PPP GPRS communication is established</td>
        </tr>
	</tbody></table>
		</div>
	<div class="col-xs-12 col-md-2">
	</div>
	</div>
</div>

<!-- ############## Step 1b - Using the GPRS+GPS module with Raspberry Pi ############## -->
<div class="section_title">
	<h2><a name="raspberrypi" class="ancla"></a>Step 1b: Using the GPRS+GPS module with Raspberry Pi <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#index" class="pull-right goto">Go to index <span class="glyphicon glyphicon-arrow-up"></span></a></h2>
	<p class="text-justify">The new GPRS+GPS module can be plugged to Raspberry Pi using the <a href="http://www.cooking-hacks.com/index.php/documentation/tutorials/raspberry-pi-to-arduino-shields-connection-bridge" class="alert-link" target="_blank">Raspberry Pi to Arduino shields connection bridge</a>.</p>
	<a id="img_4" href="https://www.cooking-hacks.com/media/cooking/images/documentation/tutorial-sim-908/raspberry_pi_shield_908_big.png" class="lb_photo " rel="set_1" title=""><img class="img-responsive center-block lb" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/raspberry_pi_shield_908_small.png"></a>
	<p class="text-justify">Using <a href="http://www.cooking-hacks.com/index.php/documentation/tutorials/raspberry-pi-to-arduino-shields-connection-bridge#step4" class="alert-link" target="_blank">arduPi</a> library lets you to program applications for controling the GPRS+GPS in a very similar way to Arduino.</p>
	<p class="text-justify">The steps are the following:</p>
	<p class="text-justify">1. Paste the arduino code on the template where it says: <strong>YOUR ARDUINO CODE HERE</strong></p>
    <div class="code cpp">
    <div class="code_tools">
		<button class="btn btn-info btn-xs">Hide code</button>
        <div class="pull-left">Code:</div>
    </div>
    <pre class="hljs" style="display: block;"><span class="hljs-comment">//Include arduPi library</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> "arduPi.h"</span>

<span class="hljs-comment">/*********************************************************
 *  IF YOUR ARDUINO CODE HAS OTHER FUNCTIONS APART FROM  *
 *  setup() AND loop() YOU MUST DECLARE THEM HERE        *
 * *******************************************************/</span>

<span class="hljs-comment">/**************************
 * YOUR ARDUINO CODE HERE *
 * ************************/</span>

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span> <span class="hljs-params">()</span></span>{
    setup();
    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>){
        loop();
    }
    <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>);
}
    </pre>
    <div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>
    <p class="text-justify">2. Compile the file as follows:</p>
 	<div class="code cpp">
		<pre class="hljs">g++ -lrt -lpthread my_program.cpp arduPi.cpp -o my_program
		</pre>
    <div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>	   
	
</div>

<!-- ############## Step 2: Using GPRS+GPS module with AT commands ############## -->
<div class="section_title">
	<h2><a name="atcommands" class="ancla"></a>Step 2: Using GPRS+GPS module with AT commands <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#index" class="pull-right goto">Go to index <span class="glyphicon glyphicon-arrow-up"></span></a></h2>
	<p class="text-justify"><strong>Important issues:</strong></p>
    <ul>
        <li>Use capital letters for AT commands.</li>
        <li>Send CR (Carriage return) and LF (Line feed) after the AT command.</li>
        <li>Place the serial communication jumpers in the right position.</li>
		<li>Use an external power supply and place the power jumpers 
		in the right position. If the shield is powered from the 
		Arduino, the power jumper must be in Arduino 5V position. It 
		the shield is powered from the Vin input (in the shield), 
		the power jumper must be in Vext position.</li>
    </ul>	
    
    	<div class="row">
		<div class="col-xs-12 col-md-2">
			</div>
	<div class="col-xs-12 col-md-8">			
	<table class="table table-bordered table-hover table-bordered">
        <tbody><tr>
            <th><strong>Command</strong></th>
            <th><strong>Response</strong></th>
            <th><strong>Description</strong></th>
        </tr>
        <tr>
            <td>AT</td>
            <td>OK</td>
            <td>If you get OK, the communication with the module is working</td>
        </tr>
        <tr>
            <td>AT+CPIN="****"</td>
            <td>OK</td>
            <td>If the SIM card is locked with PIN (**** is the pin number)</td>
        </tr>
        <tr>
            <td>AT+COPS?</td>
            <td>&nbsp;</td>
            <td>Operator information</td>
        </tr>		
	</tbody></table>
	</div>
	

	
		<div class="col-xs-12 col-md-2">
			</div>	
	</div>
	

	
    <h3>Using GPRS+GPS module with AT commands in Arduino</h3>
    <p class="text-justify">The first thing we are going to do with the module is to connect the module to a PC directly (using an Arduino as gateway) and check the basic AT commands. In this case, serial communication jumpers have to be set on USB gateway position.</p>
    <p class="text-justify"><strong>Remember take out the ATmega microcontroller from the Arduino gateway.</strong></p>
	
	<a id="img_5" href="https://www.cooking-hacks.com/media/cooking/images/documentation/tutorial-sim-908/arduino_gateway_big.png" class="lb_photo " rel="set_1" title=""><img class="img-responsive center-block lb" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/arduino_gateway_small.png"></a>
	<p class="text-justify">Connect the antennas to the shield:</p>
	<a id="img_6" href="https://www.cooking-hacks.com/media/cooking/images/documentation/tutorial-sim-908/shield_908_antennas_big.png" class="lb_photo " rel="set_1" title=""><img class="img-responsive center-block lb" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/shield_908_antennas_small.png"></a>
	<p class="text-justify">Connect the shield to the Arduino gateway:</p>
	<a id="img_7" href="https://www.cooking-hacks.com/media/cooking/images/documentation/tutorial-sim-908/shield_arduino_gateway_big.png" class="lb_photo " rel="set_1" title=""><img class="img-responsive center-block lb" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/shield_arduino_gateway_small.png"></a>
	<p class="text-justify">Then connect the USB cable and the SIM card.</p>
	<p class="text-justify">Finally plug the USB cable to the computer and open a serial port terminal to communicate via the usb port (e.g: hyperterminal (win), cutecom / gtkterm (linux)).</p>
	<p class="text-justify"><strong>If you use the Arduino IDE serial monitor for sending AT commands – Be sure that you are sending CR (Carriage return) and LF (Line Feed).</strong></p>
	<p class="text-justify">Set the baudrate to 115200 bps and open the serial port, then press the ON button for two seconds. Then if you type <strong>AT you'll get OK</strong>, this means that the communication with the module is working fine. Now, with the module working you can check some AT commands to control the module, the basic commands are:</p>
	<p class="text-justify"><strong>Important type commands in capital letters and with CR (carriage return) and LF (line feed)!!!</strong></p>

	
	
		<div class="alert alert-warning">
		<p class="text-justify"><strong><u>NOTE: </u></strong>With some sketches, the buffer of the UART may be small, 
		to increase the length of the buffer you need to change these lines in the file HardwareSerial.h in 
		/arduino-1.0.X/hardware/arduino/avr/cores/arduino/
		
		
		
		(or in file HardwareSerial.cpp in /arduino-1.0.X/hardware/arduino/cores/arduino/ depending on the Arduino IDE version)
		</p>
            <div class="code cpp">
                <pre class="hljs"><span class="hljs-preprocessor">#<span class="hljs-keyword">if</span> (RAMEND &lt; 1000)</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> SERIAL_TX_BUFFER_SIZE 16</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> SERIAL_RX_BUFFER_SIZE 16</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">else</span></span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> SERIAL_TX_BUFFER_SIZE 64</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> SERIAL_RX_BUFFER_SIZE 64</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">endif</span></span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">endif</span></span>
                </pre>
            <div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>
            <p class="text-justify">to</p>
            <div class="code cpp">
                <pre class="hljs"><span class="hljs-preprocessor">#<span class="hljs-keyword">if</span> (RAMEND &lt; 1000)</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> SERIAL_TX_BUFFER_SIZE 192</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> SERIAL_RX_BUFFER_SIZE 192</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">else</span></span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> SERIAL_TX_BUFFER_SIZE 256</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> SERIAL_RX_BUFFER_SIZE 256</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">endif</span></span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">endif</span></span>
                </pre>
            <div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>            
	</div>
	
	<h3>Using GPRS+GPS module with AT commands in Raspberry Pi</h3>
	
	<p class="text-justify">The first thing we are going to do with the module is to check the basic 
	AT commands in gateway mode. Using gateway mode, commands can be sent from 
	our Raspberry Pi directly to any serial module. To stablish UART connection 
	with the module you can use several programs as cutecom in Raspbian graphical 
	environment or minicom in a terminal window in order to use it via SSH . For 
	using minicom follow these steps:</p>
	
	<img class="img-responsive center-block" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/raspberry_pi_shield_908_small.png">
	
	<ol>
		<li><p class="text-justify">Place the Arduino/RPI jumper in the SIM908 shield to the right, 
		in RPI position.</p></li>
		
		<li><p class="text-justify">Place the two Serial com. jumpers in the SIM908 shield to the left, 
		in Arduino position. 
		These jumpers always have to be in this position, in gateway mode and 
		when you run codes.</p></li>
		
		<li><p class="text-justify">We recommend to power externally the shield, but it's not necessary 
		in all cases.</p>
		<p class="text-justify">If you decide not to use an external power supply you must set the “Vin 
		ext. Jumper” to the right, in “Arduino 5V position” and do not forget to place 
		the switch in the Raspberry connection bridge to the right.</p>
		
		<p class="text-justify">If you choose to use an external power supply you must place 
		it through the external power input, the “Vin ext. jumper” must be set to the left, 
		in “Vext position” and the BAT/REG jumper must be set to the right, in REG position.
		The power supply must be able to provide sufficient current up to 2A.
		You can also use a battery to external power the shield, in that case put the BAT/REG 
		jumper to the left, in BAT position.</p>
		<p class="text-justify">Besides this, 
		do not forget to place the switch in the Raspberry connection bridge to the left.</p>
		
		<p class="text-justify">You can check our FAQ about 3G/Sim900/Sim908 
		<a href="http://www.cooking-hacks.com/forum/viewtopic.php?f=45&amp;t=5946&amp;sid=411ff794ce4a9dae53152e1652a44e61">here</a>.
		</p>
		</li>
		
		<li><p class="text-justify">Connect the antennas to the shield and the shield to the Raspberry Pi connection bridge. 
		Now press the ON button in the shield, you will see a green LED.</p></li>
		
		<li><p class="text-justify">Open a Terminal window on Raspberry Pi, or connect to Raspberry Pi through SSH. 
		In order to enter via SSH change here the IP from your Raspberry Pi. The default user is pi.
		<br><strong>ssh -X pi@192.168.1.X</strong></p>
		
		<p class="text-justify">Now you will have to type your password. The default password is “raspberry”.</p>
		</li>
		
		<li><p class="text-justify">Install minicom (only if you haven't done it before):
		<br><strong>sudo apt-get install minicom</strong></p></li>
		
		<li><p class="text-justify">Open comunication with the module UART, the baudrate is 115200:
		<br><strong>minicom -b 115200 -o -D /dev/ttyAMA0</strong></p></li>
		
		<li><p class="text-justify">Then if you type <strong>AT you'll get OK</strong>, this means that the communication with the 
		module is working fine. Now, with the module working you can check some AT commands 
		to control the module.</p></li>
		
		<li><p class="text-justify">To exit minicom press CTRL+A, then press X and Yes.</p></li>
	</ol>
	
	
	
	
</div>

<!-- ############## Step 3: Powering the board: ############## -->
<div class="section_title">
	<h2><a name="powering" class="ancla"></a>Step 3: Powering the board: <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#index" class="pull-right goto">Go to index <span class="glyphicon glyphicon-arrow-up"></span></a></h2>
	<p class="text-justify">There are 3 methods to power the GPRS+GPS shield:</p>
	<p class="text-justify">The first one is powering the shield with Arduino 5v (ICSP header). You must set the BAT/REG jumper in REG position, Vin in Ard 5v and remove the charge jumper. Some of the USB ports on computers are not able to give all the current the module needs to work, if your module goes down when it tries to connect to the network, you can use an external power supply (12V - 2A) on the Arduino.</p>
	<p class="text-justify">The second one is powering the shield directly via Vext header. You must set the BAT/REG jumper in REG position, Vin in Vext and remove the charge jumper. The external power supply can be able to supply current peaks about 2A. We recommend a 12V-2A power supply.</p>
	<p class="text-justify">The last one is using a one cell Li-ion battery. You must set the BAT/REG jumper in BAT position, remove the Vin jumper and set the charge jumper. The shield uses the battery to powers itself but it can't power the Arduino board. To recharge the battery with the shield you only need to power the Arduino. The shield uses the 5v (ICSP header) to charge the battery.</p>
	<p class="text-justify">The next table shows a little resume:</p>
	<div class="row">
	<div class="col-xs-12 col-md-2">
	</div>
		<div class="col-xs-12 col-md-8">	
	<table class="table table-bordered table-hover table-bordered">
        <tbody><tr>
            <th>Power source</th>
            <th>BAT/REG jumper</th>
            <th>Vin jumper</th>
            <th>Charge jumper</th>
        </tr>
        <tr>
            <td>From Arduino</td>
            <td>Reg</td>
            <td>Ard</td>
            <td>Remove</td>
        </tr>
        <tr>
            <td>External power</td>
            <td>Reg</td>
            <td>Vext</td>
            <td>Remove</td>
        </tr>
        <tr>
            <td>Battery</td>
            <td>Bat</td>
            <td>Remove</td>
            <td>Keep</td>
        </tr>
	</tbody></table>
		</div>
	<div class="col-xs-12 col-md-2">
		</div>
	</div>
</div>

<!-- ############## Step 4: Using the shield in standalone mode - Calls ############## -->
<div class="section_title">
	<h2><a name="calls" class="ancla"></a>Step 4: Using the shield in standalone mode - Calls <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#index" class="pull-right goto">Go to index <span class="glyphicon glyphicon-arrow-up"></span></a></h2>
	<h3>Originating and receiving voice calls</h3>
	<p class="text-justify">The code example and the connection diagram shown below are used to originate a voice call and, pushing a button, end that voice call. The button is connected between digital pin 12 an ground. A 10kΩ pull-up resistor is needed at this pin.</p>
	<p class="text-justify"><strong>Arduino code:</strong></p>
	<div class="code cpp">
		<div class="code_tools">
			<button class="btn btn-info btn-xs">Hide code</button>
            <div class="pull-left">Code:</div>
        </div>
                <pre class="hljs" style="display: block;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>
 
 
<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> onModulePin = <span class="hljs-number">2</span>;
<span class="hljs-keyword">int</span> button = <span class="hljs-number">12</span>;
<span class="hljs-keyword">char</span> aux_str[<span class="hljs-number">30</span>];

<span class="hljs-keyword">char</span> phone_number[]=<span class="hljs-string">"******"</span>;     <span class="hljs-comment">// ********* is the number to call</span>
<span class="hljs-keyword">char</span> pin[] = <span class="hljs-string">"****"</span>;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{

    pinMode(onModulePin, OUTPUT);
    pinMode(button, INPUT);
    Serial.begin(<span class="hljs-number">115200</span>);      
    
    Serial.println(<span class="hljs-string">"Starting..."</span>);
    power_on();
    
    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-comment">// sets the PIN code</span>
    <span class="hljs-built_in">sprintf</span>(aux_str, <span class="hljs-string">"AT+CPIN=%s"</span>, pin);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);

    
    delay(<span class="hljs-number">3000</span>);
    
    Serial.println(<span class="hljs-string">"Connecting to the network..."</span>);

    <span class="hljs-keyword">while</span>( (sendATcommand(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,1"</span>, <span class="hljs-number">500</span>) || 
            sendATcommand(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,5"</span>, <span class="hljs-number">500</span>)) == <span class="hljs-number">0</span> );

    <span class="hljs-built_in">sprintf</span>(aux_str, <span class="hljs-string">"ATD%s;"</span>, phone_number);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">10000</span>);
    
    <span class="hljs-comment">// press the button for hang the call </span>
    <span class="hljs-keyword">while</span>(digitalRead(button)==<span class="hljs-number">1</span>);        

    Serial.println(<span class="hljs-string">"ATH"</span>);            <span class="hljs-comment">// disconnects the existing call</span>
    

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        <span class="hljs-comment">// power on pulse</span>
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);
    
        <span class="hljs-comment">// waits for an answer from the module</span>
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){     <span class="hljs-comment">// Send AT every two seconds and wait for the answer</span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }
    
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>
    
    delay(<span class="hljs-number">100</span>);
    
    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>
    
    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


    x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
            response[x] = Serial.read();
            x++;
            <span class="hljs-comment">// check if the desired answer  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
         <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));   

    <span class="hljs-keyword">return</span> answer;
}
                </pre>
    <div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>  
    <p class="text-justify"><strong>Raspberry Pi code:</strong></p> 
	<div class="code cpp">
		<div class="code_tools">
			<button class="btn btn-info btn-xs">Show code</button>
            <div class="pull-left">Code:</div>
        </div>
                <pre class="hljs" style="display: none;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>
 
 <span class="hljs-comment">//Include arduPi library</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> "arduPi.h"</span>

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>;
 
<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> onModulePin = <span class="hljs-number">2</span>;
<span class="hljs-keyword">int</span> button = <span class="hljs-number">12</span>;
<span class="hljs-keyword">char</span> aux_str[<span class="hljs-number">30</span>];

<span class="hljs-keyword">char</span> phone_number[]=<span class="hljs-string">"*******"</span>;     <span class="hljs-comment">// ********* is the number to call</span>
<span class="hljs-keyword">char</span> pin[] = <span class="hljs-string">"*******"</span>;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{

    pinMode(onModulePin, OUTPUT);
    pinMode(button, INPUT);
    Serial.begin(<span class="hljs-number">115200</span>);      
    
    Serial.println(<span class="hljs-string">"Starting..."</span>);
    power_on();
    
    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-comment">// sets the PIN code</span>
    <span class="hljs-built_in">sprintf</span>(aux_str, <span class="hljs-string">"AT+CPIN=%s"</span>, pin);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Connecting to the network...\n"</span>);

    <span class="hljs-keyword">while</span>( (sendATcommand(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,1"</span>, <span class="hljs-number">500</span>) || 
            sendATcommand(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,5"</span>, <span class="hljs-number">500</span>)) == <span class="hljs-number">0</span> );

    <span class="hljs-built_in">sprintf</span>(aux_str, <span class="hljs-string">"ATD%s;"</span>, phone_number);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">10000</span>);
    
    <span class="hljs-comment">// press the button for hang the call </span>
    <span class="hljs-keyword">while</span>(digitalRead(button)==<span class="hljs-number">1</span>);        

    Serial.println(<span class="hljs-string">"ATH"</span>);            <span class="hljs-comment">// disconnects the existing call</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Call disconnected\n"</span>);
    

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        <span class="hljs-comment">// power on pulse</span>
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);
    
        <span class="hljs-comment">// waits for an answer from the module</span>
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){     <span class="hljs-comment">// Send AT every two seconds and wait for the answer</span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }
    
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
            response[x] = Serial.read();
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>,response[x]);
            x++;
            <span class="hljs-comment">// check if the desired answer  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer) != NULL)    
            {
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
                answer = <span class="hljs-number">1</span>;
            }
        }
    }
    <span class="hljs-comment">// Waits for the asnwer with time out</span>
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

        <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span> <span class="hljs-params">()</span></span>{
    setup();
    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>){
        loop();
    }
    <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>);
}

                </pre>
     <div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>         
    <p class="text-justify">To make a lost call next code is used.</p>
    <p class="text-justify"><strong>Arduino code:</strong></p>
	<div class="code cpp">
		<div class="code_tools">
        <button class="btn btn-info btn-xs">Hide code</button>
        <div class="pull-left">Code:</div>
        </div>
                <pre class="hljs" style="display: block;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>
 
<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> onModulePin = <span class="hljs-number">2</span>;
<span class="hljs-keyword">int</span> seconds = <span class="hljs-number">20</span>;
<span class="hljs-keyword">char</span> aux_str[<span class="hljs-number">30</span>];

<span class="hljs-keyword">char</span> phone_number[]=<span class="hljs-string">"*******"</span>;     <span class="hljs-comment">// ********* is the number to call</span>
<span class="hljs-keyword">char</span> pin[] = <span class="hljs-string">"*******"</span>;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{

    pinMode(onModulePin, OUTPUT);
    Serial.begin(<span class="hljs-number">115200</span>);  
    
    
    Serial.println(<span class="hljs-string">"Starting..."</span>);
    power_on();
    
    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-comment">// sets the PIN code</span>
    <span class="hljs-built_in">sprintf</span>(aux_str, <span class="hljs-string">"AT+CPIN=%s"</span>, pin);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    delay(<span class="hljs-number">3000</span>);
    
    Serial.println(<span class="hljs-string">"Connecting to the network..."</span>);

    <span class="hljs-keyword">while</span>( (sendATcommand(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,1"</span>, <span class="hljs-number">500</span>) || 
            sendATcommand(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,5"</span>, <span class="hljs-number">500</span>)) == <span class="hljs-number">0</span> );

    <span class="hljs-built_in">sprintf</span>(aux_str, <span class="hljs-string">"ATD%s;"</span>, phone_number);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">10000</span>);
   
   
    delay(seconds * <span class="hljs-number">1000</span>);

    Serial.println(<span class="hljs-string">"ATH"</span>);            <span class="hljs-comment">// disconnects the existing call</span>
    Serial.println(<span class="hljs-string">"Call disconnected"</span>);
    

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        <span class="hljs-comment">// power on pulse</span>
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);
    
        <span class="hljs-comment">// waits for an answer from the module</span>
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){     <span class="hljs-comment">// Send AT every two seconds and wait for the answer</span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }
    
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>
    
    delay(<span class="hljs-number">100</span>);
    
    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>
    
    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


    x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            response[x] = Serial.read();
            x++;
            <span class="hljs-comment">// check if the desired answer  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

    <span class="hljs-keyword">return</span> answer;
}
                </pre>
    <div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>    
    <p class="text-justify"><strong>Raspberry Pi code:</strong></p>
	<div class="code cpp">
		<div class="code_tools">
        <button class="btn btn-info btn-xs">Show code</button>
        <div class="pull-left">Code:</div>
        </div>
                <pre class="hljs" style="display: none;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>
 

<span class="hljs-comment">//Include arduPi library</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> "arduPi.h"</span>

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>;

<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> onModulePin = <span class="hljs-number">2</span>;
<span class="hljs-keyword">int</span> seconds = <span class="hljs-number">20</span>;
<span class="hljs-keyword">char</span> aux_str[<span class="hljs-number">30</span>];

<span class="hljs-keyword">char</span> phone_number[]=<span class="hljs-string">"*******"</span>;     <span class="hljs-comment">// ********* is the number to call</span>
<span class="hljs-keyword">char</span> pin[] = <span class="hljs-string">"*******"</span>;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{

    pinMode(onModulePin, OUTPUT);
    Serial.begin(<span class="hljs-number">115200</span>);  
    
    
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Starting...\n"</span>);
    power_on();
    
    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-comment">// sets the PIN code</span>
    <span class="hljs-built_in">sprintf</span>(aux_str, <span class="hljs-string">"AT+CPIN=%s"</span>, pin);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Connecting to the network...\n"</span>);

    <span class="hljs-keyword">while</span>( (sendATcommand(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,1"</span>, <span class="hljs-number">500</span>) || 
            sendATcommand(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,5"</span>, <span class="hljs-number">500</span>)) == <span class="hljs-number">0</span> );

    <span class="hljs-built_in">sprintf</span>(aux_str, <span class="hljs-string">"ATD%s;"</span>, phone_number);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">10000</span>);
   
   
    delay(seconds * <span class="hljs-number">1000</span>);

    Serial.println(<span class="hljs-string">"ATH"</span>);            <span class="hljs-comment">// disconnects the existing call</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Call disconnected\n"</span>);
    

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        <span class="hljs-comment">// power on pulse</span>
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);
    
        <span class="hljs-comment">// waits for an answer from the module</span>
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){     <span class="hljs-comment">// Send AT every two seconds and wait for the answer</span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }
    
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
            response[x] = Serial.read();
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>,response[x]);
            x++;
            <span class="hljs-comment">// check if the desired answer  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer) != NULL)    
            {
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
                answer = <span class="hljs-number">1</span>;
            }
        }
    }
    <span class="hljs-comment">// Waits for the asnwer with time out</span>
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

        <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span> <span class="hljs-params">()</span></span>{
    setup();
    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>){
        loop();
    }
    <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>);
}

                </pre>
    <div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>       
    <p class="text-justify">To receive calls the used code are this and the connection diagram is the same that the used to originate calls. Don't forget the pull-up resistor on pin 12.</p>
    <h3>Command summary</h3>
	<div class="row">
	<div class="col-xs-12 col-md-3">
	</div>
		<div class="col-xs-12 col-md-6">	
	<table class="table table-bordered table-hover table-bordered">
	<tbody><tr>
            <th>Command</th> <th>Response</th> <th>Description</th>
        </tr>
        <tr>
            <td>ATD*********;</td>
            <td>&nbsp;</td>
            <td>********* is the number to call.</td>
        </tr>
        <tr>
            <td>ATA</td>
            <td>OK</td>
            <td>Answer an incoming call.</td>
        </tr>
        <tr>
            <td>ATH</td>
            <td>OK</td>
            <td>Cancel voice calls.</td>
        </tr>
	</tbody></table>
		</div>
	<div class="col-xs-12 col-md-3">
		</div>
	</div>	
	
</div>

<!-- ############## Step 5: Using the shield in standalone mode Sending and receiving SMS ############## -->
<div class="section_title">
	<h2><a name="sms" class="ancla"></a>Step 5: Using the shield in standalone mode <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Sending and receiving SMS <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#index" class="pull-right goto">Go to index <span class="glyphicon glyphicon-arrow-up"></span></a></h2>
	<p class="text-justify">The first code is used to send a SMS, the second one reads the first SMS into the memory.</p>
	<p class="text-justify"><strong>Arduino code:</strong></p>
 <div class="code cpp">
	<div class="code_tools">
    <button class="btn btn-info btn-xs">Hide code</button>
		<div class="pull-left">Code:</div>
    </div>
    <pre class="hljs" style="display: block;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>

<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> onModulePin= <span class="hljs-number">2</span>;
<span class="hljs-keyword">char</span> aux_string[<span class="hljs-number">30</span>];
<span class="hljs-keyword">char</span> phone_number[]=<span class="hljs-string">"*********"</span>;   <span class="hljs-comment">// ********* is the number to call</span>
<span class="hljs-keyword">char</span> pin[] = <span class="hljs-string">"****"</span>;
<span class="hljs-keyword">char</span> sms_text[]=<span class="hljs-string">"Test-Arduino-Hello World"</span>;     

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{

    pinMode(onModulePin, OUTPUT);
    Serial.begin(<span class="hljs-number">115200</span>);    
        
    Serial.println(<span class="hljs-string">"Starting..."</span>);
    power_on();
    
    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-comment">// sets the PIN code</span>
    <span class="hljs-built_in">sprintf</span>(aux_string, <span class="hljs-string">"AT+CPIN=%s"</span>, pin);
    sendATcommand(aux_string, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    delay(<span class="hljs-number">3000</span>);
    
    Serial.println(<span class="hljs-string">"Connecting to the network..."</span>);

    <span class="hljs-keyword">while</span>( (sendATcommand(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,1"</span>, <span class="hljs-number">500</span>) || 
            sendATcommand(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,5"</span>, <span class="hljs-number">500</span>)) == <span class="hljs-number">0</span> );

    Serial.print(<span class="hljs-string">"Setting SMS mode..."</span>);
    sendATcommand(<span class="hljs-string">"AT+CMGF=1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">1000</span>);    <span class="hljs-comment">// sets the SMS mode to text</span>
    Serial.println(<span class="hljs-string">"Sending SMS"</span>);
    
    <span class="hljs-built_in">sprintf</span>(aux_string,<span class="hljs-string">"AT+CMGS=\"%s\""</span>, phone_number);
    answer = sendATcommand(aux_string, <span class="hljs-string">"&gt;"</span>, <span class="hljs-number">2000</span>);    <span class="hljs-comment">// send the SMS number</span>
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
    {
        Serial.println(sms_text);
        Serial.write(<span class="hljs-number">0x1A</span>);
        answer = sendATcommand(<span class="hljs-string">""</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">20000</span>);
        <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
        {
            Serial.print(<span class="hljs-string">"Sent "</span>);    
        }
        <span class="hljs-keyword">else</span>
        {
            Serial.print(<span class="hljs-string">"error "</span>);
        }
    }
    <span class="hljs-keyword">else</span>
    {
        Serial.print(<span class="hljs-string">"error "</span>);
        Serial.println(answer, DEC);
    }

}


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        <span class="hljs-comment">// power on pulse</span>
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);
    
        <span class="hljs-comment">// waits for an answer from the module</span>
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){     <span class="hljs-comment">// Send AT every two seconds and wait for the answer</span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }
    
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialice the string</span>
    
    delay(<span class="hljs-number">100</span>);
    
    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>
    
    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


    x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            response[x] = Serial.read();
            x++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
    <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

    <span class="hljs-keyword">return</span> answer;
}
    </pre>
<div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>    
	<p class="text-justify"><strong>Raspberry Pi code:</strong></p>
 <div class="code cpp">
	<div class="code_tools">
    <button class="btn btn-info btn-xs">Show code</button>
		<div class="pull-left">Code:</div>
    </div>
    <pre class="hljs" style="display: none;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>

<span class="hljs-comment">//Include arduPi library</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> "arduPi.h"</span>

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>;

<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> onModulePin= <span class="hljs-number">2</span>;
<span class="hljs-keyword">char</span> aux_string[<span class="hljs-number">30</span>];
<span class="hljs-keyword">char</span> phone_number[]=<span class="hljs-string">"*********"</span>;   <span class="hljs-comment">// ********* is the number to call</span>
<span class="hljs-keyword">char</span> pin[] = <span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> sms_text[]=<span class="hljs-string">"Test-Arduino-Hello World"</span>;     

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{

    pinMode(onModulePin, OUTPUT);
    Serial.begin(<span class="hljs-number">115200</span>);    
        
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Starting...\n"</span>);
    power_on();
    
    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-comment">// sets the PIN code</span>
    <span class="hljs-built_in">sprintf</span>(aux_string, <span class="hljs-string">"AT+CPIN=%s"</span>, pin);
    sendATcommand(aux_string, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Connecting to the network...\n"</span>);

    <span class="hljs-keyword">while</span>( (sendATcommand(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,1"</span>, <span class="hljs-number">500</span>) || 
            sendATcommand(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,5"</span>, <span class="hljs-number">500</span>)) == <span class="hljs-number">0</span> );

    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Setting SMS mode...\n"</span>);
    sendATcommand(<span class="hljs-string">"AT+CMGF=1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">1000</span>);    <span class="hljs-comment">// sets the SMS mode to text</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Sending SMS\n"</span>);
    
    <span class="hljs-built_in">sprintf</span>(aux_string,<span class="hljs-string">"AT+CMGS=\"%s\""</span>, phone_number);
    answer = sendATcommand(aux_string, <span class="hljs-string">"&gt;"</span>, <span class="hljs-number">2000</span>);    <span class="hljs-comment">// send the SMS number</span>
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
    {
        Serial.println(sms_text);
        Serial.write(<span class="hljs-number">0x1A</span>);
        answer = sendATcommand(<span class="hljs-string">""</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">20000</span>);
        <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
        {
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Sent \n"</span>);    
        }
        <span class="hljs-keyword">else</span>
        {
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"error \n"</span>);
        }
    }
    <span class="hljs-keyword">else</span>
    {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"error %o\n"</span>,answer);
    }

}


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        <span class="hljs-comment">// power on pulse</span>
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);
    
        <span class="hljs-comment">// waits for an answer from the module</span>
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){     <span class="hljs-comment">// Send AT every two seconds and wait for the answer</span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }
    
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
            response[x] = Serial.read();
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>,response[x]);
            x++;
            <span class="hljs-comment">// check if the desired answer  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer) != NULL)    
            {
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
                answer = <span class="hljs-number">1</span>;
            }
        }
    }
    <span class="hljs-comment">// Waits for the asnwer with time out</span>
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

        <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span> <span class="hljs-params">()</span></span>{
    setup();
    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>){
        loop();
    }
    <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>);
}

    </pre>
<div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>   
	<p class="text-justify"><strong>Arduino code:</strong></p>
 <div class="code cpp">
	<div class="code_tools">
    <button class="btn btn-info btn-xs">Hide code</button>
		<div class="pull-left">Code:</div>
    </div>
    <pre class="hljs" style="display: block;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>

<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> x;
<span class="hljs-keyword">int</span> onModulePin= <span class="hljs-number">2</span>;
<span class="hljs-keyword">char</span> aux_string[<span class="hljs-number">30</span>];
<span class="hljs-keyword">char</span> SMS[<span class="hljs-number">200</span>];
<span class="hljs-keyword">char</span> pin[] = <span class="hljs-string">"****"</span>;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{

    pinMode(onModulePin, OUTPUT);
    Serial.begin(<span class="hljs-number">115200</span>);  

    Serial.println(<span class="hljs-string">"Starting..."</span>);
    power_on();
    
    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-comment">// sets the PIN code</span>
    <span class="hljs-built_in">sprintf</span>(aux_string, <span class="hljs-string">"AT+CPIN=%s"</span>, pin);
    sendATcommand(aux_string, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    delay(<span class="hljs-number">3000</span>);
    
    Serial.println(<span class="hljs-string">"Setting SMS mode..."</span>);
    sendATcommand(<span class="hljs-string">"AT+CMGF=1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">1000</span>);    <span class="hljs-comment">// sets the SMS mode to text</span>
    sendATcommand(<span class="hljs-string">"AT+CPMS=\"SM\",\"SM\",\"SM\""</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">1000</span>);    <span class="hljs-comment">// selects the memory</span>

    answer = sendATcommand(<span class="hljs-string">"AT+CMGR=1"</span>, <span class="hljs-string">"+CMGR:"</span>, <span class="hljs-number">2000</span>);    <span class="hljs-comment">// reads the first SMS</span>
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
    {
        answer = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span>(Serial.available() == <span class="hljs-number">0</span>);
        <span class="hljs-comment">// this loop reads the data of the SMS</span>
        <span class="hljs-keyword">do</span>{
            <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
            <span class="hljs-keyword">if</span>(Serial.available() &gt; <span class="hljs-number">0</span>){    
                SMS[x] = Serial.read();
                x++;
                <span class="hljs-comment">// check if the desired answer (OK) is in the response of the module</span>
                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(SMS, <span class="hljs-string">"OK"</span>) != NULL)    
                {
                    answer = <span class="hljs-number">1</span>;
                }
            }
        }<span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>);    <span class="hljs-comment">// Waits for the asnwer with time out</span>
        
        SMS[x] = <span class="hljs-string">'\0'</span>;
        
        Serial.print(SMS);    
        
    }
    <span class="hljs-keyword">else</span>
    {
        Serial.print(<span class="hljs-string">"error "</span>);
        Serial.println(answer, DEC);
    }


}


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        <span class="hljs-comment">// power on pulse</span>
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);
    
        <span class="hljs-comment">// waits for an answer from the module</span>
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){     <span class="hljs-comment">// Send AT every two seconds and wait for the answer</span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }
    
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialice the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            response[x] = Serial.read();
            x++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

    <span class="hljs-keyword">return</span> answer;
}
    </pre>
<div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>    
	<p class="text-justify"><strong>Raspberry Pi code:</strong></p>
 <div class="code cpp">
	<div class="code_tools">
    <button class="btn btn-info btn-xs">Show code</button>
		<div class="pull-left">Code:</div>
    </div>
    <pre class="hljs" style="display: none;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>


<span class="hljs-comment">//Include arduPi library</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> "arduPi.h"</span>

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>;

<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> x;
<span class="hljs-keyword">int</span> onModulePin= <span class="hljs-number">2</span>;
<span class="hljs-keyword">char</span> aux_string[<span class="hljs-number">30</span>];
<span class="hljs-keyword">char</span> SMS[<span class="hljs-number">200</span>];
<span class="hljs-keyword">char</span> pin[] = <span class="hljs-string">"*******"</span>;


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{

    pinMode(onModulePin, OUTPUT);
    Serial.begin(<span class="hljs-number">115200</span>);  

    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Starting...\n"</span>);
    power_on();
    
    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-comment">// sets the PIN code</span>
    <span class="hljs-built_in">sprintf</span>(aux_string, <span class="hljs-string">"AT+CPIN=%s"</span>, pin);
    sendATcommand(aux_string, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Setting SMS mode...\n"</span>);
    sendATcommand(<span class="hljs-string">"AT+CMGF=1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">1000</span>);    <span class="hljs-comment">// sets the SMS mode to text</span>
    sendATcommand(<span class="hljs-string">"AT+CPMS=\"SM\",\"SM\",\"SM\""</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">1000</span>);    <span class="hljs-comment">// selects the memory</span>

    answer = sendATcommand(<span class="hljs-string">"AT+CMGR=1"</span>, <span class="hljs-string">"+CMGR:"</span>, <span class="hljs-number">2000</span>);    <span class="hljs-comment">// reads the first SMS</span>
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
    {
        answer = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span>(Serial.available() == <span class="hljs-number">0</span>);
        <span class="hljs-comment">// this loop reads the data of the SMS</span>
        <span class="hljs-keyword">do</span>{
            <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
            <span class="hljs-keyword">if</span>(Serial.available() &gt; <span class="hljs-number">0</span>){    
                SMS[x] = Serial.read();
                x++;
                <span class="hljs-comment">// check if the desired answer (OK) is in the response of the module</span>
                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(SMS, <span class="hljs-string">"OK"</span>) != NULL)    
                {
                    answer = <span class="hljs-number">1</span>;
                }
            }
        }<span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>);    <span class="hljs-comment">// Waits for the asnwer with time out</span>
        
        SMS[x] = <span class="hljs-string">'\0'</span>;
        
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s\n"</span>,SMS);    
        
    }
    <span class="hljs-keyword">else</span>
    {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"error %o\n"</span>,answer);
    }


}


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        <span class="hljs-comment">// power on pulse</span>
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);
    
        <span class="hljs-comment">// waits for an answer from the module</span>
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){     <span class="hljs-comment">// Send AT every two seconds and wait for the answer</span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }
    
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
            response[x] = Serial.read();
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>,response[x]);
            x++;
            <span class="hljs-comment">// check if the desired answer  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer) != NULL)    
            {
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
                answer = <span class="hljs-number">1</span>;
            }
        }
    }
    <span class="hljs-comment">// Waits for the asnwer with time out</span>
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

        <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span> <span class="hljs-params">()</span></span>{
    setup();
    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>){
        loop();
    }
    <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>);
}

    </pre>
<div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>    	
	
	<h3>Command summary</h3>
	<div class="row">
		<div class="col-xs-12 col-md-12">	
	<table class="table table-bordered table-hover table-bordered">
        <tbody><tr>
            <th>Command</th> <th>Response</th> <th>Description</th>
        </tr>
        <tr>
            <td>AT+CMGF=</td>
            <td>OK</td>
            <td>Specifies the input and output format of the short messages. 0 for PDU mode and 1 for text mode.</td>
        </tr>
        <tr>
            <td>AT+CMGS</td>
            <td>&nbsp;</td>
            <td>Sends a message.</td>
        </tr>
        <tr>
            <td>AT+CMGR=*</td>
            <td>&nbsp;</td>
            <td>Reads a message. * is the number of the message.</td>
        </tr>
	</tbody></table>
		</div>
	</div>		
</div>

<!-- ############## Step 6: Using the shield in standalone mode - FTP ############## -->
<div class="section_title">
	<h2><a name="ftp" class="ancla"></a>Step 6: Using the shield in standalone mode - FTP <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#index" class="pull-right goto">Go to index <span class="glyphicon glyphicon-arrow-up"></span></a></h2>
	<p class="text-justify">Creating a file into the FTP server, writing it and reading it.</p>
	<p class="text-justify"><strong>Arduino code:</strong></p>
 <div class="code cpp">
	<div class="code_tools">
    <button class="btn btn-info btn-xs">Hide code</button>
		<div class="pull-left">Code:</div>
    </div>
    <pre class="hljs" style="display: block;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>


<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> onModulePin = <span class="hljs-number">2</span>;
<span class="hljs-keyword">char</span> aux_str[<span class="hljs-number">50</span>];

<span class="hljs-keyword">char</span> pin[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> apn[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> user_name[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> password[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> ftp_server[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> ftp_user_name[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> ftp_password[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> path[]=<span class="hljs-string">"/*******/"</span>;

<span class="hljs-keyword">char</span> incoming_data[<span class="hljs-number">120</span>];

<span class="hljs-keyword">char</span> file_name[ ]=<span class="hljs-string">"test.txt"</span>;
<span class="hljs-keyword">char</span> test_str[ ]= <span class="hljs-string">"0000000011111111222222223333333344444444555555556666666677777777000000001111111122222222333333334444"</span>;

<span class="hljs-keyword">int</span> data_size, aux;


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{

    pinMode(onModulePin, OUTPUT);
    Serial.begin(<span class="hljs-number">115200</span>);  


    Serial.println(<span class="hljs-string">"Starting..."</span>);
    power_on();

    delay(<span class="hljs-number">5000</span>);
    
    <span class="hljs-comment">//sets the PIN code</span>
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+CPIN=%s"</span>, pin);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);

    Serial.println(<span class="hljs-string">"Connecting to the network..."</span>);

    <span class="hljs-keyword">while</span>( (sendATcommand(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,1"</span>, <span class="hljs-number">500</span>) 
            || sendATcommand(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,5"</span>, <span class="hljs-number">500</span>)) == <span class="hljs-number">0</span> );

    configure_FTP();

    uploadFTP();

    downloadFTP();

    Serial.print(<span class="hljs-string">"Incoming data: "</span>);
    Serial.println(incoming_data);
}


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{

}


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">configure_FTP</span><span class="hljs-params">()</span></span>{
  
    <span class="hljs-comment">// sets APN, user name and password</span>
    sendATcommand(<span class="hljs-string">"AT+SAPBR=3,1,\"Contype\",\"GPRS\""</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+SAPBR=3,1,\"APN\",\"%s\""</span>, apn);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+SAPBR=3,1,\"USER\",\"%s\""</span>, user_name);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+SAPBR=3,1,\"PWD\",\"%s\""</span>, password);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
  
    <span class="hljs-comment">// sets the paremeters for the FTP server</span>
    <span class="hljs-keyword">while</span> (sendATcommand(<span class="hljs-string">"AT+SAPBR=1,1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">20000</span>) != <span class="hljs-number">1</span>);
    sendATcommand(<span class="hljs-string">"AT+FTPCID=1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+FTPSERV=\"%s\""</span>, ftp_server);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    sendATcommand(<span class="hljs-string">"AT+FTPPORT=21"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+FTPUN=\"%s\""</span>, ftp_user_name);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+FTPPW=\"%s\""</span>, ftp_password);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    
    
}


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">uploadFTP</span><span class="hljs-params">()</span></span>{
    
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+FTPPUTNAME=\"%s\""</span>, file_name);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+FTPPUTPATH=\"%s\""</span>, path);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);  
    <span class="hljs-keyword">if</span> (sendATcommand(<span class="hljs-string">"AT+FTPPUT=1"</span>, <span class="hljs-string">"+FTPPUT:1,1,"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
    {
        data_size = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span>(Serial.available()==<span class="hljs-number">0</span>);
        aux = Serial.read();
        <span class="hljs-keyword">do</span>{
            data_size *= <span class="hljs-number">10</span>;
            data_size += (aux-<span class="hljs-number">0x30</span>);
            <span class="hljs-keyword">while</span>(Serial.available()==<span class="hljs-number">0</span>);
            aux = Serial.read();        
        }
        <span class="hljs-keyword">while</span>(aux != <span class="hljs-number">0x0D</span>);

        <span class="hljs-keyword">if</span> (data_size &gt;= <span class="hljs-number">100</span>)
        {
            <span class="hljs-keyword">if</span> (sendATcommand(<span class="hljs-string">"AT+FTPPUT=2,100"</span>, <span class="hljs-string">"+FTPPUT:2,100"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
            {
                sendATcommand(test_str, <span class="hljs-string">"+FTPPUT:1,1"</span>, <span class="hljs-number">30000</span>);          
                sendATcommand(<span class="hljs-string">"AT+FTPPUT=2,0"</span>, <span class="hljs-string">"+FTPPUT:1,0"</span>, <span class="hljs-number">30000</span>);
                Serial.println(<span class="hljs-string">"Upload done!!"</span>);
            }
            <span class="hljs-keyword">else</span> 
            {
                sendATcommand(<span class="hljs-string">"AT+FTPPUT=2,0"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">30000</span>);                    
            }
        }
        <span class="hljs-keyword">else</span>
        {
            sendATcommand(<span class="hljs-string">"AT+FTPPUT=2,0"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">30000</span>); 
        }
    }
    <span class="hljs-keyword">else</span>
    {
        Serial.println(<span class="hljs-string">"Error opening the FTP session"</span>);
    }
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">downloadFTP</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+FTPGETNAME=\"%s\""</span>, file_name);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>); 
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+FTPGETPATH=\"%s\""</span>, path);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>); 
    
    <span class="hljs-keyword">if</span> (sendATcommand(<span class="hljs-string">"AT+FTPGET=1 "</span>, <span class="hljs-string">"+FTPGET:1,1"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
    {
        <span class="hljs-keyword">do</span>{
            <span class="hljs-keyword">if</span> (sendATcommand2(<span class="hljs-string">"AT+FTPGET=2,50"</span>, <span class="hljs-string">"+FTPGET:2,"</span>, <span class="hljs-string">"+FTPGET:1,"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
            {
                data_size = <span class="hljs-number">0</span>;
                <span class="hljs-keyword">while</span>(Serial.available()==<span class="hljs-number">0</span>);
                aux = Serial.read();
                <span class="hljs-keyword">do</span>{
                    data_size *= <span class="hljs-number">10</span>;
                    data_size += (aux-<span class="hljs-number">0x30</span>);
                    <span class="hljs-keyword">while</span>(Serial.available()==<span class="hljs-number">0</span>);
                    aux = Serial.read();        
                }<span class="hljs-keyword">while</span>(aux != <span class="hljs-number">0x0D</span>);

                Serial.print(<span class="hljs-string">"Data received: "</span>);
                Serial.println(data_size);

                <span class="hljs-keyword">if</span> (data_size &gt; <span class="hljs-number">0</span>)
                {
                    <span class="hljs-keyword">while</span>(Serial.available() &lt; data_size);
                    Serial.read();

                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> y = <span class="hljs-number">0</span>; y &lt; data_size; y++)
                    {
                        incoming_data[x] = Serial.read();
                        x++;
                    }
                    incoming_data[x] = <span class="hljs-string">'\0'</span>;
                }
                <span class="hljs-keyword">else</span>
                {
                    Serial.println(<span class="hljs-string">"Download finished"</span>);    
                }
            }
            <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(answer == 2)</span>
            </span>{
                Serial.println(<span class="hljs-string">"Error from FTP"</span>);
            }
            <span class="hljs-keyword">else</span>
            {
                Serial.println(<span class="hljs-string">"Error getting the file"</span>);
                data_size = <span class="hljs-number">0</span>;
            }
        }<span class="hljs-keyword">while</span> (data_size &gt; <span class="hljs-number">0</span>);
    }
    <span class="hljs-keyword">else</span>
    {
        Serial.println(<span class="hljs-string">"Error opening the FTP session"</span>);
    }
}




<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);
    
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){     <span class="hljs-comment">// Send AT every two seconds and wait for the answer</span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }
}


<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
            response[x] = Serial.read();
            <span class="hljs-comment">//Serial.print(response[x]);</span>
            x++;
            <span class="hljs-comment">// check if the desired answer  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
    }
    <span class="hljs-comment">// Waits for the asnwer with time out</span>
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

        <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand2</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">char</span>* expected_answer1, 
            <span class="hljs-keyword">char</span>* expected_answer2, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{ 
        <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){               
            response[x] = Serial.read();
            x++;
            <span class="hljs-comment">// check if the desired answer 1 is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer1) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
            <span class="hljs-comment">// check if the desired answer 2 is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer2) != NULL)    
            {
                answer = <span class="hljs-number">2</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

        <span class="hljs-keyword">return</span> answer;
}
    </pre>
<div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>    

	<p class="text-justify"><strong>Raspberry Pi code:</strong></p>
 <div class="code cpp">
	<div class="code_tools">
    <button class="btn btn-info btn-xs">Show code</button>
		<div class="pull-left">Code:</div>
    </div>
    <pre class="hljs" style="display: none;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>

<span class="hljs-comment">//Include arduPi library</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> "arduPi.h"</span>

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand2</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer1, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer2, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>;
<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">downloadFTP</span><span class="hljs-params">()</span></span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">uploadFTP</span><span class="hljs-params">()</span></span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">configure_FTP</span><span class="hljs-params">()</span></span>;

<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> onModulePin = <span class="hljs-number">2</span>;
<span class="hljs-keyword">char</span> aux_str[<span class="hljs-number">50</span>];



<span class="hljs-keyword">char</span> pin[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> apn[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> user_name[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> password[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> ftp_server[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> ftp_user_name[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> ftp_password[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> path[]=<span class="hljs-string">"/*******/"</span>;

<span class="hljs-keyword">char</span> incoming_data[<span class="hljs-number">120</span>];


<span class="hljs-keyword">char</span> file_name[ ]=<span class="hljs-string">"test.txt"</span>;
<span class="hljs-keyword">char</span> test_str[ ]= <span class="hljs-string">"0000000011111111222222223333333344444444555555556666666677777777000000001111111122222222333333334444"</span>;

<span class="hljs-keyword">int</span> data_size, aux;


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{

    pinMode(onModulePin, OUTPUT);
    Serial.begin(<span class="hljs-number">115200</span>);  


    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Starting...\n"</span>);
    power_on();

    delay(<span class="hljs-number">5000</span>);

    <span class="hljs-comment">//sets the PIN code</span>
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+CPIN=%s"</span>, pin);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);

    <span class="hljs-keyword">while</span>( (sendATcommand(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,1"</span>, <span class="hljs-number">500</span>) 
            || sendATcommand(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,5"</span>, <span class="hljs-number">500</span>)) == <span class="hljs-number">0</span> );

    configure_FTP();

    uploadFTP();

    downloadFTP();

    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Incoming data: %s\n"</span>,incoming_data);

}


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{

}


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">configure_FTP</span><span class="hljs-params">()</span></span>{

    <span class="hljs-comment">// sets APN, user name and password</span>
    sendATcommand(<span class="hljs-string">"AT+SAPBR=3,1,\"Contype\",\"GPRS\""</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+SAPBR=3,1,\"APN\",\"%s\""</span>, apn);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+SAPBR=3,1,\"USER\",\"%s\""</span>, user_name);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+SAPBR=3,1,\"PWD\",\"%s\""</span>, password);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
  
    <span class="hljs-comment">// sets the paremeters for the FTP server</span>
    <span class="hljs-keyword">while</span> (sendATcommand(<span class="hljs-string">"AT+SAPBR=1,1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">20000</span>) != <span class="hljs-number">1</span>);
    sendATcommand(<span class="hljs-string">"AT+FTPCID=1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+FTPSERV=\"%s\""</span>, ftp_server);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    sendATcommand(<span class="hljs-string">"AT+FTPPORT=21"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+FTPUN=\"%s\""</span>, ftp_user_name);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+FTPPW=\"%s\""</span>, ftp_password);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);

}


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">uploadFTP</span><span class="hljs-params">()</span></span>{

    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+FTPPUTNAME=\"%s\""</span>, file_name);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+FTPPUTPATH=\"%s\""</span>, path);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);  
    <span class="hljs-keyword">if</span> (sendATcommand(<span class="hljs-string">"AT+FTPPUT=1"</span>, <span class="hljs-string">"+FTPPUT:1,1,"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
    {
        data_size = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span>(Serial.available()==<span class="hljs-number">0</span>);
        aux = Serial.read();
        <span class="hljs-keyword">do</span>{
            data_size *= <span class="hljs-number">10</span>;
            data_size += (aux-<span class="hljs-number">0x30</span>);
            <span class="hljs-keyword">while</span>(Serial.available()==<span class="hljs-number">0</span>);
            aux = Serial.read();        
        }
        <span class="hljs-keyword">while</span>(aux != <span class="hljs-number">0x0D</span>);

        <span class="hljs-keyword">if</span> (data_size &gt;= <span class="hljs-number">100</span>)
        {
            <span class="hljs-keyword">if</span> (sendATcommand(<span class="hljs-string">"AT+FTPPUT=2,100"</span>, <span class="hljs-string">"+FTPPUT:2,100"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
            {
                sendATcommand(test_str, <span class="hljs-string">"+FTPPUT:1,1"</span>, <span class="hljs-number">30000</span>);          
                sendATcommand(<span class="hljs-string">"AT+FTPPUT=2,0"</span>, <span class="hljs-string">"+FTPPUT:1,0"</span>, <span class="hljs-number">30000</span>);
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Upload done!!\n"</span>);
            }
            <span class="hljs-keyword">else</span> 
            {
                sendATcommand(<span class="hljs-string">"AT+FTPPUT=2,0"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">30000</span>);                    
            }
        }
        <span class="hljs-keyword">else</span>
        {
            sendATcommand(<span class="hljs-string">"AT+FTPPUT=2,0"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">30000</span>); 
        }
    }
    <span class="hljs-keyword">else</span>
    {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error opening the FTP session\n"</span>);
    }
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">downloadFTP</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>;

    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+FTPGETNAME=\"%s\""</span>, file_name);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>); 
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+FTPGETPATH=\"%s\""</span>, path);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>); 
    
    <span class="hljs-keyword">if</span> (sendATcommand(<span class="hljs-string">"AT+FTPGET=1 "</span>, <span class="hljs-string">"+FTPGET:1,1"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
    {
        <span class="hljs-keyword">do</span>{
            <span class="hljs-keyword">if</span> (sendATcommand2(<span class="hljs-string">"AT+FTPGET=2,50"</span>, <span class="hljs-string">"+FTPGET:2,"</span>, <span class="hljs-string">"+FTPGET:1,"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
            {
                data_size = <span class="hljs-number">0</span>;
                <span class="hljs-keyword">while</span>(Serial.available()==<span class="hljs-number">0</span>);
                aux = Serial.read();
                <span class="hljs-keyword">do</span>{
                    data_size *= <span class="hljs-number">10</span>;
                    data_size += (aux-<span class="hljs-number">0x30</span>);
                    <span class="hljs-keyword">while</span>(Serial.available()==<span class="hljs-number">0</span>);
                    aux = Serial.read();        
                }<span class="hljs-keyword">while</span>(aux != <span class="hljs-number">0x0D</span>);

                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Data received: %d\n"</span>,data_size);
               

                <span class="hljs-keyword">if</span> (data_size &gt; <span class="hljs-number">0</span>)
                {
                    <span class="hljs-keyword">while</span>(Serial.available() &lt; data_size);
                    Serial.read();

                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> y = <span class="hljs-number">0</span>; y &lt; data_size; y++)
                    {
                        incoming_data[x] = Serial.read();
                        x++;
                    }
                    incoming_data[x] = <span class="hljs-string">'\0'</span>;
                }
                <span class="hljs-keyword">else</span>
                {
                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Download finished\n"</span>);    
                }
            }
            <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(answer == 2)</span>
            </span>{
                 <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error from FTP\n"</span>);
            }
            <span class="hljs-keyword">else</span>
            {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error getting the file\n"</span>);
                data_size = <span class="hljs-number">0</span>;
            }
        }<span class="hljs-keyword">while</span> (data_size &gt; <span class="hljs-number">0</span>);
    }
    <span class="hljs-keyword">else</span>
    {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error opening the FTP session\n"</span>);
    }
}




<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);
    
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){     <span class="hljs-comment">// Send AT every two seconds and wait for the answer</span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }
}


<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
            response[x] = Serial.read();
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>,response[x]);
            x++;
            <span class="hljs-comment">// check if the desired answer  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer) != NULL)    
            {
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
                answer = <span class="hljs-number">1</span>;
            }
        }
    }
    <span class="hljs-comment">// Waits for the asnwer with time out</span>
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

        <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand2</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer1, 
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer2, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>

    x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            response[x] = Serial.read();
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>,response[x]);
            x++;
            <span class="hljs-comment">// check if the desired answer 1  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer1) != NULL)    
            {
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
                answer = <span class="hljs-number">1</span>;
            }
            <span class="hljs-comment">// check if the desired answer 2 is in the response of the module</span>
            <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(<span class="hljs-built_in">strstr</span>(response, expected_answer2)</span> !</span>= NULL)    
            {
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
                answer = <span class="hljs-number">2</span>;
            }
        }
    }
    <span class="hljs-comment">// Waits for the asnwer with time out</span>
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

    <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span> <span class="hljs-params">()</span></span>{
    setup();
    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>){
        loop();
    }
    <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>);
}

    </pre>
<div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>     
	<h3>Command summary</h3>
	<table class="table table-bordered table-hover table-bordered">
        <tbody><tr>
            <th>AT command</th> <th>Response</th> <th>Description</th>
        </tr>
        <tr>
            <td>AT+SAPBR</td>
            <td>OK</td>
            <td>Configures GPRS profile.</td>
        </tr>
        <tr>
            <td>AT+FTPCID=1</td>
            <td>OK</td>
            <td>Selects profile 1 for FTP.</td>
        </tr>
        <tr>
            <td>AT+FTPSERV=”****”</td>
            <td>OK</td>
            <td>Sets FTP server domain name or IP address. **** is the domain name or the IP.</td>
        </tr>
        <tr>
            <td>AT+FTPPORT=***</td>
            <td>OK</td>
            <td>Sets FTP server port. *** is the port.</td>
        </tr>
        <tr>
            <td>AT+FTPUN=”***”</td>
            <td>OK</td>
            <td>Sets user name for FTP server access. *** is the user name.</td>
        </tr>
        <tr>
            <td>AT+FTPPW=”***”</td>
            <td>OK</td>
            <td>Sets password for FTP server access. *** is the password.</td>
        </tr>
        <tr>
            <td>AT+FTPPUTNAME="****"</td>
            <td>OK</td>
            <td>Sets destiny name for the file.*** is the name of the file.</td>
        </tr>
        <tr>
            <td>AT+FTPPUTPATH="****"</td>
            <td>OK</td>
            <td>Sets destiny file path. *** is the path of the file.</td>
        </tr>
        <tr>
            <td>AT+FTPPUT</td>
            <td>OK</td>
            <td>Use to put a file into the FTP server.</td>
        </tr>
        <tr>
            <td>AT+FTPGETNAME="****"</td>
            <td>OK</td>
            <td>Sets origin name for the file.*** is the name of the file.</td>
        </tr>
        <tr>
            <td>AT+FTPGETPATH="****"</td>
            <td>OK</td>
            <td>Sets origin file path. *** is the path of the file.</td>
        </tr>
        <tr>
            <td>AT+FTPGET</td>
            <td>&nbsp;</td>
            <td>Use to get a file into the FTP server.</td>
        </tr>
	</tbody></table>	
</div>

<!-- ############## Step 7: Using the shield in standalone mode - TCP and UDP ############## -->
<div class="section_title">
	<h2><a name="tcp-udp" class="ancla"></a>Step 7: Using the shield in standalone mode - TCP and UDP <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#index" class="pull-right goto">Go to index <span class="glyphicon glyphicon-arrow-up"></span></a></h2>
	<h3>Single client</h3>
	<p class="text-justify">Sending data to a TCP server first, and then it sends to a UDP server.</p>
	<p class="text-justify"><strong>Arduino code:</strong></p>
 <div class="code cpp">
	<div class="code_tools">
    <button class="btn btn-info btn-xs">Show code</button>
		<div class="pull-left">Code:</div>
    </div>
    <pre class="hljs" style="display: none;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>

<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> onModulePin= <span class="hljs-number">2</span>;
<span class="hljs-keyword">char</span> aux_str[<span class="hljs-number">100</span>];

<span class="hljs-keyword">char</span> pin[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> apn[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> user_name[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> password[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> IP_address[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> port[]=<span class="hljs-string">"*******"</span>;

<span class="hljs-keyword">char</span> ip_data[<span class="hljs-number">40</span>]=<span class="hljs-string">"Test string from GPRS shield\r\n"</span>;



<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{

    pinMode(onModulePin, OUTPUT);
    Serial.begin(<span class="hljs-number">115200</span>);    
    
    Serial.println(<span class="hljs-string">"Starting..."</span>);
    power_on();
    
    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-comment">//sets the PIN code</span>
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+CPIN=%s"</span>, pin);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    delay(<span class="hljs-number">3000</span>);
    
    Serial.println(<span class="hljs-string">"Connecting to the network..."</span>);

    <span class="hljs-keyword">while</span>( sendATcommand2(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,1"</span>, <span class="hljs-string">"+CREG: 0,5"</span>, <span class="hljs-number">1000</span>)== <span class="hljs-number">0</span> );

}


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{
    
 
    <span class="hljs-comment">// Selects Single-connection mode</span>
    <span class="hljs-keyword">if</span> (sendATcommand2(<span class="hljs-string">"AT+CIPMUX=0"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">1000</span>) == <span class="hljs-number">1</span>)
    {
        <span class="hljs-comment">// Waits for status IP INITIAL</span>
        <span class="hljs-keyword">while</span>(sendATcommand(<span class="hljs-string">"AT+CIPSTATUS"</span>, <span class="hljs-string">"INITIAL"</span>, <span class="hljs-number">500</span>)  == <span class="hljs-number">0</span> );
        delay(<span class="hljs-number">5000</span>);
        
        <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+CSTT=\"%s\",\"%s\",\"%s\""</span>, apn, user_name, password);
         
        <span class="hljs-comment">// Sets the APN, user name and password</span>
        <span class="hljs-keyword">if</span> (sendATcommand2(aux_str, <span class="hljs-string">"OK"</span>,  <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
        {            
            <span class="hljs-comment">// Waits for status IP START</span>
            <span class="hljs-keyword">while</span>(sendATcommand(<span class="hljs-string">"AT+CIPSTATUS"</span>, <span class="hljs-string">"START"</span>, <span class="hljs-number">500</span>)  == <span class="hljs-number">0</span> );
            delay(<span class="hljs-number">5000</span>);
            
            <span class="hljs-comment">// Brings Up Wireless Connection</span>
            <span class="hljs-keyword">if</span> (sendATcommand2(<span class="hljs-string">"AT+CIICR"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
            {
                <span class="hljs-comment">// Waits for status IP GPRSACT</span>
                <span class="hljs-keyword">while</span>(sendATcommand(<span class="hljs-string">"AT+CIPSTATUS"</span>, <span class="hljs-string">"GPRSACT"</span>, <span class="hljs-number">500</span>)  == <span class="hljs-number">0</span> );
                delay(<span class="hljs-number">5000</span>);
                
                <span class="hljs-comment">// Gets Local IP Address</span>
                <span class="hljs-keyword">if</span> (sendATcommand2(<span class="hljs-string">"AT+CIFSR"</span>, <span class="hljs-string">"."</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>) == <span class="hljs-number">1</span>)
                {
                    <span class="hljs-comment">// Waits for status IP STATUS</span>
                    <span class="hljs-keyword">while</span>(sendATcommand(<span class="hljs-string">"AT+CIPSTATUS"</span>, <span class="hljs-string">"IP STATUS"</span>, <span class="hljs-number">500</span>)  == <span class="hljs-number">0</span> );
                    delay(<span class="hljs-number">5000</span>);
                    Serial.println(<span class="hljs-string">"Opening TCP"</span>);
                    
                    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+CIPSTART=\"TCP\",\"%s\",\"%s\""</span>, IP_address, port);
                    
                    <span class="hljs-comment">// Opens a TCP socket</span>
                    <span class="hljs-keyword">if</span> (sendATcommand2(aux_str, <span class="hljs-string">"CONNECT OK"</span>, <span class="hljs-string">"CONNECT FAIL"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
                    {
                        Serial.println(<span class="hljs-string">"Connected"</span>);
                        
                        <span class="hljs-comment">// Sends some data to the TCP socket</span>
                        <span class="hljs-built_in">sprintf</span>(aux_str,<span class="hljs-string">"AT+CIPSEND=%d"</span>, <span class="hljs-built_in">strlen</span>(ip_data));
                        <span class="hljs-keyword">if</span> (sendATcommand2(aux_str, <span class="hljs-string">"&gt;"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>) == <span class="hljs-number">1</span>)    
                        {
                            sendATcommand2(ip_data, <span class="hljs-string">"SEND OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>);
                        }
                        
                        <span class="hljs-comment">// Closes the socket</span>
                        sendATcommand2(<span class="hljs-string">"AT+CIPCLOSE"</span>, <span class="hljs-string">"CLOSE OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>);
                    }
                    <span class="hljs-keyword">else</span>
                    {
                        Serial.println(<span class="hljs-string">"Error opening the connection"</span>);
                    }  
                }
                <span class="hljs-keyword">else</span>
                {
                    Serial.println(<span class="hljs-string">"Error getting the IP address"</span>);
                }  
            }
            <span class="hljs-keyword">else</span>
            {
                Serial.println(<span class="hljs-string">"Error bring up wireless connection"</span>);
            }
        }
        <span class="hljs-keyword">else</span>
        {
            Serial.println(<span class="hljs-string">"Error setting the APN"</span>);
        } 
    }
    <span class="hljs-keyword">else</span>
    {
        Serial.println(<span class="hljs-string">"Error setting the single connection"</span>);
    }
    
    sendATcommand2(<span class="hljs-string">"AT+CIPSHUT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>);
    delay(<span class="hljs-number">10000</span>);
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        <span class="hljs-comment">// power on pulse</span>
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);
    
        <span class="hljs-comment">// waits for an answer from the module</span>
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){     <span class="hljs-comment">// Send AT every two seconds and wait for the answer</span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }
    
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
            response[x] = Serial.read();
            <span class="hljs-comment">//Serial.print(response[x]);</span>
            x++;
            <span class="hljs-comment">// check if the desired answer  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
    }
    <span class="hljs-comment">// Waits for the asnwer with time out</span>
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

        <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand2</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">char</span>* expected_answer1, 
        <span class="hljs-keyword">char</span>* expected_answer2, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>

    x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            response[x] = Serial.read();
            x++;
            <span class="hljs-comment">// check if the desired answer 1  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer1) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
            <span class="hljs-comment">// check if the desired answer 2 is in the response of the module</span>
            <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(<span class="hljs-built_in">strstr</span>(response, expected_answer2)</span> !</span>= NULL)    
            {
                answer = <span class="hljs-number">2</span>;
            }
        }
    }
    <span class="hljs-comment">// Waits for the asnwer with time out</span>
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

    <span class="hljs-keyword">return</span> answer;
}
    </pre>
<div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>  	
	<p class="text-justify"><strong>Raspberry Pi code:</strong></p>
 <div class="code cpp">
	<div class="code_tools">
    <button class="btn btn-info btn-xs">Show code</button>
		<div class="pull-left">Code:</div>
    </div>
    <pre class="hljs" style="display: none;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>

 <span class="hljs-comment">//Include arduPi library</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> "arduPi.h"</span>

 <span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand2</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer1, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer2, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>;
 <span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>;
 <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>;


<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> onModulePin= <span class="hljs-number">2</span>;
<span class="hljs-keyword">char</span> aux_str[<span class="hljs-number">100</span>];

<span class="hljs-keyword">char</span> pin[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> apn[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> user_name[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> password[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> IP_address[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> port[]=<span class="hljs-string">"*******"</span>;

<span class="hljs-keyword">char</span> ip_data[<span class="hljs-number">40</span>]=<span class="hljs-string">"Test string from GPRS shield\r\n"</span>;



<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{

    pinMode(onModulePin, OUTPUT);
    Serial.begin(<span class="hljs-number">115200</span>);    
    
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Starting...\n"</span>);
    power_on();
    
    delay(<span class="hljs-number">3000</span>);
    
	<span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+CPIN=%s"</span>, pin);
    sendATcommand2(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">2000</span>);
    
    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Connecting to the network...\n"</span>);

    <span class="hljs-keyword">while</span>( sendATcommand2(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,1"</span>, <span class="hljs-string">"+CREG: 0,5"</span>, <span class="hljs-number">1000</span>)== <span class="hljs-number">0</span> );

}


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{
    
 
    <span class="hljs-comment">// Selects Single-connection mode</span>
    <span class="hljs-keyword">if</span> (sendATcommand2(<span class="hljs-string">"AT+CIPMUX=0"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">1000</span>) == <span class="hljs-number">1</span>)
    {
        <span class="hljs-comment">// Waits for status IP INITIAL</span>
        <span class="hljs-keyword">while</span>(sendATcommand(<span class="hljs-string">"AT+CIPSTATUS"</span>, <span class="hljs-string">"INITIAL"</span>, <span class="hljs-number">500</span>)  == <span class="hljs-number">0</span> );
        delay(<span class="hljs-number">5000</span>);
        
        <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+CSTT=\"%s\",\"%s\",\"%s\""</span>, apn, user_name, password);
        <span class="hljs-comment">// Sets the APN, user name and password</span>
        <span class="hljs-keyword">if</span> (sendATcommand2(aux_str, <span class="hljs-string">"OK"</span>,  <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
        {            
            <span class="hljs-comment">// Waits for status IP START</span>
            <span class="hljs-keyword">while</span>(sendATcommand(<span class="hljs-string">"AT+CIPSTATUS"</span>, <span class="hljs-string">"START"</span>, <span class="hljs-number">500</span>)  == <span class="hljs-number">0</span> );
            delay(<span class="hljs-number">5000</span>);
            
            <span class="hljs-comment">// Brings Up Wireless Connection</span>
            <span class="hljs-keyword">if</span> (sendATcommand2(<span class="hljs-string">"AT+CIICR"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
            {
                <span class="hljs-comment">// Waits for status IP GPRSACT</span>
                <span class="hljs-keyword">while</span>(sendATcommand(<span class="hljs-string">"AT+CIPSTATUS"</span>, <span class="hljs-string">"GPRSACT"</span>, <span class="hljs-number">500</span>)  == <span class="hljs-number">0</span> );
                delay(<span class="hljs-number">5000</span>);
                
                <span class="hljs-comment">// Gets Local IP Address</span>
                <span class="hljs-keyword">if</span> (sendATcommand2(<span class="hljs-string">"AT+CIFSR"</span>, <span class="hljs-string">"."</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>) == <span class="hljs-number">1</span>)
                {
                    <span class="hljs-comment">// Waits for status IP STATUS</span>
                    <span class="hljs-keyword">while</span>(sendATcommand2(<span class="hljs-string">"AT+CIPSTATUS"</span>, <span class="hljs-string">"IP STATUS"</span>, <span class="hljs-string">""</span>, <span class="hljs-number">500</span>)  == <span class="hljs-number">0</span> );
                    delay(<span class="hljs-number">5000</span>);
                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Opening TCP\n"</span>);
                    
                    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+CIPSTART=\"TCP\",\"%s\",\"%s\""</span>, IP_address, port);
                    
                    <span class="hljs-comment">// Opens a TCP socket</span>
                    <span class="hljs-keyword">if</span> (sendATcommand2(aux_str, <span class="hljs-string">"CONNECT OK"</span>, <span class="hljs-string">"CONNECT FAIL"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
                    {
                        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Connected\n"</span>);
                        
                        <span class="hljs-comment">// Sends some data to the TCP socket</span>
                        <span class="hljs-built_in">sprintf</span>(aux_str,<span class="hljs-string">"AT+CIPSEND=%d"</span>, <span class="hljs-built_in">strlen</span>(ip_data));
                        <span class="hljs-keyword">if</span> (sendATcommand2(aux_str, <span class="hljs-string">"&gt;"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>) == <span class="hljs-number">1</span>)    
                        {
                            sendATcommand2(ip_data, <span class="hljs-string">"SEND OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>);
                        }
                        
                        <span class="hljs-comment">// Closes the socket</span>
                        sendATcommand2(<span class="hljs-string">"AT+CIPCLOSE"</span>, <span class="hljs-string">"CLOSE OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>);
                    }
                    <span class="hljs-keyword">else</span>
                    {
                        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error opening the connection\n"</span>);
                    }  
                }
                <span class="hljs-keyword">else</span>
                {
                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error getting the IP address\n"</span>);
                }  
            }
            <span class="hljs-keyword">else</span>
            {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error bring up wireless connection\n"</span>);
            }
        }
        <span class="hljs-keyword">else</span>
        {
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error setting the APN\n"</span>);
        } 
    }
    <span class="hljs-keyword">else</span>
    {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error setting the single connection\n"</span>);
    }
    
    sendATcommand2(<span class="hljs-string">"AT+CIPSHUT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>);
    delay(<span class="hljs-number">10000</span>);
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        <span class="hljs-comment">// power on pulse</span>
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);
    
        <span class="hljs-comment">// waits for an answer from the module</span>
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){     <span class="hljs-comment">// Send AT every two seconds and wait for the answer</span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }
    
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
            response[x] = Serial.read();
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>,response[x]);
            x++;
            <span class="hljs-comment">// check if the desired answer  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer) != NULL)    
            {
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
                answer = <span class="hljs-number">1</span>;
            }
        }
    }
    <span class="hljs-comment">// Waits for the asnwer with time out</span>
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

        <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand2</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer1, 
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer2, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>

    x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            response[x] = Serial.read();
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>,response[x]);
            x++;
            <span class="hljs-comment">// check if the desired answer 1  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer1) != NULL)    
            {
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
                answer = <span class="hljs-number">1</span>;
            }
            <span class="hljs-comment">// check if the desired answer 2 is in the response of the module</span>
            <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(<span class="hljs-built_in">strstr</span>(response, expected_answer2)</span> !</span>= NULL)    
            {
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
                answer = <span class="hljs-number">2</span>;
            }
        }
    }
    <span class="hljs-comment">// Waits for the asnwer with time out</span>
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

    <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span> <span class="hljs-params">()</span></span>{
    setup();
    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>){
        loop();
    }
    <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>);
}

    </pre>
<div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>  	
	<h3>Multiple client</h3>
	<p class="text-justify">SIM908 allows to use 8 connections simultaneously. Here is the example code with a UDP and TCP connections.</p>
	<p class="text-justify"><strong>Arduino code:</strong></p>
 <div class="code cpp">
	<div class="code_tools">
    <button class="btn btn-info btn-xs">Hide code</button>
		<div class="pull-left">Code:</div>
    </div>
    <pre class="hljs" style="display: block;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>
 
 
<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> onModulePin= <span class="hljs-number">2</span>;
<span class="hljs-keyword">char</span> aux_str[<span class="hljs-number">100</span>];

<span class="hljs-keyword">char</span> pin[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> apn[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> user_name[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> password[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> IP_address[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> port[]=<span class="hljs-string">"*******"</span>;

<span class="hljs-keyword">char</span> ip_data[<span class="hljs-number">40</span>]=<span class="hljs-string">"Test string from GPRS shield\r\n"</span>;



<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{

    pinMode(onModulePin, OUTPUT);
    Serial.begin(<span class="hljs-number">115200</span>);    
    
    Serial.println(<span class="hljs-string">"Starting..."</span>);
    power_on();
    
    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-comment">//sets the PIN code</span>
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+CPIN=%s"</span>, pin);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    delay(<span class="hljs-number">3000</span>);
    
    Serial.println(<span class="hljs-string">"Connecting to the network..."</span>);

    <span class="hljs-keyword">while</span>( sendATcommand2(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,1"</span>, <span class="hljs-string">"+CREG: 0,5"</span>, <span class="hljs-number">1000</span>) == <span class="hljs-number">0</span> );

}


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{
    
    
    <span class="hljs-comment">// Selects Multi-connection mode</span>
    <span class="hljs-keyword">if</span> (sendATcommand2(<span class="hljs-string">"AT+CIPMUX=1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">1000</span>) == <span class="hljs-number">1</span>)
    {
        <span class="hljs-comment">// Waits for status IP INITIAL</span>
        <span class="hljs-keyword">while</span>(sendATcommand2(<span class="hljs-string">"AT+CIPSTATUS"</span>, <span class="hljs-string">"INITIAL"</span>, <span class="hljs-string">""</span>, <span class="hljs-number">500</span>)  == <span class="hljs-number">0</span> );
        delay(<span class="hljs-number">5000</span>);
        
        <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+CSTT=\"%s\",\"%s\",\"%s\""</span>, apn, user_name, password);
        
        <span class="hljs-comment">// Sets the APN, user name and password</span>
        <span class="hljs-keyword">if</span> (sendATcommand2(aux_str, <span class="hljs-string">"OK"</span>,  <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
        {
            <span class="hljs-comment">// Waits for status IP START</span>
            <span class="hljs-keyword">while</span>(sendATcommand(<span class="hljs-string">"AT+CIPSTATUS"</span>, <span class="hljs-string">"START"</span>, <span class="hljs-number">500</span>)  == <span class="hljs-number">0</span> );
            delay(<span class="hljs-number">5000</span>);
            
            <span class="hljs-comment">// Brings Up Wireless Connection</span>
            <span class="hljs-keyword">if</span> (sendATcommand2(<span class="hljs-string">"AT+CIICR"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
            {
                <span class="hljs-comment">// Waits for status IP GPRSACT</span>
                <span class="hljs-keyword">while</span>(sendATcommand(<span class="hljs-string">"AT+CIPSTATUS"</span>, <span class="hljs-string">"GPRSACT"</span>, <span class="hljs-number">500</span>)  == <span class="hljs-number">0</span> );
                delay(<span class="hljs-number">5000</span>);
                
                <span class="hljs-comment">// Gets Local IP Address</span>
                <span class="hljs-keyword">if</span> (sendATcommand2(<span class="hljs-string">"AT+CIFSR"</span>, <span class="hljs-string">"."</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>) == <span class="hljs-number">1</span>)
                {
                    <span class="hljs-comment">// Waits for status IP STATUS</span>
                    <span class="hljs-keyword">while</span>(sendATcommand(<span class="hljs-string">"AT+CIPSTATUS"</span>, <span class="hljs-string">"IP STATUS"</span>, <span class="hljs-number">500</span>)  == <span class="hljs-number">0</span> );
                    delay(<span class="hljs-number">5000</span>);
                    Serial.println(<span class="hljs-string">"Opening TCP"</span>);
                    
                    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+CIPSTART=1,\"TCP\",\"%s\",\"%s\""</span>, IP_address, port);
                    
                    <span class="hljs-comment">// Opens a TCP socket with connection 1</span>
                    <span class="hljs-keyword">if</span> (sendATcommand2(aux_str, <span class="hljs-string">"CONNECT OK"</span>, <span class="hljs-string">"CONNECT FAIL"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
                    {
                        Serial.println(<span class="hljs-string">"Connected"</span>);
                        
                        <span class="hljs-comment">// Sends some data to the TCP socket</span>
                        <span class="hljs-built_in">sprintf</span>(aux_str,<span class="hljs-string">"AT+CIPSEND=1,%d"</span>, <span class="hljs-built_in">strlen</span>(ip_data));
                        <span class="hljs-keyword">if</span> (sendATcommand2(aux_str, <span class="hljs-string">"&gt;"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>) == <span class="hljs-number">1</span>)    
                        {
                            delay(<span class="hljs-number">500</span>);
                            sendATcommand2(ip_data, <span class="hljs-string">"SEND OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>);
                        }
                        
                        <span class="hljs-comment">// Closes the socket</span>
                        sendATcommand2(<span class="hljs-string">"AT+CIPCLOSE=1"</span>, <span class="hljs-string">"CLOSE OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>);
                    }
                    <span class="hljs-keyword">else</span>
                    {
                        Serial.println(<span class="hljs-string">"Error opening the connection 1"</span>);
                    }  
                    
                }
                <span class="hljs-keyword">else</span>
                {
                    Serial.println(<span class="hljs-string">"Error getting the IP address"</span>);
                }  
            }
            <span class="hljs-keyword">else</span>
            {
                Serial.println(<span class="hljs-string">"Error bring up wireless connection"</span>);
            }
        }
        <span class="hljs-keyword">else</span>
        {
            Serial.println(<span class="hljs-string">"Error setting the APN"</span>);
        } 
    }
    <span class="hljs-keyword">else</span>
    {
        Serial.println(<span class="hljs-string">"Error setting the multi-connection"</span>);
    }
    
    sendATcommand2(<span class="hljs-string">"AT+CIPSHUT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>);
    delay(<span class="hljs-number">10000</span>);
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        <span class="hljs-comment">// power on pulse</span>
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);
    
        <span class="hljs-comment">// waits for an answer from the module</span>
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){     <span class="hljs-comment">// Send AT every two seconds and wait for the answer</span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }
    
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
            response[x] = Serial.read();
            <span class="hljs-comment">//Serial.print(response[x]);</span>
            x++;
            <span class="hljs-comment">// check if the desired answer  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
    }
    <span class="hljs-comment">// Waits for the asnwer with time out</span>
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

        <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand2</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">char</span>* expected_answer1, 
        <span class="hljs-keyword">char</span>* expected_answer2, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>

    x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            response[x] = Serial.read();
            x++;
            <span class="hljs-comment">// check if the desired answer 1  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer1) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
            <span class="hljs-comment">// check if the desired answer 2 is in the response of the module</span>
            <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(<span class="hljs-built_in">strstr</span>(response, expected_answer2)</span> !</span>= NULL)    
            {
                answer = <span class="hljs-number">2</span>;
            }
        }
    }
    <span class="hljs-comment">// Waits for the asnwer with time out</span>
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

    <span class="hljs-keyword">return</span> answer;
}
    </pre>
<div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>  	
	<p class="text-justify"><strong>Raspberry Pi code:</strong></p>
 <div class="code cpp">
	<div class="code_tools">
    <button class="btn btn-info btn-xs">Show code</button>
		<div class="pull-left">Code:</div>
    </div>
    <pre class="hljs" style="display: none;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>
 
 <span class="hljs-comment">//Include arduPi library</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> "arduPi.h"</span>

 <span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand2</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer1, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer2, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>;
 <span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>;
 <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>;
 
<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> onModulePin= <span class="hljs-number">2</span>;
<span class="hljs-keyword">char</span> aux_str[<span class="hljs-number">100</span>];

<span class="hljs-keyword">char</span> pin[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> apn[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> user_name[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> password[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> IP_address[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> port[]=<span class="hljs-string">"*******"</span>;

<span class="hljs-keyword">char</span> ip_data[<span class="hljs-number">40</span>]=<span class="hljs-string">"Test string from GPRS shield\r\n"</span>;



<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{

    pinMode(onModulePin, OUTPUT);
    Serial.begin(<span class="hljs-number">115200</span>);    
    
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Starting...\n"</span>);
    power_on();
    
    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-comment">// sets the PIN code</span>
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+CPIN=%s"</span>, pin);
    sendATcommand2(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">2000</span>);
    
    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Connecting to the network...\n"</span>);

    <span class="hljs-keyword">while</span>( sendATcommand2(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,1"</span>, <span class="hljs-string">"+CREG: 0,5"</span>, <span class="hljs-number">1000</span>) == <span class="hljs-number">0</span> );

}


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{
    
    
    <span class="hljs-comment">// Selects Multi-connection mode</span>
    <span class="hljs-keyword">if</span> (sendATcommand2(<span class="hljs-string">"AT+CIPMUX=1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">1000</span>) == <span class="hljs-number">1</span>)
    {
        <span class="hljs-comment">// Waits for status IP INITIAL</span>
        <span class="hljs-keyword">while</span>(sendATcommand(<span class="hljs-string">"AT+CIPSTATUS"</span>, <span class="hljs-string">"INITIAL"</span>, <span class="hljs-number">500</span>)  == <span class="hljs-number">0</span> );
        delay(<span class="hljs-number">5000</span>);
        
        <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+CSTT=\"%s\",\"%s\",\"%s\""</span>, apn, user_name, password);
        <span class="hljs-comment">// Sets the APN, user name and password</span>
        <span class="hljs-keyword">if</span> (sendATcommand2(aux_str, <span class="hljs-string">"OK"</span>,  <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
        {
            <span class="hljs-comment">// Waits for status IP START</span>
            <span class="hljs-keyword">while</span>(sendATcommand(<span class="hljs-string">"AT+CIPSTATUS"</span>, <span class="hljs-string">"START"</span>, <span class="hljs-number">500</span>)  == <span class="hljs-number">0</span> );
            delay(<span class="hljs-number">5000</span>);
            
            <span class="hljs-comment">// Brings Up Wireless Connection</span>
            <span class="hljs-keyword">if</span> (sendATcommand2(<span class="hljs-string">"AT+CIICR"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
            {
                <span class="hljs-comment">// Waits for status IP GPRSACT</span>
                <span class="hljs-keyword">while</span>(sendATcommand(<span class="hljs-string">"AT+CIPSTATUS"</span>, <span class="hljs-string">"GPRSACT"</span>, <span class="hljs-number">500</span>)  == <span class="hljs-number">0</span> );
                delay(<span class="hljs-number">5000</span>);
                
                <span class="hljs-comment">// Gets Local IP Address</span>
                <span class="hljs-keyword">if</span> (sendATcommand2(<span class="hljs-string">"AT+CIFSR"</span>, <span class="hljs-string">"."</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>) == <span class="hljs-number">1</span>)
                {
                    <span class="hljs-comment">// Waits for status IP STATUS</span>
                    <span class="hljs-keyword">while</span>(sendATcommand2(<span class="hljs-string">"AT+CIPSTATUS"</span>, <span class="hljs-string">"IP STATUS"</span>, <span class="hljs-string">""</span>, <span class="hljs-number">500</span>)  == <span class="hljs-number">0</span> );
                    delay(<span class="hljs-number">5000</span>);
                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Opening TCP\n"</span>);
                    
                    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+CIPSTART=1,\"TCP\",\"%s\",\"%s\""</span>, IP_address, port);
                    
                    <span class="hljs-comment">// Opens a TCP socket with connection 1</span>
                    <span class="hljs-keyword">if</span> (sendATcommand2(aux_str, <span class="hljs-string">"CONNECT OK"</span>, <span class="hljs-string">"CONNECT FAIL"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
                    {
                        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Connected\n"</span>);
                        
                        <span class="hljs-comment">// Sends some data to the TCP socket</span>
                        <span class="hljs-built_in">sprintf</span>(aux_str,<span class="hljs-string">"AT+CIPSEND=1,%d"</span>, <span class="hljs-built_in">strlen</span>(ip_data));
                        <span class="hljs-keyword">if</span> (sendATcommand2(aux_str, <span class="hljs-string">"&gt;"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>) == <span class="hljs-number">1</span>)    
                        {
                            <span class="hljs-comment">//delay(500);</span>
                            sendATcommand2(ip_data, <span class="hljs-string">"SEND OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>);
                        }
                        
                        <span class="hljs-comment">// Closes the socket</span>
                        sendATcommand2(<span class="hljs-string">"AT+CIPCLOSE=1"</span>, <span class="hljs-string">"CLOSE OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>);
                    }
                    <span class="hljs-keyword">else</span>
                    {
                        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error opening the connection 1\n"</span>);
                    }  
                    
                }
                <span class="hljs-keyword">else</span>
                {
                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error getting the IP address\n"</span>);
                }  
            }
            <span class="hljs-keyword">else</span>
            {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error bring up wireless connection\n"</span>);
            }
        }
        <span class="hljs-keyword">else</span>
        {
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error setting the APN\n"</span>);
        } 
    }
    <span class="hljs-keyword">else</span>
    {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error setting the multi-connection\n"</span>);
    }
    
    sendATcommand2(<span class="hljs-string">"AT+CIPSHUT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">10000</span>);
    delay(<span class="hljs-number">10000</span>);
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        <span class="hljs-comment">// power on pulse</span>
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);
    
        <span class="hljs-comment">// waits for an answer from the module</span>
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){     <span class="hljs-comment">// Send AT every two seconds and wait for the answer</span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }
    
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
            response[x] = Serial.read();
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>,response[x]);
            x++;
            <span class="hljs-comment">// check if the desired answer  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer) != NULL)    
            {
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
                answer = <span class="hljs-number">1</span>;
            }
        }
    }
    <span class="hljs-comment">// Waits for the asnwer with time out</span>
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

        <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand2</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer1, 
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer2, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>

    x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            response[x] = Serial.read();
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>,response[x]);
            x++;
            <span class="hljs-comment">// check if the desired answer 1  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer1) != NULL)    
            {
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
                answer = <span class="hljs-number">1</span>;
            }
            <span class="hljs-comment">// check if the desired answer 2 is in the response of the module</span>
            <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(<span class="hljs-built_in">strstr</span>(response, expected_answer2)</span> !</span>= NULL)    
            {
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
                answer = <span class="hljs-number">2</span>;
            }
        }
    }
    <span class="hljs-comment">// Waits for the asnwer with time out</span>
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

    <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span> <span class="hljs-params">()</span></span>{
    setup();
    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>){
        loop();
    }
    <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>);
}

    </pre>
<div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div> 	
	<h3>Command summary</h3>
	<div class="row">
	<div class="col-xs-12 col-md-1">
	</div>
		<div class="col-xs-12 col-md-10">	
	<table class="table table-bordered table-hover table-bordered">
       <tbody><tr>
            <th>AT command</th> <th>Response</th> <th>Description</th>
        </tr>
        <tr>
            <td>AT+CIPMUX=</td>
            <td>OK</td>
            <td>Selects single connection (0) or multiple connection (1)</td>
        </tr>
        <tr>
            <td>AT+CSTT="myAPN"</td>
            <td>OK</td>
            <td>Sets APN</td>
        </tr>
        <tr>
            <td>AT+CIICR</td>
            <td>&nbsp;</td>
            <td>Brings up wireless connection</td>
        </tr>
        <tr>
            <td>AT+CIFSR</td>
            <td>&nbsp;</td>
            <td>Get local IP address</td>
        </tr>
        <tr>
            <td>AT+CIPSTART</td>
            <td>&nbsp;</td>
            <td>Establishes a connection with a server.</td>
        </tr>
        <tr>
            <td>AT+CIPSEND</td>
            <td>&nbsp;</td>
            <td>Sends data when the a connection is established.</td>
        </tr>
        <tr>
            <td>AT+CIPCLOSE</td>
            <td>&nbsp;</td>
            <td>Closes the connection</td>
        </tr>
	</tbody></table>
		</div>
	<div class="col-xs-12 col-md-1">
		</div>
	</div>	
</div>

<!-- ############## Step 8: Using the shield in standalone mode - HTTP ############## -->
<div class="section_title">
	<h2><a name="http" class="ancla"></a>Step 8: Using the shield in standalone mode - HTTP <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#index" class="pull-right goto">Go to index <span class="glyphicon glyphicon-arrow-up"></span></a></h2>
	<p class="text-justify">SIM908 can launch a HTTP operation like GET or POST. Here is an example with GET operation:</p>
	<p class="text-justify"><strong>Arduino code:</strong></p>
 <div class="code cpp">
	<div class="code_tools">
    <button class="btn btn-info btn-xs">Hide code</button>
		<div class="pull-left">Code:</div>
    </div>
    <pre class="hljs" style="display: block;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>


<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> onModulePin= <span class="hljs-number">2</span>;

<span class="hljs-keyword">char</span> data[<span class="hljs-number">512</span>];
<span class="hljs-keyword">int</span> data_size;

<span class="hljs-keyword">char</span> aux_str[<span class="hljs-number">100</span>];
<span class="hljs-keyword">char</span> aux;
<span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>;

<span class="hljs-keyword">char</span> pin[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> apn[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> user_name[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> password[]=<span class="hljs-string">"*******"</span>;

<span class="hljs-keyword">char</span> url[ ]=<span class="hljs-string">"test.libelium.com/test-get-post.php?a=1&amp;b=2"</span>;


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{

    pinMode(onModulePin, OUTPUT);
    Serial.begin(<span class="hljs-number">115200</span>);   

    Serial.println(<span class="hljs-string">"Starting..."</span>);
    power_on();

    delay(<span class="hljs-number">3000</span>);
   
    <span class="hljs-comment">//sets the PIN code</span>
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+CPIN=%s"</span>, pin);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);

    delay(<span class="hljs-number">3000</span>);

    <span class="hljs-keyword">while</span> (sendATcommand2(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,1"</span>, <span class="hljs-string">"+CREG: 0,5"</span>, <span class="hljs-number">2000</span>) == <span class="hljs-number">0</span>);

    <span class="hljs-comment">// sets APN , user name and password</span>
    sendATcommand(<span class="hljs-string">"AT+SAPBR=3,1,\"Contype\",\"GPRS\""</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+SAPBR=3,1,\"APN\",\"%s\""</span>, apn);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+SAPBR=3,1,\"USER\",\"%s\""</span>, user_name);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+SAPBR=3,1,\"PWD\",\"%s\""</span>, password);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);

    <span class="hljs-keyword">while</span> (sendATcommand(<span class="hljs-string">"AT+SAPBR=1,1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">20000</span>) == <span class="hljs-number">0</span>)
    {
        delay(<span class="hljs-number">5000</span>);
    }


}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{
    <span class="hljs-comment">// Initializes HTTP service</span>
    answer = sendATcommand(<span class="hljs-string">"AT+HTTPINIT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">10000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
    {
        <span class="hljs-comment">// Sets CID parameter</span>
        answer = sendATcommand(<span class="hljs-string">"AT+HTTPPARA=\"CID\",1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">5000</span>);
        <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
        {
            <span class="hljs-comment">// Sets url </span>
            
            <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+HTTPPARA=\"URL\",\"%s\""</span>, url);
            
            answer = sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">5000</span>);
            <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
            {
                <span class="hljs-comment">// Starts GET action</span>
                answer = sendATcommand(<span class="hljs-string">"AT+HTTPACTION=0"</span>, <span class="hljs-string">"+HTTPACTION:0,200"</span>, <span class="hljs-number">10000</span>);
                
                <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
                {
                    x=<span class="hljs-number">0</span>;
                    <span class="hljs-keyword">do</span>{
                        <span class="hljs-built_in">sprintf</span>(aux_str, <span class="hljs-string">"AT+HTTPREAD=%d,100"</span>, x);
                        <span class="hljs-keyword">if</span> (sendATcommand2(aux_str, <span class="hljs-string">"+HTTPREAD:"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
                        {
                            data_size = <span class="hljs-number">0</span>;
                            <span class="hljs-keyword">while</span>(Serial.available()==<span class="hljs-number">0</span>);
                            aux = Serial.read();
                            <span class="hljs-keyword">do</span>{
                                data_size *= <span class="hljs-number">10</span>;
                                data_size += (aux-<span class="hljs-number">0x30</span>);
                                <span class="hljs-keyword">while</span>(Serial.available()==<span class="hljs-number">0</span>);
                                aux = Serial.read();        
                            }<span class="hljs-keyword">while</span>(aux != <span class="hljs-number">0x0D</span>);

                            Serial.print(<span class="hljs-string">"Data received: "</span>);
                            Serial.println(data_size);

                            <span class="hljs-keyword">if</span> (data_size &gt; <span class="hljs-number">0</span>)
                            {
                                <span class="hljs-keyword">while</span>(Serial.available() &lt; data_size);
                                Serial.read();

                                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> y = <span class="hljs-number">0</span>; y &lt; data_size; y++)
                                {
                                    data[x] = Serial.read();
                                    x++;
                                }
                                data[x] = <span class="hljs-string">'\0'</span>;
                            }
                            <span class="hljs-keyword">else</span>
                            {
                                Serial.println(<span class="hljs-string">"Download finished"</span>);    
                            }
                        }
                        <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(answer == 2)</span>
                        </span>{
                            Serial.println(<span class="hljs-string">"Error from HTTP"</span>);
                        }
                        <span class="hljs-keyword">else</span>
                        {
                            Serial.println(<span class="hljs-string">"No more data available"</span>);
                            data_size = <span class="hljs-number">0</span>;
                        }
                        
                        sendATcommand(<span class="hljs-string">""</span>, <span class="hljs-string">"+HTTPACTION:0,200"</span>, <span class="hljs-number">20000</span>);
                    }<span class="hljs-keyword">while</span> (data_size &gt; <span class="hljs-number">0</span>);
                    
                    Serial.print(<span class="hljs-string">"Data received: "</span>);
                    Serial.println(data);
                }
                <span class="hljs-keyword">else</span>
                {
                    Serial.println(<span class="hljs-string">"Error getting the url"</span>);
                }
            }
            <span class="hljs-keyword">else</span>
            {
                Serial.println(<span class="hljs-string">"Error setting the url"</span>);
            }
        }
        <span class="hljs-keyword">else</span>
        {
            Serial.println(<span class="hljs-string">"Error setting the CID"</span>);
        }    
    }
    <span class="hljs-keyword">else</span>
    {
        Serial.println(<span class="hljs-string">"Error initializating"</span>);
    }
    
    sendATcommand(<span class="hljs-string">"AT+HTTPTERM"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">5000</span>);

    delay(<span class="hljs-number">5000</span>);

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;

    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        <span class="hljs-comment">// power on pulse</span>
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);

        <span class="hljs-comment">// waits for an answer from the module</span>
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){  
            <span class="hljs-comment">// Send AT every two seconds and wait for the answer   </span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }

}


<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">char</span>* expected_answer1, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            response[x] = Serial.read();
            x++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer1) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

    <span class="hljs-keyword">return</span> answer;
}



<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand2</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">char</span>* expected_answer1, 
<span class="hljs-keyword">char</span>* expected_answer2, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{        
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            response[x] = Serial.read();
            x++;
            <span class="hljs-comment">// check if the desired answer 1 is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer1) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
            <span class="hljs-comment">// check if the desired answer 2 is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer2) != NULL)    
            {
                answer = <span class="hljs-number">2</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

    <span class="hljs-keyword">return</span> answer;
}
    </pre>
<div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>  	
	<p class="text-justify"><strong>Raspberry Pi code:</strong></p>
 <div class="code cpp">
	<div class="code_tools">
    <button class="btn btn-info btn-xs">Show code</button>
		<div class="pull-left">Code:</div>
    </div>
    <pre class="hljs" style="display: none;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>

<span class="hljs-comment">//Include arduPi library</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> "arduPi.h"</span>

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand2</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer1, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer2, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>;
<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>;


<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> onModulePin= <span class="hljs-number">2</span>;

<span class="hljs-keyword">char</span> data[<span class="hljs-number">512</span>];
<span class="hljs-keyword">int</span> data_size;

<span class="hljs-keyword">char</span> aux_str[<span class="hljs-number">100</span>];
<span class="hljs-keyword">char</span> aux;
<span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>;

<span class="hljs-keyword">char</span> pin[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> apn[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> user_name[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> password[]=<span class="hljs-string">"*******"</span>;

<span class="hljs-keyword">char</span> url[ ]=<span class="hljs-string">"test.libelium.com/test-get-post.php?a=1&amp;b=2"</span>;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{

    pinMode(onModulePin, OUTPUT);
    Serial.begin(<span class="hljs-number">115200</span>);   

    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Starting...\n"</span>);
    power_on();

    delay(<span class="hljs-number">3000</span>);

    <span class="hljs-comment">//sets the PIN code</span>
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+CPIN=%s"</span>, pin);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);

    delay(<span class="hljs-number">3000</span>);

    <span class="hljs-keyword">while</span> (sendATcommand2(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,1"</span>, <span class="hljs-string">"+CREG: 0,5"</span>, <span class="hljs-number">2000</span>) == <span class="hljs-number">0</span>);


    <span class="hljs-comment">// sets APN , user name and password</span>
    sendATcommand(<span class="hljs-string">"AT+SAPBR=3,1,\"Contype\",\"GPRS\""</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+SAPBR=3,1,\"APN\",\"%s\""</span>, apn);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+SAPBR=3,1,\"USER\",\"%s\""</span>, user_name);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+SAPBR=3,1,\"PWD\",\"%s\""</span>, password);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);

    <span class="hljs-keyword">while</span> (sendATcommand(<span class="hljs-string">"AT+SAPBR=1,1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">20000</span>) == <span class="hljs-number">0</span>)
    {
        delay(<span class="hljs-number">5000</span>);
    }


}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{
    <span class="hljs-comment">// Initializes HTTP service</span>
    answer = sendATcommand(<span class="hljs-string">"AT+HTTPINIT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">10000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
    {
        <span class="hljs-comment">// Sets CID parameter</span>
        answer = sendATcommand(<span class="hljs-string">"AT+HTTPPARA=\"CID\",1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">5000</span>);
        <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
        {
            <span class="hljs-comment">// Sets url </span>
            
            <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+HTTPPARA=\"URL\",\"%s\""</span>, url);
            answer = sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">5000</span>);
            <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
            {
                <span class="hljs-comment">// Starts GET action</span>
                answer = sendATcommand(<span class="hljs-string">"AT+HTTPACTION=0"</span>, <span class="hljs-string">"+HTTPACTION:0,200"</span>, <span class="hljs-number">10000</span>);
                
                <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
                {
                    x=<span class="hljs-number">0</span>;
                    <span class="hljs-keyword">do</span>{
                        <span class="hljs-built_in">sprintf</span>(aux_str, <span class="hljs-string">"AT+HTTPREAD=%d,100"</span>, x);
                        <span class="hljs-keyword">if</span> (sendATcommand2(aux_str, <span class="hljs-string">"+HTTPREAD:"</span>, <span class="hljs-string">"ERROR"</span>, <span class="hljs-number">30000</span>) == <span class="hljs-number">1</span>)
                        {
                            data_size = <span class="hljs-number">0</span>;
                            <span class="hljs-keyword">while</span>(Serial.available()==<span class="hljs-number">0</span>);
                            aux = Serial.read();
                            <span class="hljs-keyword">do</span>{
                                data_size *= <span class="hljs-number">10</span>;
                                data_size += (aux-<span class="hljs-number">0x30</span>);
                                <span class="hljs-keyword">while</span>(Serial.available()==<span class="hljs-number">0</span>);
                                aux = Serial.read();        
                            }<span class="hljs-keyword">while</span>(aux != <span class="hljs-number">0x0D</span>);

                            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Data received: %d\n"</span>,data_size);

                            <span class="hljs-keyword">if</span> (data_size &gt; <span class="hljs-number">0</span>)
                            {
                                <span class="hljs-keyword">while</span>(Serial.available() &lt; data_size);
                                Serial.read();

                                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> y = <span class="hljs-number">0</span>; y &lt; data_size; y++)
                                {
                                    data[x] = Serial.read();
                                    x++;
                                }
                                data[x] = <span class="hljs-string">'\0'</span>;
                            }
                            <span class="hljs-keyword">else</span>
                            {
                                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Download finished\n"</span>);    
                            }
                        }
                        <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(answer == 2)</span>
                        </span>{
                            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error from HTTP\n"</span>);
                        }
                        <span class="hljs-keyword">else</span>
                        {
                            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"No more data available\n"</span>);
                            data_size = <span class="hljs-number">0</span>;
                        }
                        
                        sendATcommand(<span class="hljs-string">""</span>, <span class="hljs-string">"+HTTPACTION:0,200"</span>, <span class="hljs-number">20000</span>);
                    }<span class="hljs-keyword">while</span> (data_size &gt; <span class="hljs-number">0</span>);
                    
                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Data received: %s\n"</span>,data);
                    
                }
                <span class="hljs-keyword">else</span>
                {
                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error getting the url\n"</span>);
                }
            }
            <span class="hljs-keyword">else</span>
            {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error setting the url\n"</span>);
            }
        }
        <span class="hljs-keyword">else</span>
        {
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error setting the CID\n"</span>);
        }    
    }
    <span class="hljs-keyword">else</span>
    {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error initializating\n"</span>);
    }
    
    sendATcommand(<span class="hljs-string">"AT+HTTPTERM"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">5000</span>);

    delay(<span class="hljs-number">5000</span>);

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;

    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        <span class="hljs-comment">// power on pulse</span>
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);

        <span class="hljs-comment">// waits for an answer from the module</span>
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){  
            <span class="hljs-comment">// Send AT every two seconds and wait for the answer   </span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }

}


<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer1, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            response[x] = Serial.read();
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>,response[x]);
            x++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer1) != NULL)    
            {
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

    <span class="hljs-keyword">return</span> answer;
}



<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand2</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer1, 
<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer2, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{        
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            response[x] = Serial.read();
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>,response[x]);
            x++;
            <span class="hljs-comment">// check if the desired answer 1 is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer1) != NULL)    
            {
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
                answer = <span class="hljs-number">1</span>;
            }
            <span class="hljs-comment">// check if the desired answer 2 is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer2) != NULL)    
            {
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
                answer = <span class="hljs-number">2</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

    <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span> <span class="hljs-params">()</span></span>{
    setup();
    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>){
        loop();
    }
    <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>);
}

    </pre>
<div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div> 	
	<h3>Command summary</h3>
	<div class="row">
	<div class="col-xs-12 col-md-2">
	</div>
		<div class="col-xs-12 col-md-8">	
	<table class="table table-bordered table-hover table-bordered">
       <tbody><tr>
            <th>AT command</th> <th>Response</th> <th>Description</th>
        </tr>
        <tr>
        </tr>
        <tr>
            <td>AT+SAPBR</td>
            <td>OK</td>
            <td>Configures GPRS profile</td>
        </tr>
        <tr>
        </tr>
        <tr>
            <td>AT+HTTPINIT</td>
            <td>OK</td>
            <td>Initializes HTTP service</td>
        </tr>
        <tr>
        </tr>
        <tr>
            <td>AT+HTTPPARA</td>
            <td>OK</td>
            <td>Configures HTTP parameters</td>
        </tr>
        <tr>
        </tr>
        <tr>
            <td>AT+HTTPACTION=0</td>
            <td>OK</td>
            <td>Sets HTTP Method Action , GET in this chase.</td>
        </tr>
        <tr>
        </tr>
        <tr>
            <td>AT+HTTPREAD</td>
            <td>&nbsp;</td>
            <td>Reads HTTP data</td>
        </tr>
        <tr>
        </tr>
        <tr>
            <td>AT+HTTPTERM</td>
            <td>OK</td>
            <td>Closes the opened HTTP session.</td>
        </tr>
	</tbody></table>
		</div>
	<div class="col-xs-12 col-md-2">
		</div>
	</div>		
</div>

<!-- ############## Step 9: Using the shield in standalone mode - GPS ############## -->
<div class="section_title">
	<h2><a name="gps" class="ancla"></a>Step 9: Using the shield in standalone mode - GPS <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#index" class="pull-right goto">Go to index <span class="glyphicon glyphicon-arrow-up"></span></a></h2>
	<p class="text-justify">The SIM908 includes a GPS receive. The next sketch shows how to power on the GPS and get the NMEA strings when the satellites had been fixed.</p>
	<p class="text-justify"><strong>Arduino code:</strong></p>
 <div class="code cpp">
	<div class="code_tools">
    <button class="btn btn-info btn-xs">Show code</button>
		<div class="pull-left">Code:</div>
    </div>
    <pre class="hljs" style="display: none;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>
 
 
<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> onModulePin= <span class="hljs-number">2</span>;
<span class="hljs-keyword">int</span> counter;
<span class="hljs-keyword">long</span> previous;


<span class="hljs-keyword">char</span> Basic_str[<span class="hljs-number">100</span>];
<span class="hljs-keyword">char</span> GGA_str[<span class="hljs-number">100</span>];
<span class="hljs-keyword">char</span> GLL_str[<span class="hljs-number">100</span>];
<span class="hljs-keyword">char</span> RMC_str[<span class="hljs-number">100</span>];
<span class="hljs-keyword">char</span> VTG_str[<span class="hljs-number">100</span>];
<span class="hljs-keyword">char</span> ZDA_str[<span class="hljs-number">100</span>];

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{
    
    pinMode(onModulePin, OUTPUT);
    Serial.begin(<span class="hljs-number">115200</span>);   
    
    Serial.println(<span class="hljs-string">"Starting..."</span>);
    power_on();
    
    delay(<span class="hljs-number">3000</span>);
    
    sendATcommand(<span class="hljs-string">"AT+CGPSPWR=1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    sendATcommand(<span class="hljs-string">"AT+CGPSRST=0"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    
    <span class="hljs-comment">// waits for fix GPS</span>
    <span class="hljs-keyword">while</span>( (sendATcommand(<span class="hljs-string">"AT+CGPSSTATUS?"</span>, <span class="hljs-string">"2D Fix"</span>, <span class="hljs-number">5000</span>) || 
            sendATcommand(<span class="hljs-string">"AT+CGPSSTATUS?"</span>, <span class="hljs-string">"3D Fix"</span>, <span class="hljs-number">5000</span>)) == <span class="hljs-number">0</span> );
    

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{
    <span class="hljs-comment">// Basic</span>
    <span class="hljs-comment">// Clean the input buffer</span>
    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    
    delay(<span class="hljs-number">100</span>);
    <span class="hljs-comment">// request Basic string</span>
    sendATcommand(<span class="hljs-string">"AT+CGPSINF=0"</span>, <span class="hljs-string">"AT+CGPSINF=0\r\n\r\n"</span>, <span class="hljs-number">2000</span>);
    
    counter = <span class="hljs-number">0</span>;
    answer = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">memset</span>(Basic_str, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>
    previous = millis();
    <span class="hljs-comment">// this loop waits for the NMEA string</span>
    <span class="hljs-keyword">do</span>{

        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            Basic_str[counter] = Serial.read();
            counter++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(Basic_str, <span class="hljs-string">"OK"</span>) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; <span class="hljs-number">2000</span>));  
    
    Basic_str[counter-<span class="hljs-number">3</span>] = <span class="hljs-string">'\0'</span>;
    
    <span class="hljs-comment">//**********************************************************</span>
    <span class="hljs-comment">// GGA</span>
    <span class="hljs-comment">// Clean the input buffer</span>
    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    
    delay(<span class="hljs-number">100</span>);
    <span class="hljs-comment">// request GGA string</span>
    sendATcommand(<span class="hljs-string">"AT+CGPSINF=2"</span>, <span class="hljs-string">"AT+CGPSINF=2\r\n\r\n"</span>, <span class="hljs-number">2000</span>);
    
    counter = <span class="hljs-number">0</span>;
    answer = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">memset</span>(GGA_str, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>
    previous = millis();
    <span class="hljs-comment">// this loop waits for the NMEA string</span>
    <span class="hljs-keyword">do</span>{

        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            GGA_str[counter] = Serial.read();
            counter++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(GGA_str, <span class="hljs-string">"OK"</span>) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; <span class="hljs-number">2000</span>));  
    
    GGA_str[counter-<span class="hljs-number">3</span>] = <span class="hljs-string">'\0'</span>;
    
    <span class="hljs-comment">//**********************************************************</span>
    <span class="hljs-comment">// GLL</span>
    <span class="hljs-comment">// Clean the input buffer</span>
    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    
       
    delay(<span class="hljs-number">100</span>);
    <span class="hljs-comment">// request GLL string</span>
    sendATcommand(<span class="hljs-string">"AT+CGPSINF=4"</span>, <span class="hljs-string">"AT+CGPSINF=4\r\n\r\n"</span>, <span class="hljs-number">2000</span>);   
    
    counter = <span class="hljs-number">0</span>;
    answer = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">memset</span>(GLL_str, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>
    previous = millis();
    <span class="hljs-comment">// this loop waits for the NMEA string</span>
    <span class="hljs-keyword">do</span>{

        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            GLL_str[counter] = Serial.read();
            counter++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(GLL_str, <span class="hljs-string">"OK"</span>) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; <span class="hljs-number">2000</span>)); 
    
    GLL_str[counter-<span class="hljs-number">3</span>] = <span class="hljs-string">'\0'</span>;
        
    <span class="hljs-comment">//**********************************************************</span>
    <span class="hljs-comment">// RMC</span>
    <span class="hljs-comment">// Clean the input buffer</span>
    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    
       
    delay(<span class="hljs-number">100</span>);
    <span class="hljs-comment">// request RMC string </span>
    sendATcommand(<span class="hljs-string">"AT+CGPSINF=32"</span>, <span class="hljs-string">"AT+CGPSINF=32\r\n\r\n"</span>, <span class="hljs-number">2000</span>);
    
    counter = <span class="hljs-number">0</span>;
    answer = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">memset</span>(RMC_str, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>
    previous = millis();
    <span class="hljs-comment">// this loop waits for the NMEA string</span>
    <span class="hljs-keyword">do</span>{

        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            RMC_str[counter] = Serial.read();
            counter++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(RMC_str, <span class="hljs-string">"OK"</span>) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; <span class="hljs-number">2000</span>)); 
    
    RMC_str[counter-<span class="hljs-number">3</span>] = <span class="hljs-string">'\0'</span>;
    
    <span class="hljs-comment">//**********************************************************</span>
    <span class="hljs-comment">// VTG</span>
    <span class="hljs-comment">// Clean the input buffer</span>
    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    
       
    delay(<span class="hljs-number">100</span>);
    <span class="hljs-comment">// request VTG string</span>
    sendATcommand(<span class="hljs-string">"AT+CGPSINF=64"</span>, <span class="hljs-string">"AT+CGPSINF=64\r\n\r\n"</span>, <span class="hljs-number">2000</span>); 
    
    counter = <span class="hljs-number">0</span>;
    answer = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">memset</span>(VTG_str, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>
    previous = millis();
    <span class="hljs-comment">// this loop waits for the NMEA string</span>
    <span class="hljs-keyword">do</span>{

        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            VTG_str[counter] = Serial.read();
            counter++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(VTG_str, <span class="hljs-string">"OK"</span>) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; <span class="hljs-number">2000</span>)); 
    
    VTG_str[counter-<span class="hljs-number">3</span>] = <span class="hljs-string">'\0'</span>;
    
    <span class="hljs-comment">//**********************************************************</span>
    <span class="hljs-comment">// ZDA</span>
    <span class="hljs-comment">// Clean the input buffer</span>
    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    
       
    delay(<span class="hljs-number">100</span>);
    <span class="hljs-comment">// request ZDA string</span>
    sendATcommand(<span class="hljs-string">"AT+CGPSINF=128"</span>, <span class="hljs-string">"AT+CGPSINF=128\r\n\r\n"</span>, <span class="hljs-number">2000</span>);
    
    counter = <span class="hljs-number">0</span>;
    answer = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">memset</span>(ZDA_str, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>
    previous = millis();
    <span class="hljs-comment">// this loop waits for the NMEA string</span>
    <span class="hljs-keyword">do</span>{

        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            ZDA_str[counter] = Serial.read();
            counter++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(ZDA_str, <span class="hljs-string">"OK"</span>) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; <span class="hljs-number">2000</span>));
    
    ZDA_str[counter-<span class="hljs-number">3</span>] = <span class="hljs-string">'\0'</span>;
    
    Serial.println(<span class="hljs-string">"*************************************************"</span>);
    Serial.print(<span class="hljs-string">"Basic string: "</span>);
    Serial.println(Basic_str);
    Serial.print(<span class="hljs-string">"GGA string: "</span>);
    Serial.println(GGA_str);
    Serial.print(<span class="hljs-string">"GLL string: "</span>);
    Serial.println(GLL_str);
    Serial.print(<span class="hljs-string">"RMC string: "</span>);
    Serial.println(RMC_str);
    Serial.print(<span class="hljs-string">"VTG string: "</span>);
    Serial.println(VTG_str);
    Serial.print(<span class="hljs-string">"ZDA string: "</span>);
    Serial.println(ZDA_str);
   
    delay(<span class="hljs-number">15000</span>);

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        <span class="hljs-comment">// power on pulse</span>
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);
    
        <span class="hljs-comment">// waits for an answer from the module</span>
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){    
            <span class="hljs-comment">// Send AT every two seconds and wait for the answer</span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }
    
}


<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">char</span>* expected_answer1,
        <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span>
</span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>
    
    delay(<span class="hljs-number">100</span>);
    
    <span class="hljs-comment">// Clean the input buffer</span>
    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    
    
    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


    x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{

        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            response[x] = Serial.read();
            x++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer1) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

    <span class="hljs-keyword">return</span> answer;
}
    </pre>
<div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div>  	
	<p class="text-justify"><strong>Raspberry Pi code:</strong></p>
 <div class="code cpp">
	<div class="code_tools">
    <button class="btn btn-info btn-xs">Show code</button>
		<div class="pull-left">Code:</div>
    </div>
    <pre class="hljs" style="display: none;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>
 
 <span class="hljs-comment">//Include arduPi library</span>
 <span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> "arduPi.h"</span>

 <span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer1, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>;
 <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>;
 
<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> onModulePin= <span class="hljs-number">2</span>;
<span class="hljs-keyword">int</span> counter;
<span class="hljs-keyword">long</span> previous;


<span class="hljs-keyword">char</span> Basic_str[<span class="hljs-number">100</span>];
<span class="hljs-keyword">char</span> GGA_str[<span class="hljs-number">100</span>];
<span class="hljs-keyword">char</span> GLL_str[<span class="hljs-number">100</span>];
<span class="hljs-keyword">char</span> RMC_str[<span class="hljs-number">100</span>];
<span class="hljs-keyword">char</span> VTG_str[<span class="hljs-number">100</span>];
<span class="hljs-keyword">char</span> ZDA_str[<span class="hljs-number">100</span>];

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{
    
    pinMode(onModulePin, OUTPUT);
    Serial.begin(<span class="hljs-number">115200</span>);   
    
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Starting...\n"</span>);
    power_on();
    
    delay(<span class="hljs-number">3000</span>);
    
      
    sendATcommand(<span class="hljs-string">"AT+CGPSPWR=1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    sendATcommand(<span class="hljs-string">"AT+CGPSRST=0"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    
    <span class="hljs-comment">// waits for fix GPS</span>
    <span class="hljs-keyword">while</span>( (sendATcommand(<span class="hljs-string">"AT+CGPSSTATUS?"</span>, <span class="hljs-string">"2D Fix"</span>, <span class="hljs-number">5000</span>) || 
            sendATcommand(<span class="hljs-string">"AT+CGPSSTATUS?"</span>, <span class="hljs-string">"3D Fix"</span>, <span class="hljs-number">5000</span>)) == <span class="hljs-number">0</span> );
    

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{
    <span class="hljs-comment">// Basic</span>
    <span class="hljs-comment">// Clean the input buffer</span>
    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    
    delay(<span class="hljs-number">100</span>);
    <span class="hljs-comment">// request Basic string</span>
    sendATcommand(<span class="hljs-string">"AT+CGPSINF=0"</span>, <span class="hljs-string">"AT+CGPSINF=0\r\n\r\n"</span>, <span class="hljs-number">2000</span>);
    
    counter = <span class="hljs-number">0</span>;
    answer = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">memset</span>(Basic_str, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>
    previous = millis();
    <span class="hljs-comment">// this loop waits for the NMEA string</span>
    <span class="hljs-keyword">do</span>{

        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            Basic_str[counter] = Serial.read();
            counter++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(Basic_str, <span class="hljs-string">"OK"</span>) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; <span class="hljs-number">2000</span>));  
    
    Basic_str[counter-<span class="hljs-number">3</span>] = <span class="hljs-string">'\0'</span>;
    
    <span class="hljs-comment">//**********************************************************</span>
    <span class="hljs-comment">// GGA</span>
    <span class="hljs-comment">// Clean the input buffer</span>
    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    
    delay(<span class="hljs-number">100</span>);
    <span class="hljs-comment">// request GGA string</span>
    sendATcommand(<span class="hljs-string">"AT+CGPSINF=2"</span>, <span class="hljs-string">"AT+CGPSINF=2\r\n\r\n"</span>, <span class="hljs-number">2000</span>);
    
    counter = <span class="hljs-number">0</span>;
    answer = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">memset</span>(GGA_str, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>
    previous = millis();
    <span class="hljs-comment">// this loop waits for the NMEA string</span>
    <span class="hljs-keyword">do</span>{

        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            GGA_str[counter] = Serial.read();
            counter++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(GGA_str, <span class="hljs-string">"OK"</span>) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; <span class="hljs-number">2000</span>));  
    
    GGA_str[counter-<span class="hljs-number">3</span>] = <span class="hljs-string">'\0'</span>;
    
    <span class="hljs-comment">//**********************************************************</span>
    <span class="hljs-comment">// GLL</span>
    <span class="hljs-comment">// Clean the input buffer</span>
    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    
       
    delay(<span class="hljs-number">100</span>);
    <span class="hljs-comment">// request GLL string</span>
    sendATcommand(<span class="hljs-string">"AT+CGPSINF=4"</span>, <span class="hljs-string">"AT+CGPSINF=4\r\n\r\n"</span>, <span class="hljs-number">2000</span>);   
    
    counter = <span class="hljs-number">0</span>;
    answer = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">memset</span>(GLL_str, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>
    previous = millis();
    <span class="hljs-comment">// this loop waits for the NMEA string</span>
    <span class="hljs-keyword">do</span>{

        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            GLL_str[counter] = Serial.read();
            counter++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(GLL_str, <span class="hljs-string">"OK"</span>) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; <span class="hljs-number">2000</span>)); 
    
    GLL_str[counter-<span class="hljs-number">3</span>] = <span class="hljs-string">'\0'</span>;
        
    <span class="hljs-comment">//**********************************************************</span>
    <span class="hljs-comment">// RMC</span>
    <span class="hljs-comment">// Clean the input buffer</span>
    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    
       
    delay(<span class="hljs-number">100</span>);
    <span class="hljs-comment">// request RMC string </span>
    sendATcommand(<span class="hljs-string">"AT+CGPSINF=32"</span>, <span class="hljs-string">"AT+CGPSINF=32\r\n\r\n"</span>, <span class="hljs-number">2000</span>);
    
    counter = <span class="hljs-number">0</span>;
    answer = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">memset</span>(RMC_str, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>
    previous = millis();
    <span class="hljs-comment">// this loop waits for the NMEA string</span>
    <span class="hljs-keyword">do</span>{

        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            RMC_str[counter] = Serial.read();
            counter++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(RMC_str, <span class="hljs-string">"OK"</span>) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; <span class="hljs-number">2000</span>)); 
    
    RMC_str[counter-<span class="hljs-number">3</span>] = <span class="hljs-string">'\0'</span>;
    
    <span class="hljs-comment">//**********************************************************</span>
    <span class="hljs-comment">// VTG</span>
    <span class="hljs-comment">// Clean the input buffer</span>
    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    
       
    delay(<span class="hljs-number">100</span>);
    <span class="hljs-comment">// request VTG string</span>
    sendATcommand(<span class="hljs-string">"AT+CGPSINF=64"</span>, <span class="hljs-string">"AT+CGPSINF=64\r\n\r\n"</span>, <span class="hljs-number">2000</span>); 
    
    counter = <span class="hljs-number">0</span>;
    answer = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">memset</span>(VTG_str, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>
    previous = millis();
    <span class="hljs-comment">// this loop waits for the NMEA string</span>
    <span class="hljs-keyword">do</span>{

        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            VTG_str[counter] = Serial.read();
            counter++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(VTG_str, <span class="hljs-string">"OK"</span>) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; <span class="hljs-number">2000</span>)); 
    
    VTG_str[counter-<span class="hljs-number">3</span>] = <span class="hljs-string">'\0'</span>;
    
    <span class="hljs-comment">//**********************************************************</span>
    <span class="hljs-comment">// ZDA</span>
    <span class="hljs-comment">// Clean the input buffer</span>
    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    
       
    delay(<span class="hljs-number">100</span>);
    <span class="hljs-comment">// request ZDA string</span>
    sendATcommand(<span class="hljs-string">"AT+CGPSINF=128"</span>, <span class="hljs-string">"AT+CGPSINF=128\r\n\r\n"</span>, <span class="hljs-number">2000</span>);
    
    counter = <span class="hljs-number">0</span>;
    answer = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">memset</span>(ZDA_str, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>
    previous = millis();
    <span class="hljs-comment">// this loop waits for the NMEA string</span>
    <span class="hljs-keyword">do</span>{

        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            ZDA_str[counter] = Serial.read();
            counter++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(ZDA_str, <span class="hljs-string">"OK"</span>) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }<span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; <span class="hljs-number">2000</span>));
    
    ZDA_str[counter-<span class="hljs-number">3</span>] = <span class="hljs-string">'\0'</span>;
    
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"*************************************************\n"</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Basic string: "</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s\n"</span>,Basic_str);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"GGA string: "</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s\n"</span>,GGA_str);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"GLL string: "</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s\n"</span>,GLL_str);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"RMC string: "</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s\n"</span>,RMC_str);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"VTG string: "</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s\n"</span>,VTG_str);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"ZDA string: "</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s\n"</span>,ZDA_str);
   
    delay(<span class="hljs-number">15000</span>);

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        <span class="hljs-comment">// power on pulse</span>
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);
    
        <span class="hljs-comment">// waits for an answer from the module</span>
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){    
            <span class="hljs-comment">// Send AT every two seconds and wait for the answer</span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }
    
}


<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* expected_answer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            <span class="hljs-comment">// if there are data in the UART input buffer, reads it and checks for the asnwer</span>
            response[x] = Serial.read();
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>,response[x]);
            x++;
            <span class="hljs-comment">// check if the desired answer  is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer) != NULL)    
            {
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
                answer = <span class="hljs-number">1</span>;
            }
        }
    }
    <span class="hljs-comment">// Waits for the asnwer with time out</span>
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

        <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{
    setup();
    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>){loop();}
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

    </pre>
<div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div> 	
	<h3>Command summary</h3>
	<div class="row">
	<div class="col-xs-12 col-md-1">
	</div>
		<div class="col-xs-12 col-md-10">	
	<table class="table table-bordered table-hover table-bordered">
       <tbody><tr>
            <th>AT command</th>
            <th>Response</th>
            <th>Description</th>
        </tr>
        <tr>
            <td>AT+CGPSPWR</td>
            <td>OK</td>
            <td>Powers the GPS</td>
        </tr>
        <tr>
            <td>AT+CGPSRST</td>
            <td>OK</td>
            <td>Sets the reset mode</td>
        </tr>
        <tr>
            <td>AT+CGPSSTATUS</td>
            <td></td>
            <td>Gets the status: Unknown, Not Fix, 2D Fix and 3D Fix</td>
        </tr>
        <tr>
            <td>AT+CGPSINF</td>
            <td>NMEA string</td>
            <td>Gets NMEA strings</td>
        </tr>
	</tbody></table>
		</div>
	<div class="col-xs-12 col-md-1">
		</div>
	</div>		
</div>

<!-- ############## Realtime geolocation tracking ############## -->
<div class="section_title">
	<h2><a name="realtime-geolocation-tracking" class="ancla"></a>Realtime geolocation tracking <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#index" class="pull-right goto">Go to index <span class="glyphicon glyphicon-arrow-up"></span></a></h2>
	<p class="text-justify">In this step we use an Arduino UNO with the GPRS+GPS shield to send GPS coordinates to a computer that it shows the position of the Arduino in Google Maps.</p>
	<p class="text-justify">First step. Load the next sketch into your arduino and then assemble the GPRS+GPS shield with the antennas and the simcard installed. <strong>Remember</strong>, you must configure your APN, login and password. If you don't do this, the GPRS+GPS cannot connect to the GPRS network. Also, you must set the URL with the IP address of your computer (external IP, not the LAN IP address) or your server's domain.</p>
	<div class="code cpp">
	<div class="code_tools">
    <button class="btn btn-info btn-xs">Show code</button>
		<div class="pull-left">Code:</div>
    </div>
    <pre class="hljs" style="display: none;"><span class="hljs-comment">/*  
 *  GPRS+GPS Quadband Module (SIM908)
 *  
 *  Copyright (C) Libelium Comunicaciones Distribuidas S.L. 
 *  http://www.libelium.com 
 *  
 *  This program is free software: you can redistribute it and/or modify 
 *  it under the terms of the GNU General Public License as published by 
 *  the Free Software Foundation, either version 3 of the License, or 
 *  (at your option) any later version. 
 *  a
 *  This program is distributed in the hope that it will be useful, 
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of 
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License 
 *  along with this program.  If not, see http://www.gnu.org/licenses/. 
 *  
 *  Version:           2.0
 *  Design:            David Gascón 
 *  Implementation:    Alejandro Gallego &amp; Marcos Martinez
 */</span>


<span class="hljs-keyword">int8_t</span> answer;
<span class="hljs-keyword">int</span> onModulePin= <span class="hljs-number">2</span>;

<span class="hljs-keyword">char</span> data[<span class="hljs-number">100</span>];
<span class="hljs-keyword">int</span> data_size;

<span class="hljs-keyword">char</span> aux_str[<span class="hljs-number">100</span>];
<span class="hljs-keyword">char</span> aux;
<span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>;
<span class="hljs-keyword">char</span> N_S,W_E;

<span class="hljs-keyword">char</span> url[] = <span class="hljs-string">"http://pruebas.libelium.com/demo_sim908.php"</span>;
<span class="hljs-keyword">char</span> frame[<span class="hljs-number">200</span>];

<span class="hljs-keyword">char</span> pin[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> apn[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> user_name[]=<span class="hljs-string">"*******"</span>;
<span class="hljs-keyword">char</span> password[]=<span class="hljs-string">"*******"</span>;

<span class="hljs-keyword">char</span> latitude[<span class="hljs-number">15</span>];
<span class="hljs-keyword">char</span> longitude[<span class="hljs-number">15</span>];
<span class="hljs-keyword">char</span> altitude[<span class="hljs-number">6</span>];
<span class="hljs-keyword">char</span> date[<span class="hljs-number">16</span>];
<span class="hljs-keyword">char</span> time[<span class="hljs-number">7</span>];
<span class="hljs-keyword">char</span> satellites[<span class="hljs-number">3</span>];
<span class="hljs-keyword">char</span> speedOTG[<span class="hljs-number">10</span>];
<span class="hljs-keyword">char</span> course[<span class="hljs-number">10</span>];


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span></span>{

    pinMode(onModulePin, OUTPUT);
    Serial.begin(<span class="hljs-number">115200</span>);   

    Serial.println(<span class="hljs-string">"Starting..."</span>);
    power_on();

    delay(<span class="hljs-number">3000</span>);

    <span class="hljs-comment">//sets the PIN code</span>
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+CPIN=%s"</span>, pin);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);

    delay(<span class="hljs-number">3000</span>);
    
    <span class="hljs-comment">// starts the GPS and waits for signal</span>
    <span class="hljs-keyword">while</span> ( start_GPS() == <span class="hljs-number">0</span>);

    <span class="hljs-keyword">while</span> (sendATcommand(<span class="hljs-string">"AT+CREG?"</span>, <span class="hljs-string">"+CREG: 0,1"</span>, <span class="hljs-number">2000</span>) == <span class="hljs-number">0</span>);

    <span class="hljs-comment">// sets APN , user name and password</span>
    sendATcommand(<span class="hljs-string">"AT+SAPBR=3,1,\"Contype\",\"GPRS\""</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+SAPBR=3,1,\"APN\",\"%s\""</span>, apn);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+SAPBR=3,1,\"USER\",\"%s\""</span>, user_name);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    
    <span class="hljs-built_in">snprintf</span>(aux_str, <span class="hljs-keyword">sizeof</span>(aux_str), <span class="hljs-string">"AT+SAPBR=3,1,\"PWD\",\"%s\""</span>, password);
    sendATcommand(aux_str, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);

    <span class="hljs-comment">// gets the GPRS bearer</span>
    <span class="hljs-keyword">while</span> (sendATcommand(<span class="hljs-string">"AT+SAPBR=1,1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">20000</span>) == <span class="hljs-number">0</span>)
    {
        delay(<span class="hljs-number">5000</span>);
    }

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span></span>{

    <span class="hljs-comment">// gets GPS data</span>
    get_GPS();
    
    <span class="hljs-comment">// sends GPS data to the script</span>
    send_HTTP();

    delay(<span class="hljs-number">5000</span>);

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">power_on</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">uint8_t</span> answer=<span class="hljs-number">0</span>;

    <span class="hljs-comment">// checks if the module is started</span>
    answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">0</span>)
    {
        <span class="hljs-comment">// power on pulse</span>
        digitalWrite(onModulePin,HIGH);
        delay(<span class="hljs-number">3000</span>);
        digitalWrite(onModulePin,LOW);

        <span class="hljs-comment">// waits for an answer from the module</span>
        <span class="hljs-keyword">while</span>(answer == <span class="hljs-number">0</span>){  
            <span class="hljs-comment">// Send AT every two seconds and wait for the answer   </span>
            answer = sendATcommand(<span class="hljs-string">"AT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);    
        }
    }

}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">start_GPS</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    previous = millis();
    <span class="hljs-comment">// starts the GPS</span>
    sendATcommand(<span class="hljs-string">"AT+CGPSPWR=1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);
    sendATcommand(<span class="hljs-string">"AT+CGPSRST=0"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">2000</span>);

    <span class="hljs-comment">// waits for fix GPS</span>
    <span class="hljs-keyword">while</span>(( (sendATcommand(<span class="hljs-string">"AT+CGPSSTATUS?"</span>, <span class="hljs-string">"2D Fix"</span>, <span class="hljs-number">5000</span>) || 
        sendATcommand(<span class="hljs-string">"AT+CGPSSTATUS?"</span>, <span class="hljs-string">"3D Fix"</span>, <span class="hljs-number">5000</span>)) == <span class="hljs-number">0</span> ) &amp;&amp; 
        ((millis() - previous) &lt; <span class="hljs-number">90000</span>));

    <span class="hljs-keyword">if</span> ((millis() - previous) &lt; <span class="hljs-number">90000</span>)
    {
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">else</span>
    {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    
    }
}

<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">get_GPS</span><span class="hljs-params">()</span></span>{

    <span class="hljs-keyword">int8_t</span> counter, answer;
    <span class="hljs-keyword">long</span> previous;

    <span class="hljs-comment">// First get the NMEA string</span>
    <span class="hljs-comment">// Clean the input buffer</span>
    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read(); 
    <span class="hljs-comment">// request Basic string</span>
    sendATcommand(<span class="hljs-string">"AT+CGPSINF=0"</span>, <span class="hljs-string">"AT+CGPSINF=0\r\n\r\n"</span>, <span class="hljs-number">2000</span>);

    counter = <span class="hljs-number">0</span>;
    answer = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">memset</span>(frame, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>
    previous = millis();
    <span class="hljs-comment">// this loop waits for the NMEA string</span>
    <span class="hljs-keyword">do</span>{

        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            frame[counter] = Serial.read();
            counter++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(frame, <span class="hljs-string">"OK"</span>) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; <span class="hljs-number">2000</span>));  

    frame[counter-<span class="hljs-number">3</span>] = <span class="hljs-string">'\0'</span>; 
    
    <span class="hljs-comment">// Parses the string </span>
    strtok(frame, <span class="hljs-string">","</span>);
    <span class="hljs-built_in">strcpy</span>(longitude,strtok(NULL, <span class="hljs-string">","</span>)); <span class="hljs-comment">// Gets longitude</span>
    <span class="hljs-built_in">strcpy</span>(latitude,strtok(NULL, <span class="hljs-string">","</span>)); <span class="hljs-comment">// Gets latitude</span>
    <span class="hljs-built_in">strcpy</span>(altitude,strtok(NULL, <span class="hljs-string">"."</span>)); <span class="hljs-comment">// Gets altitude </span>
    strtok(NULL, <span class="hljs-string">","</span>);    
    <span class="hljs-built_in">strcpy</span>(date,strtok(NULL, <span class="hljs-string">"."</span>)); <span class="hljs-comment">// Gets date</span>
    strtok(NULL, <span class="hljs-string">","</span>);
    strtok(NULL, <span class="hljs-string">","</span>);  
    <span class="hljs-built_in">strcpy</span>(satellites,strtok(NULL, <span class="hljs-string">","</span>)); <span class="hljs-comment">// Gets satellites</span>
    <span class="hljs-built_in">strcpy</span>(speedOTG,strtok(NULL, <span class="hljs-string">","</span>)); <span class="hljs-comment">// Gets speed over ground. Unit is knots.</span>
    <span class="hljs-built_in">strcpy</span>(course,strtok(NULL, <span class="hljs-string">"\r"</span>)); <span class="hljs-comment">// Gets course</span>

    convert2Degrees(latitude);
    convert2Degrees(longitude);
    
    <span class="hljs-keyword">return</span> answer;
}

<span class="hljs-comment">/* convert2Degrees ( input ) - performs the conversion from input 
 * parameters in  DD°MM.mmm’ notation to DD.dddddd° notation. 
 * 
 * Sign '+' is set for positive latitudes/longitudes (North, East)
 * Sign '-' is set for negative latitudes/longitudes (South, West)
 *  
 */</span>
<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">convert2Degrees</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* input)</span></span>{

    <span class="hljs-keyword">float</span> deg;
    <span class="hljs-keyword">float</span> minutes;
    boolean neg = <span class="hljs-keyword">false</span>;    

    <span class="hljs-comment">//auxiliar variable</span>
    <span class="hljs-keyword">char</span> aux[<span class="hljs-number">10</span>];

    <span class="hljs-keyword">if</span> (input[<span class="hljs-number">0</span>] == <span class="hljs-string">'-'</span>)
    {
        neg = <span class="hljs-keyword">true</span>;
        <span class="hljs-built_in">strcpy</span>(aux, strtok(input+<span class="hljs-number">1</span>, <span class="hljs-string">"."</span>));

    }
    <span class="hljs-keyword">else</span>
    {
        <span class="hljs-built_in">strcpy</span>(aux, strtok(input, <span class="hljs-string">"."</span>));
    }

    <span class="hljs-comment">// convert string to integer and add it to final float variable</span>
    deg = atof(aux);

    <span class="hljs-built_in">strcpy</span>(aux, strtok(NULL, <span class="hljs-string">'\0'</span>));
    minutes=atof(aux);
    minutes/=<span class="hljs-number">1000000</span>;
    <span class="hljs-keyword">if</span> (deg &lt; <span class="hljs-number">100</span>)
    {
        minutes += deg;
        deg = <span class="hljs-number">0</span>;
    }
    <span class="hljs-keyword">else</span>
    {
        minutes += <span class="hljs-keyword">int</span>(deg) % <span class="hljs-number">100</span>;
        deg = <span class="hljs-keyword">int</span>(deg) / <span class="hljs-number">100</span>;    
    }

    <span class="hljs-comment">// add minutes to degrees </span>
    deg=deg+minutes/<span class="hljs-number">60</span>;


    <span class="hljs-keyword">if</span> (neg == <span class="hljs-keyword">true</span>)
    {
        deg*=-<span class="hljs-number">1.0</span>;
    }

    neg = <span class="hljs-keyword">false</span>;

    <span class="hljs-keyword">if</span>( deg &lt; <span class="hljs-number">0</span> ){
        neg = <span class="hljs-keyword">true</span>;
        deg*=-<span class="hljs-number">1</span>;
    }
    
    <span class="hljs-keyword">float</span> numeroFloat=deg; 
    <span class="hljs-keyword">int</span> parteEntera[<span class="hljs-number">10</span>];
    <span class="hljs-keyword">int</span> cifra; 
    <span class="hljs-keyword">long</span> numero=(<span class="hljs-keyword">long</span>)numeroFloat;  
    <span class="hljs-keyword">int</span> size=<span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>){
        size=size+<span class="hljs-number">1</span>;
        cifra=numero%<span class="hljs-number">10</span>;
        numero=numero/<span class="hljs-number">10</span>;
        parteEntera[size-<span class="hljs-number">1</span>]=cifra; 
        <span class="hljs-keyword">if</span> (numero==<span class="hljs-number">0</span>){
            <span class="hljs-keyword">break</span>;
        }
    }
   
    <span class="hljs-keyword">int</span> indice=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span>( neg ){
        indice++;
        input[<span class="hljs-number">0</span>]=<span class="hljs-string">'-'</span>;
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=size-<span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--)
    {
        input[indice]=parteEntera[i]+<span class="hljs-string">'0'</span>; 
        indice++;
    }

    input[indice]=<span class="hljs-string">'.'</span>;
    indice++;

    numeroFloat=(numeroFloat-(<span class="hljs-keyword">int</span>)numeroFloat);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>; i&lt;=<span class="hljs-number">6</span> ; i++)
    {
        numeroFloat=numeroFloat*<span class="hljs-number">10</span>;
        cifra= (<span class="hljs-keyword">long</span>)numeroFloat;          
        numeroFloat=numeroFloat-cifra;
        input[indice]=<span class="hljs-keyword">char</span>(cifra)+<span class="hljs-number">48</span>;
        indice++;
    }
    input[indice]=<span class="hljs-string">'\0'</span>;


}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">send_HTTP</span><span class="hljs-params">()</span></span>{
    
    <span class="hljs-comment">// Initializes HTTP service</span>
    answer = sendATcommand(<span class="hljs-string">"AT+HTTPINIT"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">10000</span>);
    <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
    {
        <span class="hljs-comment">// Sets CID parameter</span>
        answer = sendATcommand(<span class="hljs-string">"AT+HTTPPARA=\"CID\",1"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">5000</span>);
        <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
        {
            <span class="hljs-comment">// Sets url </span>
            <span class="hljs-built_in">sprintf</span>(aux_str, <span class="hljs-string">"AT+HTTPPARA=\"URL\",\"%s"</span>, url);
            Serial.print(aux_str);
            <span class="hljs-built_in">sprintf</span>(frame, <span class="hljs-string">"?visor=false&amp;latitude=%s&amp;longitude=%s&amp;altitude=%s&amp;time=%s&amp;satellites=%s&amp;speedOTG=%s&amp;course=%s"</span>,
            latitude, longitude, altitude, date, satellites, speedOTG, course);
            Serial.print(frame);
            answer = sendATcommand(<span class="hljs-string">"\""</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">5000</span>);
            <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
            {
                <span class="hljs-comment">// Starts GET action</span>
                answer = sendATcommand(<span class="hljs-string">"AT+HTTPACTION=0"</span>, <span class="hljs-string">"+HTTPACTION:0,200"</span>, <span class="hljs-number">30000</span>);
                <span class="hljs-keyword">if</span> (answer == <span class="hljs-number">1</span>)
                {

                    Serial.println(F(<span class="hljs-string">"Done!"</span>));
                }
                <span class="hljs-keyword">else</span>
                {
                    Serial.println(F(<span class="hljs-string">"Error getting url"</span>));
                }

            }
            <span class="hljs-keyword">else</span>
            {
                Serial.println(F(<span class="hljs-string">"Error setting the url"</span>));
            }
        }
        <span class="hljs-keyword">else</span>
        {
            Serial.println(F(<span class="hljs-string">"Error setting the CID"</span>));
        }    
    }
    <span class="hljs-keyword">else</span>
    {
        Serial.println(F(<span class="hljs-string">"Error initializating"</span>));
    }

    sendATcommand(<span class="hljs-string">"AT+HTTPTERM"</span>, <span class="hljs-string">"OK"</span>, <span class="hljs-number">5000</span>);
    
}


<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">sendATcommand</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* ATcommand, <span class="hljs-keyword">char</span>* expected_answer1, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> timeout)</span></span>{

    <span class="hljs-keyword">uint8_t</span> x=<span class="hljs-number">0</span>,  answer=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> response[<span class="hljs-number">100</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> previous;

    <span class="hljs-built_in">memset</span>(response, <span class="hljs-string">'\0'</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// Initialize the string</span>

    delay(<span class="hljs-number">100</span>);

    <span class="hljs-keyword">while</span>( Serial.available() &gt; <span class="hljs-number">0</span>) Serial.read();    <span class="hljs-comment">// Clean the input buffer</span>

    Serial.println(ATcommand);    <span class="hljs-comment">// Send the AT command </span>


        x = <span class="hljs-number">0</span>;
    previous = millis();

    <span class="hljs-comment">// this loop waits for the answer</span>
    <span class="hljs-keyword">do</span>{
        <span class="hljs-keyword">if</span>(Serial.available() != <span class="hljs-number">0</span>){    
            response[x] = Serial.read();
            x++;
            <span class="hljs-comment">// check if the desired answer is in the response of the module</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(response, expected_answer1) != NULL)    
            {
                answer = <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-comment">// Waits for the asnwer with time out</span>
    }
    <span class="hljs-keyword">while</span>((answer == <span class="hljs-number">0</span>) &amp;&amp; ((millis() - previous) &lt; timeout));    

    <span class="hljs-keyword">return</span> answer;
}
    </pre>
	<div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div> 
	<p class="text-justify">Second step. When the GPS fix the GPS satellites, the GPRS+GPS shield will connect to the network and it will send the GPS data through the Internet to the php script in your computer.</p>	
	<div class="code cpp">
	<div class="code_tools">
    <button class="btn btn-info btn-xs">Show code</button>
		<div class="pull-left">Code:</div>
    </div>
    <pre style="display: none;"><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(!empty(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'latitude'</span><span style="color: #007700">])&nbsp;&amp;&amp;&nbsp;!empty(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'longitude'</span><span style="color: #007700">])&nbsp;&amp;&amp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!empty(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'time'</span><span style="color: #007700">])&nbsp;&amp;&amp;&nbsp;!empty(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'satellites'</span><span style="color: #007700">])&nbsp;&amp;&amp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!empty(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'speedOTG'</span><span style="color: #007700">])&nbsp;&amp;&amp;&nbsp;!empty(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'course'</span><span style="color: #007700">]))&nbsp;{<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">getParameter</span><span style="color: #007700">(</span><span style="color: #0000BB">$par</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$default&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isset(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #0000BB">$par</span><span style="color: #007700">])&nbsp;&amp;&amp;&nbsp;</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #0000BB">$par</span><span style="color: #007700">]))&nbsp;return&nbsp;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #0000BB">$par</span><span style="color: #007700">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;(isset(</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #0000BB">$par</span><span style="color: #007700">])&nbsp;&amp;&amp;&nbsp;</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #0000BB">$par</span><span style="color: #007700">]))&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #0000BB">$par</span><span style="color: #007700">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;return&nbsp;</span><span style="color: #0000BB">$default</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$file&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'gps.txt'</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$lat&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getParameter</span><span style="color: #007700">(</span><span style="color: #DD0000">"latitude"</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$lon&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getParameter</span><span style="color: #007700">(</span><span style="color: #DD0000">"longitude"</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$time&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getParameter</span><span style="color: #007700">(</span><span style="color: #DD0000">"time"</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$sat&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getParameter</span><span style="color: #007700">(</span><span style="color: #DD0000">"satellites"</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$speed&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getParameter</span><span style="color: #007700">(</span><span style="color: #DD0000">"speedOTG"</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$course&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getParameter</span><span style="color: #007700">(</span><span style="color: #DD0000">"course"</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$person&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$lat</span><span style="color: #007700">.</span><span style="color: #DD0000">","</span><span style="color: #007700">.</span><span style="color: #0000BB">$lon</span><span style="color: #007700">.</span><span style="color: #DD0000">","</span><span style="color: #007700">.</span><span style="color: #0000BB">$time</span><span style="color: #007700">.</span><span style="color: #DD0000">","</span><span style="color: #007700">.</span><span style="color: #0000BB">$sat</span><span style="color: #007700">.</span><span style="color: #DD0000">","</span><span style="color: #007700">.</span><span style="color: #0000BB">$speed</span><span style="color: #007700">.</span><span style="color: #DD0000">","</span><span style="color: #007700">.</span><span style="color: #0000BB">$course</span><span style="color: #007700">.</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA:\n<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Latitude:&nbsp;"</span><span style="color: #007700">.</span><span style="color: #0000BB">$lat</span><span style="color: #007700">.</span><span style="color: #DD0000">"\n<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Longitude:&nbsp;"</span><span style="color: #007700">.</span><span style="color: #0000BB">$lon</span><span style="color: #007700">.</span><span style="color: #DD0000">"\n<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time:&nbsp;"</span><span style="color: #007700">.</span><span style="color: #0000BB">$time</span><span style="color: #007700">.</span><span style="color: #DD0000">"\n<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Satellites:&nbsp;"</span><span style="color: #007700">.</span><span style="color: #0000BB">$sat</span><span style="color: #007700">.</span><span style="color: #DD0000">"\n<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Speed&nbsp;OTG:&nbsp;"</span><span style="color: #007700">.</span><span style="color: #0000BB">$speed</span><span style="color: #007700">.</span><span style="color: #DD0000">"\n<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Course:&nbsp;"</span><span style="color: #007700">.</span><span style="color: #0000BB">$course</span><span style="color: #007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #0000BB">file_put_contents</span><span style="color: #007700">(</span><span style="color: #0000BB">$file</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$person</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">FILE_APPEND&nbsp;</span><span style="color: #007700">|&nbsp;</span><span style="color: #0000BB">LOCK_EX</span><span style="color: #007700">))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"\n\t&nbsp;Error&nbsp;saving&nbsp;Data\n"</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;echo&nbsp;</span><span style="color: #DD0000">"\n\t&nbsp;Data&nbsp;Save\n"</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{<br><br></span><span style="color: #0000BB">?&gt;<br></span><br>&lt;!DOCTYPE&nbsp;html&gt;<br>&lt;html&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&lt;head&gt;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;Load&nbsp;Jquery&nbsp;--&gt;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;script&nbsp;language="JavaScript"&nbsp;type="text/javascript"&nbsp;src="jquery-1.10.1.min.js"&gt;&lt;/script&gt;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;Load&nbsp;Google&nbsp;Maps&nbsp;Api&nbsp;--&gt;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;IMPORTANT:&nbsp;change&nbsp;the&nbsp;API&nbsp;v3&nbsp;key&nbsp;--&gt;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;script&nbsp;src="http://maps.googleapis.com/maps/api/js?key=your_key&amp;sensor=false"&gt;&lt;/script&gt;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;Initialize&nbsp;Map&nbsp;and&nbsp;markers&nbsp;--&gt;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;script&nbsp;type="text/javascript"&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;myCenter=new&nbsp;google.maps.LatLng(41.669578,-0.907495);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;marker;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;map;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;mapProp;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;initialize()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mapProp&nbsp;=&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;center:myCenter,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zoom:15,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mapTypeId:google.maps.MapTypeId.ROADMAP<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setInterval('mark()',5000);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;mark()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map=new&nbsp;google.maps.Map(document.getElementById("googleMap"),mapProp);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;file&nbsp;=&nbsp;"gps.txt";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.get(file,&nbsp;function(txt)&nbsp;{&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;lines&nbsp;=&nbsp;txt.split("\n");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;i=0;i&lt;lines.length;i++){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(lines[i]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;words=lines[i].split(",");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((words[0]!="")&amp;&amp;(words[1]!=""))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;marker=new&nbsp;google.maps.Marker({<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;position:new&nbsp;google.maps.LatLng(words[0],words[1]),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;marker.setMap(map);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.setCenter(new&nbsp;google.maps.LatLng(words[0],words[1]));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById('sat').innerHTML=words[3];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById('speed').innerHTML=words[4];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById('course').innerHTML=words[5];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;marker.setAnimation(google.maps.Animation.BOUNCE);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;google.maps.event.addDomListener(window,&nbsp;'load',&nbsp;initialize);<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/script&gt;<br>&lt;/head&gt;<br><br>&lt;body&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">'&nbsp;&nbsp;&nbsp;&nbsp;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;Draw&nbsp;information&nbsp;table&nbsp;and&nbsp;Google&nbsp;Maps&nbsp;div&nbsp;--&gt;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;center&gt;&lt;br&nbsp;/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;&nbsp;SIM908&nbsp;GPS&nbsp;position&nbsp;DEMO&nbsp;&lt;/b&gt;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id="superior"&nbsp;style="width:800px;border:1px&nbsp;solid"&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&nbsp;style="width:100%"&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;Time&lt;/td&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;Satellites&lt;/td&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;Speed&nbsp;OTG&lt;/td&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;Course&lt;/td&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;id="time"&gt;'</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">date</span><span style="color: #007700">(</span><span style="color: #DD0000">"Y&nbsp;M&nbsp;d&nbsp;-&nbsp;H:m"</span><span style="color: #007700">)&nbsp;.</span><span style="color: #DD0000">'&lt;/td&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;id="sat"&gt;&lt;/td&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;id="speed"&gt;&lt;/td&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;id="course"&gt;&lt;/td&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id="googleMap"&nbsp;style="width:800px;height:700px;"&gt;&lt;/div&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/center&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;'</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">?&gt;<br></span>&lt;/body&gt;<br>&lt;/html&gt;<br><br><span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">}&nbsp;</span><span style="color: #0000BB">?&gt;</span>
</span>
    </pre>
	<div class="code_tools_bottom"><a class="btn btn-info btn-xs action_all">Select all</a>&nbsp;&nbsp;</div></div> 
	<p class="text-justify">To use the php script you need an Apache server with php active. You can run the script in a PC installing Apache with php. You can do this easily with the installer from this pages ( or the package manger for linux):</p>
    <ul>
        <li>For Windows use WAMP: <a href="http://www.wampserver.com/" target="_blank">http://www.wampserver.com/</a></li>
        <li>For Linux use LAMP: Use your package manager in linux</li>
        <li>For Mac use MAMP: <a href="http://www.mamp.info/" target="_blank">http://www.mamp.info/</a></li>
    </ul>	
    <p class="text-justify">In these websites, you have manuals to help you to install the server and active the php.</p>
    <p class="text-justify">Extract the next php script on your computer. When a frame is received, a marker will shown in the map. You must change the Google Maps API v3 key in the php script: "http://maps.googleapis.com/maps/api/js?key=<strong>your_key</strong>&amp;sensor=false"</p>
	<p class="text-justify">To show the map with the marker you need to access to the next url:</p>
	<p class="text-justify"><strong>http://your_IP_or_domain/demo_sim908.php</strong></p>
	<p class="text-justify">The IP address or server domain must be the same used in the skecth of arduino (In case you are running the demo on your computer, replace "your_IP_or_domain" by "localhost")</p>
	<a href="http://www.cooking-hacks.com/media/cooking/images/documentation/tutorial-sim-908/demo-files.zip" class="alert-link" target="_blank">Download Demo files</a>   
	<div class="row">
		<div class="col-xs-12 col-md-6">
		<a id="img_8" href="https://www.cooking-hacks.com/media/cooking/images/documentation/tutorial-sim-908/sim908_1_big.png" class="lb_photo " rel="set_1" title=""><img class="img-responsive center-block lb" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/sim908_1_small.png"></a>	
		</div>
		<div class="col-xs-12 col-md-6">
		<a id="img_9" href="https://www.cooking-hacks.com/media/cooking/images/documentation/tutorial-sim-908/sim908_2_big.png" class="lb_photo " rel="set_1" title=""><img class="img-responsive center-block lb" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/sim908_2_small.png"></a>	
		</div>
	</div>	
	
</div>

<!-- ############## CHOOSING THE RIGHT CELLULAR MODULE POR ARDUINO AND RASPBERRY PI ############## -->
<div class="section_title">
	<h2><a name="celular" class="ancla"></a>Choosing the right cellular module for Arduino and Raspberry Pi: 4G / 3G / GPRS / GSM <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#index" class="pull-right goto">Go to index <span class="glyphicon glyphicon-arrow-up"></span></a></h2>
	<div class="col-xs-12 col-md-12 vcenter">
		<table class="table table-bordered table-hover table-bordered">					 
			<tbody><tr>
			  <td><strong><center>Model</center></strong></td>
			  <td><strong><center>Protocols</center></strong></td>
			  <td><strong><center>Frequency Bands</center></strong></td>
			  <td><strong><center>Certifications</center></strong></td>
			  <td><strong><center>Market</center></strong></td>
			</tr>
			<tr>
			  <td><a href="https://www.cooking-hacks.com/gprs-gps-quadband-module-for-arduino-sim908" target="_blank">SIM908</a></td>						
			  <td>GPRS / GSM</td>
			  <td>850, 900, 1800, 1900MHz</td>
			  <td>CE</td>
			  <td>Europe</td>
			</tr>	
			<tr>
			  <td><a href="https://www.cooking-hacks.com/3g-gprs-shield-for-arduino-3g-gps" target="_blank">SIM5215-E</a></td>						
			  <td>3G / GPRS / GSM</td>
			  <td>850, 900, 1800, 2100MHz</td>
			  <td>CE, GCF</td>
			  <td>Europe</td>
			</tr>	
			<tr>
			  <td><a href="https://www.cooking-hacks.com/3g-gprs-shield-for-arduino-3g-gps" target="_blank">SIM5215-A</a></td>						
			  <td>3G / GPRS / GSM</td>
			  <td>850, 900, 1800, 1900MHz</td>
			  <td>FCC, IC, PTCRB</td>
			  <td>US / Canada</td>
			</tr>	
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-EU</a></td>						
			  <td>4G / 3G / GPRS / GSM / WCDMA / HSPA+ / LTE</td>
			  <td>850, 900, 1800, 2100, 2600MHz</td>
			  <td>CE, GCF, ANATEL</td>
			  <td>Europe / Brasil</td>
			</tr>	
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-NAG</a></td>						
			  <td>4G / 3G / GPRS / GSM / WCDMA / HSPA+ / LTE</td>
			  <td>700, 850, 900, 1700, 1900MHz</td>
			  <td>FCC, IC, PTCRB, AT&amp;T Compliant</td>
			  <td>US / Canada</td>
			</tr>	
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-SKG</a></td>						
			  <td>4G / LTE / HSPA+</td>
			  <td>850, 1800MHz</td>
			  <td>KCC</td>
			  <td>South Korea</td>
			</tr>	
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-AU V2</a></td>						
			  <td>4G / LTE / HSPA+</td>
			  <td>850, 1500, 2100MHz</td>
			  <td>RCM</td>
			  <td>Australia</td>
			</tr>
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-JN V2</a></td>						
			  <td>4G / LTE / HSPA+</td>
			  <td>850, 1500, 2100MHz</td>
			  <td>NTT DoCoMo</td>
			  <td>Japan</td>
			</tr>
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-JK V2</a></td>						
			  <td>4G / LTE / HSPA+</td>
			  <td>850, 1500, 2100MHz</td>
			  <td>KDDi</td>
			  <td>Japan</td>
			</tr>			
		</tbody></table>
	</div>	
	<div class="col-xs-12 col-md-12 vcenter">
		<table class="table table-bordered table-hover table-bordered">					 
			<tbody><tr>
			  <td><strong><center>Model</center></strong></td>
			  <td><strong><center>GPS</center></strong></td>
			  <td><strong><center>Camera Option</center></strong></td>
			  <td><strong><center>SD Card</center></strong></td>
			  <td><strong><center>USB Connnectivity</center></strong></td>
			</tr>
			<tr>
			  <td><a href="https://www.cooking-hacks.com/gprs-gps-quadband-module-for-arduino-sim908" target="_blank">SIM908</a></td>						
			  <td><center>Yes</center></td>
			  <td><center>No</center></td>
			  <td><center>No</center></td>
			  <td><center>No</center></td>
			</tr>	
			<tr>
			  <td><a href="https://www.cooking-hacks.com/3g-gprs-shield-for-arduino-3g-gps" target="_blank">SIM5215-E</a></td>						
			  <td><center>No</center></td>
			  <td><center>Yes</center></td>
			  <td><center>Yes</center></td>
			  <td><center>Yes</center></td>
			</tr>	
			<tr>
			  <td><a href="https://www.cooking-hacks.com/3g-gprs-shield-for-arduino-3g-gps" target="_blank">SIM5215-A</a></td>						
			  <td><center>No</center></td>
			  <td><center>Yes</center></td>
			  <td><center>Yes</center></td>
			  <td><center>Yes</center></td>
			</tr>	
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-EU</a></td>							
			  <td><center>Yes</center></td>
			  <td><center>No</center></td>
			  <td><center>Yes</center></td>
			  <td><center>Yes</center></td>
			</tr>	
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-NAG</a></td>						
			  <td><center>Yes</center></td>
			  <td><center>No</center></td>
			  <td><center>Yes</center></td>
			  <td><center>Yes</center></td>
			</tr>	
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-SKG</a></td>						
			  <td><center>Yes</center></td>
			  <td><center>No</center></td>
			  <td><center>Yes</center></td>
			  <td><center>Yes</center></td>
			</tr>	
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-AU V2</a></td>						
			  <td><center>Yes</center></td>
			  <td><center>No</center></td>
			  <td><center>Yes</center></td>
			  <td><center>Yes</center></td>
			</tr>
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-JN V2</a></td>						
			  <td><center>Yes</center></td>
			  <td><center>No</center></td>
			  <td><center>Yes</center></td>
			  <td><center>Yes</center></td>
			</tr>
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-JK V2</a></td>						
			  <td><center>Yes</center></td>
			  <td><center>No</center></td>
			  <td><center>Yes</center></td>
			  <td><center>Yes</center></td>
			</tr>			
		</tbody></table>
	</div>	
	<div class="col-xs-12 col-md-12 vcenter">
		<table class="table table-bordered table-hover table-bordered">					 
			<tbody><tr>
			  <td><strong><center>Model</center></strong></td>
			  <td><strong><center>Download Max Speed</center></strong></td>
			  <td><strong><center>Upload Max Speed</center></strong></td>
			  <td><strong><center>Antenna Diversity</center></strong></td>
			  <td><strong><center>Cellular Carriers</center></strong></td>
			</tr>
			<tr>
			  <td><a href="https://www.cooking-hacks.com/gprs-gps-quadband-module-for-arduino-sim908" target="_blank">SIM908</a></td>						
			  <td><center>80kbps</center></td>
			  <td><center>20kbps</center></td>
			  <td><center>No</center></td>
			  <td><center>Any</center></td>
			</tr>	
			<tr>
			  <td><a href="https://www.cooking-hacks.com/3g-gprs-shield-for-arduino-3g-gps" target="_blank">SIM5215-E</a></td>						
			  <td><center>384Kbps </center></td>
			  <td><center>384Kbps </center></td>
			  <td><center>No</center></td>
			  <td><center>Any</center></td>
			</tr>	
			<tr>
			  <td><a href="https://www.cooking-hacks.com/3g-gprs-shield-for-arduino-3g-gps" target="_blank">SIM5215-A</a></td>						
			  <td><center>384Kbps </center></td>
			  <td><center>384Kbps </center></td>
			  <td><center>No</center></td>
			  <td><center>Any</center></td>
			</tr>	
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-EU</a></td>							
			  <td><center>100Mbps</center></td>
			  <td><center>50Mbps</center></td>
			  <td><center>Yes</center></td>
			  <td><center>Any</center></td>
			</tr>	
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-NAG</a></td>							
			  <td><center>100Mbps</center></td>
			  <td><center>50Mbps</center></td>
			  <td><center>Yes</center></td>
			  <td><center>Any + Specially tested with AT&amp;T</center></td>
			</tr>	
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-SKG</a></td>						
			  <td><center>100Mbps</center></td>
			  <td><center>50Mbps</center></td>
			  <td><center>Yes</center></td>
			  <td><center>Any + Specially tested with SK Telecom</center></td>
			</tr>	
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-AU V2</a></td>						
			  <td><center>100Mbps</center></td>
			  <td><center>50Mbps</center></td>
			  <td><center>Yes</center></td>
			  <td><center>Any + Specially tested with Telstra</center></td>
			</tr>
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-JN V2</a></td>						
			  <td><center>100Mbps</center></td>
			  <td><center>50Mbps</center></td>
			  <td><center>Yes</center></td>
			  <td><center>Any + Specially tested with NTT DoCoMo</center></td>
			</tr>
			<tr>
			  <td><a href="http://www.cooking-hacks.com/4g-gps-3g-gprs-gsm-gps-lte-wcdma-hspa-shield-for-arduino/" target="_blank">LE910-JK V2</a></td>						
			  <td><center>100Mbps</center></td>
			  <td><center>50Mbps</center></td>
			  <td><center>Yes</center></td>
			  <td><center>Any + Specially tested with KDDi</center></td>
			</tr>			
		</tbody></table>
	</div>
 
</div>

<!-- ############## DEVICE COMPATIBILITY ############## -->
<div class="section_title">
	<h2><a name="compatibility" class="ancla"></a>Device Compatibility <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#index" class="pull-right goto">Go to index <span class="glyphicon glyphicon-arrow-up"></span></a></h2>
	This shield is tested and fully compatible with the following boards:
	<h3>Arduino Boards</h3>
	<ul>
		<li>Arduino Uno</li>
	</ul>
	<h3>Raspberry Pi Boards</h3>
	<ul>
		<li>Raspberry Pi</li>
		<li>Raspberry Pi (Model B+)</li>
		<li>Raspberry Pi 2</li>
		<li>Raspberry Pi 3</li>
	</ul>
</div> 

<!-- ############## Documentation ############## -->
<div class="section_title">
	<h2><a name="documentation" class="ancla"></a>Documentation <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#index" class="pull-right goto">Go to index <span class="glyphicon glyphicon-arrow-up"></span></a></h2>
    <ul>
        <li><a href="https://www.cooking-hacks.com/media/cooking/images/documentation/tutorial-sim-908/Schematic.pdf" target="_blank">Schematic of the shield</a></li>
        <li><a href="https://www.cooking-hacks.com/media/cooking/images/documentation/tutorial-sim-908/SIM908_AT_Command_Manual_V1.02.pdf" target="_blank">AT command manual</a></li>
        <li><a href="https://www.cooking-hacks.com/media/cooking/images/documentation/tutorial-sim-908/SIM908_Specification.pdf" target="_blank">SIM908 Module Info</a></li>
    </ul>	
</div>

<!-- ############## Get the Shields ############## -->
<div class="section_title">
	<h2><a name="get-the-shields" class="ancla"></a>Get the Shields <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#index" class="pull-right goto">Go to index <span class="glyphicon glyphicon-arrow-up"></span></a></h2>
	   <ul>
        <li>
            <a href="http://www.cooking-hacks.com/index.php/gprs-gps-quadband-module-for-arduino-sim908.html" target="_blank">GPRS+GPS Quadband Module for Arduino (SIM908)</a>
        </li>
        <li>
            <a href="http://www.cooking-hacks.com/index.php/gprs-gps-quadband-shield-for-raspberry-pi-sim908.html" target="_blank">
                GPRS+GPS Quadband Shield for Raspberry Pi (SIM908) 
            </a>
        </li>
    </ul>
</div>
	<br><br>
	<div class="row">
		<div class="col-xs-12 col-md-6 vcenter">
		<script type="text/javascript">
var addthis_config = {
     pubid: "ra-550b04b6022f544d",
     "data_track_addressbar":false
}

var addthis_share = {
     url_transforms : {
          shorten: {
               twitter: 'bitly'
          }
     }, 
     shorteners : {
          bitly : {} 
     }
}
</script>

<div class="addthis_toolbox addthis_default_style addthis_default_style">
<a class="addthis_button_facebook_like at300b" fb:like:layout="button_count"><div class="fb-like fb_iframe_widget" data-layout="button_count" data-show_faces="false" data-share="true" data-action="like" data-width="90" data-height="25" data-font="arial" data-href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi" data-send="false" style="height: 25px;" fb-xfbml-state="rendered" fb-iframe-plugin-query="action=like&amp;app_id=172525162793917&amp;container_width=125&amp;font=arial&amp;height=25&amp;href=https%3A%2F%2Fwww.cooking-hacks.com%2Fdocumentation%2Ftutorials%2Fgeolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;send=false&amp;share=true&amp;show_faces=false&amp;width=90"><span style="vertical-align: bottom; width: 125px; height: 20px;"><iframe name="f2dc3d26c3af95c" width="90px" height="25px" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" title="fb:like Facebook Social Plugin" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/like(1).html" style="border: none; visibility: visible; width: 125px; height: 20px;" class=""></iframe></span></div></a>
<a class="addthis_button_tweet at300b"><div class="tweet_iframe_widget" style="width: 62px; height: 25px;"><span><iframe title="AddThis | Twitter" frameborder="0" role="presentation" scrolling="no" allowtransparency="true" scrollbars="no" style="width:62px; height:25px;" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/tweet(1).html"></iframe></span></div></a>
<a class="addthis_button_twitter addthis_button_preferred_1 at300b" title="Twitter" href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#"><span class="at-icon-wrapper" style="background-color: rgb(29, 161, 242); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" title="Twitter" alt="Twitter" class="at-icon at-icon-twitter" style="width: 16px; height: 16px;"><g><path d="M27.996 10.116c-.81.36-1.68.602-2.592.71a4.526 4.526 0 0 0 1.984-2.496 9.037 9.037 0 0 1-2.866 1.095 4.513 4.513 0 0 0-7.69 4.116 12.81 12.81 0 0 1-9.3-4.715 4.49 4.49 0 0 0-.612 2.27 4.51 4.51 0 0 0 2.008 3.755 4.495 4.495 0 0 1-2.044-.564v.057a4.515 4.515 0 0 0 3.62 4.425 4.52 4.52 0 0 1-2.04.077 4.517 4.517 0 0 0 4.217 3.134 9.055 9.055 0 0 1-5.604 1.93A9.18 9.18 0 0 1 6 23.85a12.773 12.773 0 0 0 6.918 2.027c8.3 0 12.84-6.876 12.84-12.84 0-.195-.005-.39-.014-.583a9.172 9.172 0 0 0 2.252-2.336" fill-rule="evenodd"></path></g></svg></span></a>
<a class="addthis_button_facebook addthis_button_preferred_2 at300b" title="Facebook" href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#"><span class="at-icon-wrapper" style="background-color: rgb(59, 89, 152); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" title="Facebook" alt="Facebook" class="at-icon at-icon-facebook" style="width: 16px; height: 16px;"><g><path d="M22 5.16c-.406-.054-1.806-.16-3.43-.16-3.4 0-5.733 1.825-5.733 5.17v2.882H9v3.913h3.837V27h4.604V16.965h3.823l.587-3.913h-4.41v-2.5c0-1.123.347-1.903 2.198-1.903H22V5.16z" fill-rule="evenodd"></path></g></svg></span></a>
<a class="addthis_button_youtube addthis_button_preferred_3 at300b" target="_blank" title="YouTube" href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#"><span class="at-icon-wrapper" style="background-color: rgb(205, 32, 31); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" title="YouTube" alt="YouTube" class="at-icon at-icon-youtube" style="width: 16px; height: 16px;"><g><path d="M13.73 18.974V12.57l5.945 3.212-5.944 3.192zm12.18-9.778c-.837-.908-1.775-.912-2.205-.965C20.625 8 16.007 8 16.007 8c-.01 0-4.628 0-7.708.23-.43.054-1.368.058-2.205.966-.66.692-.875 2.263-.875 2.263S5 13.303 5 15.15v1.728c0 1.845.22 3.69.22 3.69s.215 1.57.875 2.262c.837.908 1.936.88 2.426.975 1.76.175 7.482.23 7.482.15 0 .08 4.624.072 7.703-.16.43-.052 1.368-.057 2.205-.965.66-.69.875-2.262.875-2.262s.22-1.845.22-3.69v-1.73c0-1.844-.22-3.69-.22-3.69s-.215-1.57-.875-2.262z" fill-rule="evenodd"></path></g></svg></span></a>
<a class="addthis_button_print addthis_button_preferred_4 at300b" title="Print" href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#"><span class="at-icon-wrapper" style="background-color: rgb(115, 138, 141); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" title="Print" alt="Print" class="at-icon at-icon-print" style="width: 16px; height: 16px;"><g><path d="M24.67 10.62h-2.86V7.49H10.82v3.12H7.95c-.5 0-.9.4-.9.9v7.66h3.77v1.31L15 24.66h6.81v-5.44h3.77v-7.7c-.01-.5-.41-.9-.91-.9zM11.88 8.56h8.86v2.06h-8.86V8.56zm10.98 9.18h-1.05v-2.1h-1.06v7.96H16.4c-1.58 0-.82-3.74-.82-3.74s-3.65.89-3.69-.78v-3.43h-1.06v2.06H9.77v-3.58h13.09v3.61zm.75-4.91c-.4 0-.72-.32-.72-.72s.32-.72.72-.72c.4 0 .72.32.72.72s-.32.72-.72.72zm-4.12 2.96h-6.1v1.06h6.1v-1.06zm-6.11 3.15h6.1v-1.06h-6.1v1.06z"></path></g></svg></span></a>
<a class="addthis_button_compact at300m" href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#"><span class="at-icon-wrapper" style="background-color: rgb(255, 101, 80); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" title="More" alt="More" class="at-icon at-icon-addthis" style="width: 16px; height: 16px;"><g><path d="M18 14V8h-4v6H8v4h6v6h4v-6h6v-4h-6z" fill-rule="evenodd"></path></g></svg></span></a>
<div class="atclear"></div></div>

<script type="text/javascript" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/addthis_widget.js.tải xuống"></script>
		</div>
		<div class="col-xs-12 col-md-6 vcenter">
			<a href="http://www.cooking-hacks.com/gprs-gps-quadband-module-for-arduino-sim908" class="btn btn-danger pull-right">Buy now <span class="glyphicon glyphicon-shopping-cart"></span></a>
		</div>				
	</div> 
	<br><br>
	<div class="alert alert-warning alert-waspmote-note">


    <div style="float:left; width:69%;">
        <div style="padding-bottom:10px;"><strong><a class="title_note_waspmote" href="http://www.libelium.com/products/waspmote/">Waspmote - The Open Source Sensor Platform</a></strong></div>
        <p class="text-justify">If you are interested in <strong>Internet of Things (IoT) or M2M</strong> projects check our open
        source sensor platform <a class="" href="http://www.libelium.com/products/waspmote/">Waspmote</a>
        which counts with more than <strong>100 sensors</strong> available to use 'off the shelf', a complete <strong>API</strong> with hundreds of ready to use codes and a low consumption mode of just <strong>0.7µA</strong> to ensure years of battery life.</p>
        <p class="text-justify">Know more at:
        </p><ul>
            <li><a class="" href="http://www.libelium.com/waspmote">Waspmote Product Page (Libelium)</a></li>
            <li><a class="" href="https://www.cooking-hacks.com/documentation/tutorials/waspmote/">Waspmote Summary Page (Cooking Hacks)</a></li>
        </ul><p class="text-justify"></p>
		<p class="text-justify">Get the Starter Kits at:
		</p><ul>
		<li><a class="" href="https://www.cooking-hacks.com/shop/waspmote">Waspmote Starter Kits</a></li>
		</ul>
		<p class="text-justify"></p>
    </div>
    <div style="float:left; width:31%;">
        <img src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/waspmote_in_hands.png">
    </div>	
</div>
	


</div>

        <!-- ############## FIN DE TUTORIAL ############## --></div>                                      	                        
							</div>
						</div>
						
												
					</div>
				</div>
             </div>
         </div>      
        <!-- END: content -->
        
        <!-- BEGIN: footer -->
        <div id="yt_footer" class="yt-footer wrap">
        	<div class="yt-footer-wrap">
	<div class="yt-footer-top">
		<div class="container">
			<div class="row">
				<div class="col-md-5 col-sm-5 col-xs-12 contact-payment-footer">
										<h2 class="footer-logo"><img src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/logo-footer.1441867835.png"></h2>
					<div class="block-ft footer-contact">
<div class="content-block-footer">
<p>Cooking Hacks makes electronics affordable, easy to learn and fun.</p>
<p>The e-commerce for worldwide community of developers, designers, inventors and makers who love creating electronics with sensors, robotics, Arduino and Raspberry Pi. </p>

<p>&nbsp;</p>
<p>Cooking Hacks is a brand by <a class="link_footer_libelium" href="http://www.libelium.com/">Libelium</a>.</p></div>
</div>
<div class="payment_footer_logos">
<img src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/payment_footer.png" alt="payment_footer_logos">
</div>
<div class="block-ft footer-payment">
<div class="footer-title">
<h2>Payment Method</h2>
</div>
<div class="content-block-footer"><label class="des-footer"><p>We are using secure Paypal and Credit Card (VISA - MasterCard) payment method. You can pay also via wire transfer - we will prepare your order after the payment reception.</p>
<p>&nbsp;</p>
<p>We NEVER store your card information on our site.</p></label>
<!--<ul class="payment-item">
<li class="item"><img src="https://www.cooking-hacks.com/media/cooking/wysiwyg/paypal-icon.1441867457.png" alt="Payment" /></li>
<li class="item"><img src="https://www.cooking-hacks.com/media/cooking/wysiwyg/visa-icon.1441867457.png" alt="Payment" /></li>
</ul>-->
</div>
</div>	
				</div>
				
				<div class="col-md-7 col-sm-7 col-xs-12 footer-link-block">
					<!--<div class="row row-1">-->
					<div class="row">
						<div class="col-lg-4 col-md-4 col-xs-4">
							<div class="block-ft footer-contact">
<div class="footer-title">
<h2>Follow Us</h2>
</div>
<div class="content-block-footer">
<ul class="right-footer-link social-footer-links">
<li class="item rs-item"><a title="CookingHacks Blog" href="http://www.cooking-hacks.com/blog">Our Blog</a></li>
<li class="item fb-item"><a title="Follow us on Facebook" href="http://www.facebook.com/pages/Cooking-Hacks/161797590502410">Follow us on Facebook</a></li>
<li class="item tw-item"><a title="Follow us on Twitter" href="http://twitter.com/Cooking_Hacks">Follow us on Twitter</a></li>
<li class="item yt-item"><a title="Follow us on YouTube" href="https://www.youtube.com/user/cookinghacks/feed?activity_view=3">Follow us on YouTube</a></li>
<li class="item ig-item"><a title="Follow us on Instagram" href="http://instagram.com/cookinghacks">Follow us on Instagram</a></li>
</ul>
</div>
</div>						</div>
						<div class="col-lg-4 col-md-4 col-xs-4">
                            <div class="block-ft footer-contact">
<div class="footer-title">
<h2>Customer Service</h2>
</div>
<div class="content-block-footer">
<ul class="right-footer-link">
<li class="item"><a title="Payment" href="https://www.cooking-hacks.com/customer-service#payment">Payment</a></li>
<li class="item"><a title="Shipping Policy" href="https://www.cooking-hacks.com/customer-service#shipping_policy">Shipping Policy</a></li>
<li class="item"><a title="Free Shipping" href="https://www.cooking-hacks.com/customer-service#free_shipping">Free Shipping</a></li>
<li class="item"><a title="Warranty" href="https://www.cooking-hacks.com/customer-service#warranty">Warranty</a></li>
<li class="item"><a title="Contact Us" href="https://www.cooking-hacks.com/contact">Contact Us</a></li>
</ul>
</div>
</div>						</div>
						<div class="col-lg-4 col-md-4 col-xs-4">
                            <div class="block-ft footer-contact">
                                <div class="footer-title">
                                    <h2>My Account</h2>
                                </div>
                                <div class="content-block-footer">
                                    <ul class="right-footer-link">
                                        <li class="item">
                                                                                            <a href="https://www.cooking-hacks.com/customer/account/login/" title="Login">Login</a>
                                            
                                                                                    </li>

                                    </ul>
                                    <ul class="right-footer-link">
<li class="item"><a title="View Cart" href="https://www.cooking-hacks.com/checkout/cart/">View Cart</a></li>
<li class="item"><a title="Check out" href="https://www.cooking-hacks.com/checkout/onepage/">Check out</a></li>
<!--<li class="item"><a title="Track My Order" href="#">Track My Order</a></li>-->
</ul>                                </div>
                            </div>
						</div>
                    </div>
					<!--</div>-->

                    <div class="row form-inline footer_newsletter">
    <div class="col-lg-12 col-md-12 col-xs-12 account-links-ft">
        <div class="footer-title">
            <h2>Subscribe to Our Newsletter</h2>
        </div>
        <div>
            <form action="https://www.cooking-hacks.com/sendy/index/subscribe/" method="post" id="newsletter-validate-detail">
                <div class="form-group">
                    <input type="email" autocapitalize="off" autocorrect="off" spellcheck="false" name="email" id="newsletter" placeholder="Email address" class="form-control input-text required-entry validate-email">
                    <input name="form_key" type="hidden" value="eb1Mi1exPPb0fSNp">
                </div>
                <button type="submit" class="btn btn-default" id="submit-btn">Subscribe</button>
                <div class="privacy-policy-message">
                    <p>
                        <input type="checkbox" name="privacy-accept" id="privacy-policy-accept" value="1"> I have read and I accept the <a href="https://www.cooking-hacks.com/documentation/tutorials/geolocation-tracker-gprs-gps-geoposition-sim908-arduino-raspberry-pi#privacy-policy" id="modal-privacy-policy">privacy policy(*)</a>
                    </p>
                </div>

            </form>
            <div id="privacy-policy" class="privacy-policy-content" style="display: none">
                <p>In order to comply with the provisions in Spanish Data Protection Act (L.O. 15/1999 of 13th December) and its implementing Regulation (R.D. 1720/2007, of 21st December), LIBELIUM hereby informs its Customers and websites users that any personal data supplied through the forms contained in its websites shall be recorded in a file named “CUSTOMERS” for which LIBELIUM is responsible, located at LIBELIUM´s registered address and which has been registered with the Spanish General Registry for Data Protection (Registro General de Protección de Datos de la Agencia Española de Protección de Datos).</p>

<p>Except for those fields expressly requesting compulsory filling, answers to the questions contained in any form are voluntary and therefore, the lack of answer does not imply a reduction of the quantity or quality of LIBELIUM´s services. The aim of this data collection are to provide access to LIBELIUM´s online shop, to send information on LIBELIUM´s Product(s) and services as well as to collect Customer’s acceptance to the terms of use of the forums and other sections in LIBELIUM´s websites. By filling these forms Customers consent in receiving promotional offers concerning LIBELIUM´s Product(s) and services. You further consent further that LIBELIUM may make such data available to its services suppliers to the sole purpose of enabling service provision.</p>

<p>Any User providing personal data through any of the forms in LIBELIUM´s websites shall count on a 30 day period to inform LIBELIUM in writing of his/her refusal to the processing of his/her personal data. Unless this communication is made, it shall be deemed that the User consents the processing of his/her personal data according to the terms set forth in these T&amp;C. All personal data collected shall be processed by using the security measures requested by Law to avoid their loss, damage or access by any unauthorised third party. User may nevertheless be aware of the fact that the existing security measures for computer systems on the Internet are not entirely trustworthy. Should you think that your email address has been disclosed to us without your consent, do not hesitate to inform us thereof. Users may at any time exercise their rights of access, rectification, update, cancellation and objection, as well as revoke the consent granted for all of any of the above-mentioned processings, by sending a written statement to LIBELIUM, either through the “Contact” section in our website http://www.libelium.com or by post to the following address: LIBELIUM COMUNICACIONES DISTRIBUIDAS, S.L., C/ Escatrón 16 (Edificio LIBELIUM) C.P: 50014 Zaragoza (Spain).</p>

<p>To exercise the above-mentioned rights you must indicate your name, ID/passport number, full address, date and signature, including any document supporting your request, in case it is needed; a copy of your ID card/passport must be enclosed, unless you use an electronic signature. User shall be liable for the veracity of data provided and only in case of holders of parental rights concerning children under fourteen and in connection with said children, shall LIBELIUM accept the disclosure of personal data concerning third parties. Users shall assume all liability for direct or consequential damages arising out of or in connection with the provision of false, inaccurate, incomplete or non updated data.</p>

<p>Furthermore, LIBELIUM reserves its right to exclude from any service for which prior registration is required, to any User having provided false data or failing to comply with these T&amp;C, notwithstanding any other legal action to which LIBELIUM may be entitled. LIBELIUM reserves its right to modify its Privacy Policy or these T&amp;C to adapt them to the regulations in force or for any other reason. Provided that the use of LIBELIUM´s websites by Users shall be deemed as User’s acceptance of LIBELIUM´s Privacy Policy and T&amp;C, User is hereby requested to check these T&amp;C and any further amendments from time to time.</p>

<p>
<strong>Privacy Policy</strong><br>
Users may visit LIBELIUM´s websites without disclosing neither their identity nor any personal data. LIBELIUM´s servers may only collect domain names but not email addresses of their visitors. This kind of information is used to elaborate reports on visit statistics, the time spent in the websites, websites accessed, the general origin of visitors (through “Favourites”, search engines, links from other websites, etc.) to the sole purposes of getting information on how the websites are used and improving their contents and services.</p>

<p>
<strong>Linked sites</strong>
LIBELIUM´s websites may provide links to other sites but LIBELIUM assumes no liability on the privacy policies adopted by the linked sites, directly or indirectly. Links to other sites are provided as a suggestion only and do not imply LIBELIUM´s warranty or liability concerning their quality, accuracy or contents of the information provided therein.
</p>
<p>LIBELIUM does not warrant the veracity or accuracy of the information disclosed by its suppliers or third parties whose products or services are offered through LIBELIUM, their origin, ownership or the use or practical implementation made by Customers.</p>            </div>
            <div id="newsletter_status"></div>
        </div>
    </div>
</div>
					
					<div class="copyright">
						<address><div style="float:left; width:40%;">

<a href="http://www.libelium.com/">
	<img src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/logo_libelium_footer.png" alt="logo_libelium_footer" border="0" style="padding-top: 5px; padding-bottom:20px;">
</a>

</div>

<div style="width:60%; float:left; padding-top:58px;">© Libelium Comunicaciones Distribuidas S.L. | <a href="http://www.libelium.com/legal">Terms of Sale and Use</a></div>

</address>
					</div>
				</div>
			
			</div>
		</div>
	</div>
</div>       
			
        </div>
        <!-- END: footer -->        
        
		    <script>
    /* <![CDATA[ */
    var google_tag_params = {
                ecomm_prodid: '',
                ecomm_pagetype: 'other',
                                ecomm_totalvalue: ''            };
    /* ]]> */
</script>
<script>
    /* <![CDATA[ */
    var google_conversion_id = 935987628;
        var google_conversion_label = "Remarketing";
        var google_custom_params = window.google_tag_params;
    var google_remarketing_only = true;
    /* ]]> */
</script>
<script src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/conversion.js.tải xuống"></script><iframe name="google_conversion_frame" title="Google conversion frame" width="300" height="13" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/saved_resource.html" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no"></iframe>
<noscript>
    &lt;div style="display:inline;"&gt;
        &lt;img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/935987628/?value=0&amp;amp;label=Remarketing&amp;amp;guid=ON&amp;amp;script=0"/&gt;
    &lt;/div&gt;
</noscript>
<script type="text/javascript">
//<![CDATA[
	window.removeItem=function(args){ //for version mage1501 and later
		if (enable_ajax_compare && (args.search('catalog/product_compare/remove') != -1) ){
				opener.deletePCompare=1;
				if(setfocus){				// for win parent  , detect by var setfocus
					
					opener.isCompare=1;
					opener.deletePCompare=1;

					opener.focus();
					opener.ajaxUpdate(args,'url');
					exit;
				}
				else
					ajaxUpdate(args,'url');		//for win-popup
		}
        else
        {
            window.location.href = args;
        }	
	};
//]]>
</script>
            <div id="v-cookielaw" class="v-bar v-dark-clean v-bottom">
    <div class="v-message">
        This site uses cookies. By clicking the "Accept" button you are agreeing to our use of cookies.     </div>
    <div class="v-actions">
        <a href="javascript:cookieLawAccept();" class="v-button v-accept">
            Accept        </a>
        <a href="https://www.cooking-hacks.com/privacy-policy-cookie-restriction-mode/" class="v-button">
            Read More        </a>
    </div>
</div>
<script type="text/javascript">
    function cookieLawAccept() {
        var d = null;
        if (365) {
            d = new Date();
            d.setTime(d.getTime() + (365 * 24 * 60 * 60 * 1000));
        }
        Mage.Cookies.set('cookielaw', '1', d);
        document.getElementById('v-cookielaw').style.display = 'none';
    }

    if (!Mage.Cookies.get('cookielaw')) document.getElementById('v-cookielaw').style.display = '';

    </script>
            <script type="text/javascript">
setTimeout(function(){var a=document.createElement("script");
var b=document.getElementsByTagName("script")[0];
a.src=document.location.protocol+"//dnn506yrbagrg.cloudfront.net/pages/scripts/0022/7966.js?"+Math.floor(new Date().getTime()/3600000);
a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
</script>    </div><div id="_atssh" style="visibility: hidden; height: 1px; width: 1px; position: absolute; top: -9999px; z-index: 100000;"><iframe id="_atssh965" title="AddThis utility frame" style="height: 1px; width: 1px; position: absolute; top: 0px; z-index: 100000; border: 0px; left: 0px;" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/sh.0d19417fd0a004d73df6a35b.html"></iframe></div><style id="service-icons-0"></style>
	<!------------------------------------------------------------------------>
				<!------------------------------------------------------------------------>

                <script type="text/javascript">
                    //<![CDATA[
                        if (typeof(thisevolvedcookie) == "object") {
                            thisevolvedcookie.modifiers.mode = "";
                            thisevolvedcookie.modifiers.dir = "";
                            thisevolvedcookie.modifiers.limit = "";
                            thisevolvedcookie.modifiers.order = "";
                            thisevolvedcookie.tax = "21";
                        }
                    //]]>
                </script>
            
<div id="fb-root" class=" fb_reset"><script src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/sdk.js.tải xuống" async=""></script><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./Geolocation Tracker (GPRS + GPS) with SIM908 over Arduino and Raspberry Pi_files/ao6eUeuGXQq.html" style="border: none;"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div></div></body></html>